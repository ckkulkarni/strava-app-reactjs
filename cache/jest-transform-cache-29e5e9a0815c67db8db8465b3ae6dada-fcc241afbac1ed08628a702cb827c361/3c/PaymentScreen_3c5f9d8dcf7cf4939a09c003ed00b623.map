{"version":3,"names":["_react","_interopRequireWildcard","require","_reactRouter","_reactRouterDom","_parkingSlice","_reactRedux","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","obj","__esModule","default","cache","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","PaymentScreen","location","useLocation","spaceDetails","space","state","dispatch","useDispatch","navigation","useNavigate","hoursParked","setHoursParked","useState","useEffect","parkingHours","parkingMinutes","parkingTime","split","parkedTime","Date","setHours","Number","Math","ceil","getTime","calculateParkingCharges","parkingCharge","payment","setPayment","handleSubmit","reg","registration","charges","result","fetch","method","headers","body","JSON","stringify","charge","ok","alert","paymentComplete","error","console","createElement","className","onClick","Link","to","_default","exports"],"sources":["PaymentScreen.tsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { useLocation, useNavigate } from \"react-router\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { paymentComplete } from \"./redux/reducer/parkingSlice\";\r\nimport { useDispatch } from \"react-redux\";\r\nconst PaymentScreen = () => {\r\n  const location = useLocation();\r\n  const { spaceDetails, space } = location.state;\r\n  const dispatch = useDispatch();\r\n  const navigation = useNavigate();\r\n\r\n  const [hoursParked, setHoursParked] = useState<number | null>(null);\r\n\r\n  useEffect(() => {\r\n    const [parkingHours, parkingMinutes] = spaceDetails.parkingTime.split(\":\");\r\n    const parkedTime = new Date();\r\n    parkedTime.setHours(Number(parkingHours), Number(parkingMinutes), 0, 0);\r\n    const hoursParked = Math.ceil(\r\n      (new Date().getTime() - parkedTime.getTime()) / (1000 * 60 * 60) - 1\r\n    );\r\n    setHoursParked(hoursParked);\r\n  }, [spaceDetails.parkingTime]);\r\n  const calculateParkingCharges = (parkingTime: any) => {\r\n    const [parkingHours, parkingMinutes] = parkingTime.split(\":\");\r\n    const parkedTime = new Date();\r\n    parkedTime.setHours(Number(parkingHours), Number(parkingMinutes), 0, 0);\r\n    const hoursParked = Math.ceil(\r\n      (new Date().getTime() - parkedTime.getTime()) / (1000 * 60 * 60)\r\n    );\r\n    let parkingCharge = 10;\r\n    if (hoursParked > 2) {\r\n      parkingCharge += (hoursParked - 2) * 10 - 10;\r\n    }\r\n    return parkingCharge;\r\n  };\r\n\r\n  const [payment, setPayment] = useState(\r\n    calculateParkingCharges(spaceDetails.parkingTime)\r\n  );\r\n  const handleSubmit = async () => {\r\n    const reg = spaceDetails.registration;\r\n    const charges = payment;\r\n    try {\r\n      const result = await fetch(`https://httpstat.us/200`, {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify({\r\n          \"car-registration\": reg,\r\n          charge: charges,\r\n        }),\r\n      });\r\n      if (result.ok) {\r\n        alert(\"Payment Successful!\");\r\n        dispatch(paymentComplete(space));\r\n        navigation(\"/spaces\");\r\n      } else {\r\n        alert(\"Payment Failed\");\r\n      }\r\n    } catch (error) {\r\n      console.error(error);\r\n    }\r\n  };\r\n  return (\r\n    <div className=\"paymentScreen\">\r\n      <p data-testid=\"reg\">Vehicle Registration: {spaceDetails.registration}</p>\r\n      <p data-testid=\"parkingHours\">Hours Parked: {hoursParked}</p>\r\n      <p data-testid=\"payment\">Parking Charge: ${payment}</p>\r\n      <button\r\n        className=\"btn btn-primary\"\r\n        onClick={handleSubmit}\r\n        data-testid=\"paymentButton\"\r\n      >\r\n        Make Payment\r\n      </button>\r\n      <Link to=\"/spaces\">\r\n        <button className=\"btn btn-secondary\">Go Back</button>\r\n      </Link>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PaymentScreen;\r\n"],"mappings":"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"}