059db8f38316e98106bd01b7d0d075d7
'use strict';

var stringifyCollection = require('../stringify/stringifyCollection.js');
var Collection = require('./Collection.js');
var Node = require('./Node.js');
var Scalar = require('./Scalar.js');
var toJS = require('./toJS.js');
class YAMLSeq extends Collection.Collection {
  static get tagName() {
    return 'tag:yaml.org,2002:seq';
  }
  constructor(schema) {
    super(Node.SEQ, schema);
    this.items = [];
  }
  add(value) {
    this.items.push(value);
  }
  /**
   * Removes a value from the collection.
   *
   * `key` must contain a representation of an integer for this to succeed.
   * It may be wrapped in a `Scalar`.
   *
   * @returns `true` if the item was found and removed.
   */
  delete(key) {
    const idx = asItemIndex(key);
    if (typeof idx !== 'number') return false;
    const del = this.items.splice(idx, 1);
    return del.length > 0;
  }
  get(key, keepScalar) {
    const idx = asItemIndex(key);
    if (typeof idx !== 'number') return undefined;
    const it = this.items[idx];
    return !keepScalar && Node.isScalar(it) ? it.value : it;
  }
  /**
   * Checks if the collection includes a value with the key `key`.
   *
   * `key` must contain a representation of an integer for this to succeed.
   * It may be wrapped in a `Scalar`.
   */
  has(key) {
    const idx = asItemIndex(key);
    return typeof idx === 'number' && idx < this.items.length;
  }
  /**
   * Sets a value in this collection. For `!!set`, `value` needs to be a
   * boolean to add/remove the item from the set.
   *
   * If `key` does not contain a representation of an integer, this will throw.
   * It may be wrapped in a `Scalar`.
   */
  set(key, value) {
    const idx = asItemIndex(key);
    if (typeof idx !== 'number') throw new Error(`Expected a valid index, not ${key}.`);
    const prev = this.items[idx];
    if (Node.isScalar(prev) && Scalar.isScalarValue(value)) prev.value = value;else this.items[idx] = value;
  }
  toJSON(_, ctx) {
    const seq = [];
    if (ctx?.onCreate) ctx.onCreate(seq);
    let i = 0;
    for (const item of this.items) seq.push(toJS.toJS(item, String(i++), ctx));
    return seq;
  }
  toString(ctx, onComment, onChompKeep) {
    if (!ctx) return JSON.stringify(this);
    return stringifyCollection.stringifyCollection(this, ctx, {
      blockItemPrefix: '- ',
      flowChars: {
        start: '[',
        end: ']'
      },
      itemIndent: (ctx.indent || '') + '  ',
      onChompKeep,
      onComment
    });
  }
}
function asItemIndex(key) {
  let idx = Node.isScalar(key) ? key.value : key;
  if (idx && typeof idx === 'string') idx = Number(idx);
  return typeof idx === 'number' && Number.isInteger(idx) && idx >= 0 ? idx : null;
}
exports.YAMLSeq = YAMLSeq;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJzdHJpbmdpZnlDb2xsZWN0aW9uIiwicmVxdWlyZSIsIkNvbGxlY3Rpb24iLCJOb2RlIiwiU2NhbGFyIiwidG9KUyIsIllBTUxTZXEiLCJ0YWdOYW1lIiwiY29uc3RydWN0b3IiLCJzY2hlbWEiLCJTRVEiLCJpdGVtcyIsImFkZCIsInZhbHVlIiwicHVzaCIsImRlbGV0ZSIsImtleSIsImlkeCIsImFzSXRlbUluZGV4IiwiZGVsIiwic3BsaWNlIiwibGVuZ3RoIiwiZ2V0Iiwia2VlcFNjYWxhciIsInVuZGVmaW5lZCIsIml0IiwiaXNTY2FsYXIiLCJoYXMiLCJzZXQiLCJFcnJvciIsInByZXYiLCJpc1NjYWxhclZhbHVlIiwidG9KU09OIiwiXyIsImN0eCIsInNlcSIsIm9uQ3JlYXRlIiwiaSIsIml0ZW0iLCJTdHJpbmciLCJ0b1N0cmluZyIsIm9uQ29tbWVudCIsIm9uQ2hvbXBLZWVwIiwiSlNPTiIsInN0cmluZ2lmeSIsImJsb2NrSXRlbVByZWZpeCIsImZsb3dDaGFycyIsInN0YXJ0IiwiZW5kIiwiaXRlbUluZGVudCIsImluZGVudCIsIk51bWJlciIsImlzSW50ZWdlciIsImV4cG9ydHMiXSwic291cmNlcyI6WyJZQU1MU2VxLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxudmFyIHN0cmluZ2lmeUNvbGxlY3Rpb24gPSByZXF1aXJlKCcuLi9zdHJpbmdpZnkvc3RyaW5naWZ5Q29sbGVjdGlvbi5qcycpO1xudmFyIENvbGxlY3Rpb24gPSByZXF1aXJlKCcuL0NvbGxlY3Rpb24uanMnKTtcbnZhciBOb2RlID0gcmVxdWlyZSgnLi9Ob2RlLmpzJyk7XG52YXIgU2NhbGFyID0gcmVxdWlyZSgnLi9TY2FsYXIuanMnKTtcbnZhciB0b0pTID0gcmVxdWlyZSgnLi90b0pTLmpzJyk7XG5cbmNsYXNzIFlBTUxTZXEgZXh0ZW5kcyBDb2xsZWN0aW9uLkNvbGxlY3Rpb24ge1xuICAgIHN0YXRpYyBnZXQgdGFnTmFtZSgpIHtcbiAgICAgICAgcmV0dXJuICd0YWc6eWFtbC5vcmcsMjAwMjpzZXEnO1xuICAgIH1cbiAgICBjb25zdHJ1Y3RvcihzY2hlbWEpIHtcbiAgICAgICAgc3VwZXIoTm9kZS5TRVEsIHNjaGVtYSk7XG4gICAgICAgIHRoaXMuaXRlbXMgPSBbXTtcbiAgICB9XG4gICAgYWRkKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuaXRlbXMucHVzaCh2YWx1ZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlbW92ZXMgYSB2YWx1ZSBmcm9tIHRoZSBjb2xsZWN0aW9uLlxuICAgICAqXG4gICAgICogYGtleWAgbXVzdCBjb250YWluIGEgcmVwcmVzZW50YXRpb24gb2YgYW4gaW50ZWdlciBmb3IgdGhpcyB0byBzdWNjZWVkLlxuICAgICAqIEl0IG1heSBiZSB3cmFwcGVkIGluIGEgYFNjYWxhcmAuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyBgdHJ1ZWAgaWYgdGhlIGl0ZW0gd2FzIGZvdW5kIGFuZCByZW1vdmVkLlxuICAgICAqL1xuICAgIGRlbGV0ZShrZXkpIHtcbiAgICAgICAgY29uc3QgaWR4ID0gYXNJdGVtSW5kZXgoa2V5KTtcbiAgICAgICAgaWYgKHR5cGVvZiBpZHggIT09ICdudW1iZXInKVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICBjb25zdCBkZWwgPSB0aGlzLml0ZW1zLnNwbGljZShpZHgsIDEpO1xuICAgICAgICByZXR1cm4gZGVsLmxlbmd0aCA+IDA7XG4gICAgfVxuICAgIGdldChrZXksIGtlZXBTY2FsYXIpIHtcbiAgICAgICAgY29uc3QgaWR4ID0gYXNJdGVtSW5kZXgoa2V5KTtcbiAgICAgICAgaWYgKHR5cGVvZiBpZHggIT09ICdudW1iZXInKVxuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgY29uc3QgaXQgPSB0aGlzLml0ZW1zW2lkeF07XG4gICAgICAgIHJldHVybiAha2VlcFNjYWxhciAmJiBOb2RlLmlzU2NhbGFyKGl0KSA/IGl0LnZhbHVlIDogaXQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENoZWNrcyBpZiB0aGUgY29sbGVjdGlvbiBpbmNsdWRlcyBhIHZhbHVlIHdpdGggdGhlIGtleSBga2V5YC5cbiAgICAgKlxuICAgICAqIGBrZXlgIG11c3QgY29udGFpbiBhIHJlcHJlc2VudGF0aW9uIG9mIGFuIGludGVnZXIgZm9yIHRoaXMgdG8gc3VjY2VlZC5cbiAgICAgKiBJdCBtYXkgYmUgd3JhcHBlZCBpbiBhIGBTY2FsYXJgLlxuICAgICAqL1xuICAgIGhhcyhrZXkpIHtcbiAgICAgICAgY29uc3QgaWR4ID0gYXNJdGVtSW5kZXgoa2V5KTtcbiAgICAgICAgcmV0dXJuIHR5cGVvZiBpZHggPT09ICdudW1iZXInICYmIGlkeCA8IHRoaXMuaXRlbXMubGVuZ3RoO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZXRzIGEgdmFsdWUgaW4gdGhpcyBjb2xsZWN0aW9uLiBGb3IgYCEhc2V0YCwgYHZhbHVlYCBuZWVkcyB0byBiZSBhXG4gICAgICogYm9vbGVhbiB0byBhZGQvcmVtb3ZlIHRoZSBpdGVtIGZyb20gdGhlIHNldC5cbiAgICAgKlxuICAgICAqIElmIGBrZXlgIGRvZXMgbm90IGNvbnRhaW4gYSByZXByZXNlbnRhdGlvbiBvZiBhbiBpbnRlZ2VyLCB0aGlzIHdpbGwgdGhyb3cuXG4gICAgICogSXQgbWF5IGJlIHdyYXBwZWQgaW4gYSBgU2NhbGFyYC5cbiAgICAgKi9cbiAgICBzZXQoa2V5LCB2YWx1ZSkge1xuICAgICAgICBjb25zdCBpZHggPSBhc0l0ZW1JbmRleChrZXkpO1xuICAgICAgICBpZiAodHlwZW9mIGlkeCAhPT0gJ251bWJlcicpXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEV4cGVjdGVkIGEgdmFsaWQgaW5kZXgsIG5vdCAke2tleX0uYCk7XG4gICAgICAgIGNvbnN0IHByZXYgPSB0aGlzLml0ZW1zW2lkeF07XG4gICAgICAgIGlmIChOb2RlLmlzU2NhbGFyKHByZXYpICYmIFNjYWxhci5pc1NjYWxhclZhbHVlKHZhbHVlKSlcbiAgICAgICAgICAgIHByZXYudmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgdGhpcy5pdGVtc1tpZHhdID0gdmFsdWU7XG4gICAgfVxuICAgIHRvSlNPTihfLCBjdHgpIHtcbiAgICAgICAgY29uc3Qgc2VxID0gW107XG4gICAgICAgIGlmIChjdHg/Lm9uQ3JlYXRlKVxuICAgICAgICAgICAgY3R4Lm9uQ3JlYXRlKHNlcSk7XG4gICAgICAgIGxldCBpID0gMDtcbiAgICAgICAgZm9yIChjb25zdCBpdGVtIG9mIHRoaXMuaXRlbXMpXG4gICAgICAgICAgICBzZXEucHVzaCh0b0pTLnRvSlMoaXRlbSwgU3RyaW5nKGkrKyksIGN0eCkpO1xuICAgICAgICByZXR1cm4gc2VxO1xuICAgIH1cbiAgICB0b1N0cmluZyhjdHgsIG9uQ29tbWVudCwgb25DaG9tcEtlZXApIHtcbiAgICAgICAgaWYgKCFjdHgpXG4gICAgICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkodGhpcyk7XG4gICAgICAgIHJldHVybiBzdHJpbmdpZnlDb2xsZWN0aW9uLnN0cmluZ2lmeUNvbGxlY3Rpb24odGhpcywgY3R4LCB7XG4gICAgICAgICAgICBibG9ja0l0ZW1QcmVmaXg6ICctICcsXG4gICAgICAgICAgICBmbG93Q2hhcnM6IHsgc3RhcnQ6ICdbJywgZW5kOiAnXScgfSxcbiAgICAgICAgICAgIGl0ZW1JbmRlbnQ6IChjdHguaW5kZW50IHx8ICcnKSArICcgICcsXG4gICAgICAgICAgICBvbkNob21wS2VlcCxcbiAgICAgICAgICAgIG9uQ29tbWVudFxuICAgICAgICB9KTtcbiAgICB9XG59XG5mdW5jdGlvbiBhc0l0ZW1JbmRleChrZXkpIHtcbiAgICBsZXQgaWR4ID0gTm9kZS5pc1NjYWxhcihrZXkpID8ga2V5LnZhbHVlIDoga2V5O1xuICAgIGlmIChpZHggJiYgdHlwZW9mIGlkeCA9PT0gJ3N0cmluZycpXG4gICAgICAgIGlkeCA9IE51bWJlcihpZHgpO1xuICAgIHJldHVybiB0eXBlb2YgaWR4ID09PSAnbnVtYmVyJyAmJiBOdW1iZXIuaXNJbnRlZ2VyKGlkeCkgJiYgaWR4ID49IDBcbiAgICAgICAgPyBpZHhcbiAgICAgICAgOiBudWxsO1xufVxuXG5leHBvcnRzLllBTUxTZXEgPSBZQU1MU2VxO1xuIl0sIm1hcHBpbmdzIjoiQUFBQSxZQUFZOztBQUVaLElBQUlBLG1CQUFtQixHQUFHQyxPQUFPLENBQUMscUNBQXFDLENBQUM7QUFDeEUsSUFBSUMsVUFBVSxHQUFHRCxPQUFPLENBQUMsaUJBQWlCLENBQUM7QUFDM0MsSUFBSUUsSUFBSSxHQUFHRixPQUFPLENBQUMsV0FBVyxDQUFDO0FBQy9CLElBQUlHLE1BQU0sR0FBR0gsT0FBTyxDQUFDLGFBQWEsQ0FBQztBQUNuQyxJQUFJSSxJQUFJLEdBQUdKLE9BQU8sQ0FBQyxXQUFXLENBQUM7QUFFL0IsTUFBTUssT0FBTyxTQUFTSixVQUFVLENBQUNBLFVBQVUsQ0FBQztFQUN4QyxXQUFXSyxPQUFPQSxDQUFBLEVBQUc7SUFDakIsT0FBTyx1QkFBdUI7RUFDbEM7RUFDQUMsV0FBV0EsQ0FBQ0MsTUFBTSxFQUFFO0lBQ2hCLEtBQUssQ0FBQ04sSUFBSSxDQUFDTyxHQUFHLEVBQUVELE1BQU0sQ0FBQztJQUN2QixJQUFJLENBQUNFLEtBQUssR0FBRyxFQUFFO0VBQ25CO0VBQ0FDLEdBQUdBLENBQUNDLEtBQUssRUFBRTtJQUNQLElBQUksQ0FBQ0YsS0FBSyxDQUFDRyxJQUFJLENBQUNELEtBQUssQ0FBQztFQUMxQjtFQUNBO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7RUFDSUUsTUFBTUEsQ0FBQ0MsR0FBRyxFQUFFO0lBQ1IsTUFBTUMsR0FBRyxHQUFHQyxXQUFXLENBQUNGLEdBQUcsQ0FBQztJQUM1QixJQUFJLE9BQU9DLEdBQUcsS0FBSyxRQUFRLEVBQ3ZCLE9BQU8sS0FBSztJQUNoQixNQUFNRSxHQUFHLEdBQUcsSUFBSSxDQUFDUixLQUFLLENBQUNTLE1BQU0sQ0FBQ0gsR0FBRyxFQUFFLENBQUMsQ0FBQztJQUNy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