{"version":3,"names":["Node","require","toJS","value","arg","ctx","Array","isArray","map","v","i","String","toJSON","hasAnchor","data","aliasCount","count","res","undefined","anchors","set","onCreate","keep","Number","exports"],"sources":["toJS.js"],"sourcesContent":["'use strict';\n\nvar Node = require('./Node.js');\n\n/**\n * Recursively convert any node or its contents to native JavaScript\n *\n * @param value - The input value\n * @param arg - If `value` defines a `toJSON()` method, use this\n *   as its first argument\n * @param ctx - Conversion context, originally set in Document#toJS(). If\n *   `{ keep: true }` is not set, output should be suitable for JSON\n *   stringification.\n */\nfunction toJS(value, arg, ctx) {\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-return\n    if (Array.isArray(value))\n        return value.map((v, i) => toJS(v, String(i), ctx));\n    if (value && typeof value.toJSON === 'function') {\n        // eslint-disable-next-line @typescript-eslint/no-unsafe-call\n        if (!ctx || !Node.hasAnchor(value))\n            return value.toJSON(arg, ctx);\n        const data = { aliasCount: 0, count: 1, res: undefined };\n        ctx.anchors.set(value, data);\n        ctx.onCreate = res => {\n            data.res = res;\n            delete ctx.onCreate;\n        };\n        const res = value.toJSON(arg, ctx);\n        if (ctx.onCreate)\n            ctx.onCreate(res);\n        return res;\n    }\n    if (typeof value === 'bigint' && !ctx?.keep)\n        return Number(value);\n    return value;\n}\n\nexports.toJS = toJS;\n"],"mappings":"AAAA,YAAY;;AAEZ,IAAIA,IAAI,GAAGC,OAAO,CAAC,WAAW,CAAC;;AAE/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAASC,IAAIA,CAACC,KAAK,EAAEC,GAAG,EAAEC,GAAG,EAAE;EAC3B;EACA,IAAIC,KAAK,CAACC,OAAO,CAACJ,KAAK,CAAC,EACpB,OAAOA,KAAK,CAACK,GAAG,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAKR,IAAI,CAACO,CAAC,EAAEE,MAAM,CAACD,CAAC,CAAC,EAAEL,GAAG,CAAC,CAAC;EACvD,IAAIF,KAAK,IAAI,OAAOA,KAAK,CAACS,MAAM,KAAK,UAAU,EAAE;IAC7C;IACA,IAAI,CAACP,GAAG,IAAI,CAACL,IAAI,CAACa,SAAS,CAACV,KAAK,CAAC,EAC9B,OAAOA,KAAK,CAACS,MAAM,CAACR,GAAG,EAAEC,GAAG,CAAC;IACjC,MAAMS,IAAI,GAAG;MAAEC,UAAU,EAAE,CAAC;MAAEC,KAAK,EAAE,CAAC;MAAEC,GAAG,EAAEC;IAAU,CAAC;IACxDb,GAAG,CAACc,OAAO,CAACC,GAAG,CAACjB,KAAK,EAAEW,IAAI,CAAC;IAC5BT,GAAG,CAACgB,QAAQ,GAAGJ,GAAG,IAAI;MAClBH,IAAI,CAACG,GAAG,GAAGA,GAAG;MACd,OAAOZ,GAAG,CAACgB,QAAQ;IACvB,CAAC;IACD,MAAMJ,GAAG,GAAGd,KAAK,CAACS,MAAM,CAACR,GAAG,EAAEC,GAAG,CAAC;IAClC,IAAIA,GAAG,CAACgB,QAAQ,EACZhB,GAAG,CAACgB,QAAQ,CAACJ,GAAG,CAAC;IACrB,OAAOA,GAAG;EACd;EACA,IAAI,OAAOd,KAAK,KAAK,QAAQ,IAAI,CAACE,GAAG,EAAEiB,IAAI,EACvC,OAAOC,MAAM,CAACpB,KAAK,CAAC;EACxB,OAAOA,KAAK;AAChB;AAEAqB,OAAO,CAACtB,IAAI,GAAGA,IAAI"}