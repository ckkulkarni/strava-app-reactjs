{"version":3,"names":["Object","defineProperty","exports","value","format","_inline_diff","_interopRequireDefault","require","_stringify","_type","_unified_diff","obj","__esModule","default","identity","x","err","options","colorFns","forEach","key","message","toString","inspect","JSON","stringify","stack","startOfMessageIndex","indexOf","endOfMessageIndex","length","slice","uncaught","actual","expected","showDiff","undefined","match","errorMessage","inlineDiff","errorStack"],"sources":["index.js"],"sourcesContent":["\"use strict\";Object.defineProperty(exports, \"__esModule\", { value: true });exports.format = format;var _inline_diff = _interopRequireDefault(require(\"./helpers/inline_diff\"));\nvar _stringify = _interopRequireDefault(require(\"./helpers/stringify\"));\nvar _type = _interopRequireDefault(require(\"./helpers/type\"));\nvar _unified_diff = _interopRequireDefault(require(\"./helpers/unified_diff\"));function _interopRequireDefault(obj) {return obj && obj.__esModule ? obj : { default: obj };}\n\nfunction identity(x) {\n  return x;\n}\n\nfunction format(err, options) {\n  if (!options) {\n    options = {};\n  }\n  if (!options.colorFns) {\n    options.colorFns = {};\n  }\n  ['diffAdded', 'diffRemoved', 'errorMessage', 'errorStack'].forEach(function (\n  key)\n  {\n    if (!options.colorFns[key]) {\n      options.colorFns[key] = identity;\n    }\n  });\n\n  let message;\n  if (err.message && typeof err.message.toString === 'function') {\n    message = err.message + '';\n  } else if (typeof err.inspect === 'function') {\n    message = err.inspect() + '';\n  } else if (typeof err === 'string') {\n    message = err;\n  } else {\n    message = JSON.stringify(err);\n  }\n\n  let stack = err.stack || message;\n  const startOfMessageIndex = stack.indexOf(message);\n  if (startOfMessageIndex === -1) {\n    stack = '\\n' + stack;\n  } else {\n    const endOfMessageIndex = startOfMessageIndex + message.length;\n    message = stack.slice(0, endOfMessageIndex);\n    stack = stack.slice(endOfMessageIndex); // remove message from stack\n  }\n\n  if (err.uncaught) {\n    message = 'Uncaught ' + message;\n  }\n\n  let actual = err.actual;\n  let expected = err.expected;\n\n  if (\n  err.showDiff !== false &&\n  (0, _type.default)(actual) === (0, _type.default)(expected) &&\n  expected !== undefined)\n  {\n    if (!((0, _type.default)(actual) === 'string' && (0, _type.default)(expected) === 'string')) {\n      actual = (0, _stringify.default)(actual);\n      expected = (0, _stringify.default)(expected);\n    }\n\n    const match = message.match(/^([^:]+): expected/);\n    message = options.colorFns.errorMessage(match ? match[1] : message);\n\n    if (options.inlineDiff) {\n      message += (0, _inline_diff.default)(actual, expected, options.colorFns);\n    } else {\n      message += (0, _unified_diff.default)(actual, expected, options.colorFns);\n    }\n  } else {\n    message = options.colorFns.errorMessage(message);\n  }\n\n  if (stack) {\n    stack = options.colorFns.errorStack(stack);\n  }\n\n  return message + stack;\n}"],"mappings":"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"}