{"version":3,"names":["path_1","__importDefault","require","error_stack_parser_1","filter_stack_trace_1","value_checker_1","getDefinitionLineAndUri","cwd","isExcluded","isFileNameInCucumber","line","uri","stackframes","default","parse","Error","stackframe","find","frame","fileName","__filename","getLineNumber","getFileName","doesHaveValue","relative","valueOrDefault","exports"],"sources":["../../src/support_code_library_builder/get_definition_line_and_uri.ts"],"sourcesContent":["import path from 'path'\nimport errorStackParser, { StackFrame } from 'error-stack-parser'\nimport { isFileNameInCucumber } from '../filter_stack_trace'\nimport { doesHaveValue, valueOrDefault } from '../value_checker'\nimport { ILineAndUri } from '../types'\n\nexport function getDefinitionLineAndUri(\n  cwd: string,\n  isExcluded = isFileNameInCucumber\n): ILineAndUri {\n  let line: number\n  let uri: string\n  const stackframes: StackFrame[] = errorStackParser.parse(new Error())\n  const stackframe = stackframes.find(\n    (frame: StackFrame) =>\n      frame.fileName !== __filename && !isExcluded(frame.fileName)\n  )\n  if (stackframe != null) {\n    line = stackframe.getLineNumber()\n    uri = stackframe.getFileName()\n    if (doesHaveValue(uri)) {\n      uri = path.relative(cwd, uri)\n    }\n  }\n\n  return {\n    line: valueOrDefault(line, 0),\n    uri: valueOrDefault(uri, 'unknown'),\n  }\n}\n"],"mappings":";;;;;;;;;;;AAAA,MAAAA,MAAA,GAAAC,eAAA,CAAAC,OAAA;AACA,MAAAC,oBAAA,GAAAF,eAAA,CAAAC,OAAA;AACA,MAAAE,oBAAA,GAAAF,OAAA;AACA,MAAAG,eAAA,GAAAH,OAAA;AAGA,SAAgBI,uBAAuBA,CACrCC,GAAW,EACXC,UAAU,GAAGJ,oBAAA,CAAAK,oBAAoB;EAEjC,IAAIC,IAAY;EAChB,IAAIC,GAAW;EACf,MAAMC,WAAW,GAAiBT,oBAAA,CAAAU,OAAgB,CAACC,KAAK,CAAC,IAAIC,KAAK,EAAE,CAAC;EACrE,MAAMC,UAAU,GAAGJ,WAAW,CAACK,IAAI,CAChCC,KAAiB,IAChBA,KAAK,CAACC,QAAQ,KAAKC,UAAU,IAAI,CAACZ,UAAU,CAACU,KAAK,CAACC,QAAQ,CAAC,CAC/D;EACD,IAAIH,UAAU,IAAI,IAAI,EAAE;IACtBN,IAAI,GAAGM,UAAU,CAACK,aAAa,EAAE;IACjCV,GAAG,GAAGK,UAAU,CAACM,WAAW,EAAE;IAC9B,IAAI,IAAAjB,eAAA,CAAAkB,aAAa,EAACZ,GAAG,CAAC,EAAE;MACtBA,GAAG,GAAGX,MAAA,CAAAa,OAAI,CAACW,QAAQ,CAACjB,GAAG,EAAEI,GAAG,CAAC;;;EAIjC,OAAO;IACLD,IAAI,EAAE,IAAAL,eAAA,CAAAoB,cAAc,EAACf,IAAI,EAAE,CAAC,CAAC;IAC7BC,GAAG,EAAE,IAAAN,eAAA,CAAAoB,cAAc,EAACd,GAAG,EAAE,SAAS;GACnC;AACH;AAvBAe,OAAA,CAAApB,uBAAA,GAAAA,uBAAA"}