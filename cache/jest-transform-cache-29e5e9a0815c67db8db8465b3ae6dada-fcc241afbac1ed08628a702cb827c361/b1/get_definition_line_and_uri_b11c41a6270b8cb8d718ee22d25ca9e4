5a78bc87937494d4824e9f1fe65d2f1e
"use strict";

var __importDefault = void 0 && (void 0).__importDefault || function (mod) {
  return mod && mod.__esModule ? mod : {
    "default": mod
  };
};
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.getDefinitionLineAndUri = void 0;
const path_1 = __importDefault(require("path"));
const error_stack_parser_1 = __importDefault(require("error-stack-parser"));
const filter_stack_trace_1 = require("../filter_stack_trace");
const value_checker_1 = require("../value_checker");
function getDefinitionLineAndUri(cwd, isExcluded = filter_stack_trace_1.isFileNameInCucumber) {
  let line;
  let uri;
  const stackframes = error_stack_parser_1.default.parse(new Error());
  const stackframe = stackframes.find(frame => frame.fileName !== __filename && !isExcluded(frame.fileName));
  if (stackframe != null) {
    line = stackframe.getLineNumber();
    uri = stackframe.getFileName();
    if ((0, value_checker_1.doesHaveValue)(uri)) {
      uri = path_1.default.relative(cwd, uri);
    }
  }
  return {
    line: (0, value_checker_1.valueOrDefault)(line, 0),
    uri: (0, value_checker_1.valueOrDefault)(uri, 'unknown')
  };
}
exports.getDefinitionLineAndUri = getDefinitionLineAndUri;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJwYXRoXzEiLCJfX2ltcG9ydERlZmF1bHQiLCJyZXF1aXJlIiwiZXJyb3Jfc3RhY2tfcGFyc2VyXzEiLCJmaWx0ZXJfc3RhY2tfdHJhY2VfMSIsInZhbHVlX2NoZWNrZXJfMSIsImdldERlZmluaXRpb25MaW5lQW5kVXJpIiwiY3dkIiwiaXNFeGNsdWRlZCIsImlzRmlsZU5hbWVJbkN1Y3VtYmVyIiwibGluZSIsInVyaSIsInN0YWNrZnJhbWVzIiwiZGVmYXVsdCIsInBhcnNlIiwiRXJyb3IiLCJzdGFja2ZyYW1lIiwiZmluZCIsImZyYW1lIiwiZmlsZU5hbWUiLCJfX2ZpbGVuYW1lIiwiZ2V0TGluZU51bWJlciIsImdldEZpbGVOYW1lIiwiZG9lc0hhdmVWYWx1ZSIsInJlbGF0aXZlIiwidmFsdWVPckRlZmF1bHQiLCJleHBvcnRzIl0sInNvdXJjZXMiOlsiLi4vLi4vc3JjL3N1cHBvcnRfY29kZV9saWJyYXJ5X2J1aWxkZXIvZ2V0X2RlZmluaXRpb25fbGluZV9hbmRfdXJpLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBwYXRoIGZyb20gJ3BhdGgnXG5pbXBvcnQgZXJyb3JTdGFja1BhcnNlciwgeyBTdGFja0ZyYW1lIH0gZnJvbSAnZXJyb3Itc3RhY2stcGFyc2VyJ1xuaW1wb3J0IHsgaXNGaWxlTmFtZUluQ3VjdW1iZXIgfSBmcm9tICcuLi9maWx0ZXJfc3RhY2tfdHJhY2UnXG5pbXBvcnQgeyBkb2VzSGF2ZVZhbHVlLCB2YWx1ZU9yRGVmYXVsdCB9IGZyb20gJy4uL3ZhbHVlX2NoZWNrZXInXG5pbXBvcnQgeyBJTGluZUFuZFVyaSB9IGZyb20gJy4uL3R5cGVzJ1xuXG5leHBvcnQgZnVuY3Rpb24gZ2V0RGVmaW5pdGlvbkxpbmVBbmRVcmkoXG4gIGN3ZDogc3RyaW5nLFxuICBpc0V4Y2x1ZGVkID0gaXNGaWxlTmFtZUluQ3VjdW1iZXJcbik6IElMaW5lQW5kVXJpIHtcbiAgbGV0IGxpbmU6IG51bWJlclxuICBsZXQgdXJpOiBzdHJpbmdcbiAgY29uc3Qgc3RhY2tmcmFtZXM6IFN0YWNrRnJhbWVbXSA9IGVycm9yU3RhY2tQYXJzZXIucGFyc2UobmV3IEVycm9yKCkpXG4gIGNvbnN0IHN0YWNrZnJhbWUgPSBzdGFja2ZyYW1lcy5maW5kKFxuICAgIChmcmFtZTogU3RhY2tGcmFtZSkgPT5cbiAgICAgIGZyYW1lLmZpbGVOYW1lICE9PSBfX2ZpbGVuYW1lICYmICFpc0V4Y2x1ZGVkKGZyYW1lLmZpbGVOYW1lKVxuICApXG4gIGlmIChzdGFja2ZyYW1lICE9IG51bGwpIHtcbiAgICBsaW5lID0gc3RhY2tmcmFtZS5nZXRMaW5lTnVtYmVyKClcbiAgICB1cmkgPSBzdGFja2ZyYW1lLmdldEZpbGVOYW1lKClcbiAgICBpZiAoZG9lc0hhdmVWYWx1ZSh1cmkpKSB7XG4gICAgICB1cmkgPSBwYXRoLnJlbGF0aXZlKGN3ZCwgdXJpKVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiB7XG4gICAgbGluZTogdmFsdWVPckRlZmF1bHQobGluZSwgMCksXG4gICAgdXJpOiB2YWx1ZU9yRGVmYXVsdCh1cmksICd1bmtub3duJyksXG4gIH1cbn1cbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFBQSxNQUFBQSxNQUFBLEdBQUFDLGVBQUEsQ0FBQUMsT0FBQTtBQUNBLE1BQUFDLG9CQUFBLEdBQUFGLGVBQUEsQ0FBQUMsT0FBQTtBQUNBLE1BQUFFLG9CQUFBLEdBQUFGLE9BQUE7QUFDQSxNQUFBRyxlQUFBLEdBQUFILE9BQUE7QUFHQSxTQUFnQkksdUJBQXVCQSxDQUNyQ0MsR0FBVyxFQUNYQyxVQUFVLEdBQUdKLG9CQUFBLENBQUFLLG9CQUFvQjtFQUVqQyxJQUFJQyxJQUFZO0VBQ2hCLElBQUlDLEdBQVc7RUFDZixNQUFNQyxXQUFXLEdBQWlCVCxvQkFBQSxDQUFBVSxPQUFnQixDQUFDQyxLQUFLLENBQUMsSUFBSUMsS0FBSyxFQUFFLENBQUM7RUFDckUsTUFBTUMsVUFBVSxHQUFHSixXQUFXLENBQUNLLElBQUksQ0FDaENDLEtBQWlCLElBQ2hCQSxLQUFLLENBQUNDLFFBQVEsS0FBS0MsVUFBVSxJQUFJLENBQUNaLFVBQVUsQ0FBQ1UsS0FBSyxDQUFDQyxRQUFRLENBQUMsQ0FDL0Q7RUFDRCxJQUFJSCxVQUFVLElBQUksSUFBSSxFQUFFO0lBQ3RCTixJQUFJLEdBQUdNLFVBQVUsQ0FBQ0ssYUFBYSxFQUFFO0lBQ2pDVixHQUFHLEdBQUdLLFVBQVUsQ0FBQ00sV0FBVyxFQUFFO0lBQzlCLElBQUksSUFBQWpCLGVBQUEsQ0FBQWtCLGFBQWEsRUFBQ1osR0FBRyxDQUFDLEVBQUU7TUFDdEJBLEdBQUcsR0FBR1gsTUFBQSxDQUFBYSxPQUFJLENBQUNXLFFBQVEsQ0FBQ2pCLEdBQUcsRUFBRUksR0FBRyxDQUFDOzs7RUFJakMsT0FBTztJQUNMRCxJQUFJLEVBQUUsSUFBQUwsZUFBQSxDQUFBb0IsY0FBYyxFQUFDZixJQUFJLEVBQUUsQ0FBQyxDQUFDO0lBQzdCQyxHQUFHLEVBQUUsSUFBQU4sZUFBQSxDQUFBb0IsY0FBYyxFQUFDZCxHQUFHLEVBQUUsU0FBUztHQUNuQztBQUNIO0FBdkJBZSxPQUFBLENBQUFwQix1QkFBQSxHQUFBQSx1QkFBQSJ9