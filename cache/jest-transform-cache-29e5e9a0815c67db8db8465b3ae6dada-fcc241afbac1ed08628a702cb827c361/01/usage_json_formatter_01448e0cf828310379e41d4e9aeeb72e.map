{"version":3,"names":["helpers_1","require","_1","__importDefault","value_checker_1","UsageJsonFormatter","default","constructor","options","eventBroadcaster","on","envelope","doesHaveValue","testRunFinished","logUsage","usage","getUsage","stepDefinitions","supportCodeLibrary","eventDataCollector","log","JSON","stringify","replacer","key","value","parseInt","exports","documentation"],"sources":["../../src/formatter/usage_json_formatter.ts"],"sourcesContent":["import { getUsage } from './helpers'\nimport Formatter, { IFormatterOptions } from './'\nimport { doesHaveValue } from '../value_checker'\nimport * as messages from '@cucumber/messages'\nimport IEnvelope = messages.Envelope\n\nexport default class UsageJsonFormatter extends Formatter {\n  public static readonly documentation: string =\n    'Does what the Usage Formatter does, but outputs JSON, which can be output to a file and then consumed by other tools.'\n\n  constructor(options: IFormatterOptions) {\n    super(options)\n    options.eventBroadcaster.on('envelope', (envelope: IEnvelope) => {\n      if (doesHaveValue(envelope.testRunFinished)) {\n        this.logUsage()\n      }\n    })\n  }\n\n  logUsage(): void {\n    const usage = getUsage({\n      stepDefinitions: this.supportCodeLibrary.stepDefinitions,\n      eventDataCollector: this.eventDataCollector,\n    })\n    this.log(JSON.stringify(usage, this.replacer, 2))\n  }\n\n  replacer(key: string, value: any): any {\n    if (key === 'seconds') {\n      return parseInt(value)\n    }\n    return value\n  }\n}\n"],"mappings":";;;;;;;;;;AAAA,MAAAA,SAAA,GAAAC,OAAA;AACA,MAAAC,EAAA,GAAAC,eAAA,CAAAF,OAAA;AACA,MAAAG,eAAA,GAAAH,OAAA;AAIA,MAAqBI,kBAAmB,SAAQH,EAAA,CAAAI,OAAS;EAIvDC,YAAYC,OAA0B;IACpC,KAAK,CAACA,OAAO,CAAC;IACdA,OAAO,CAACC,gBAAgB,CAACC,EAAE,CAAC,UAAU,EAAGC,QAAmB,IAAI;MAC9D,IAAI,IAAAP,eAAA,CAAAQ,aAAa,EAACD,QAAQ,CAACE,eAAe,CAAC,EAAE;QAC3C,IAAI,CAACC,QAAQ,EAAE;;IAEnB,CAAC,CAAC;EACJ;EAEAA,QAAQA,CAAA;IACN,MAAMC,KAAK,GAAG,IAAAf,SAAA,CAAAgB,QAAQ,EAAC;MACrBC,eAAe,EAAE,IAAI,CAACC,kBAAkB,CAACD,eAAe;MACxDE,kBAAkB,EAAE,IAAI,CAACA;KAC1B,CAAC;IACF,IAAI,CAACC,GAAG,CAACC,IAAI,CAACC,SAAS,CAACP,KAAK,EAAE,IAAI,CAACQ,QAAQ,EAAE,CAAC,CAAC,CAAC;EACnD;EAEAA,QAAQA,CAACC,GAAW,EAAEC,KAAU;IAC9B,IAAID,GAAG,KAAK,SAAS,EAAE;MACrB,OAAOE,QAAQ,CAACD,KAAK,CAAC;;IAExB,OAAOA,KAAK;EACd;;AA1BFE,OAAA,CAAArB,OAAA,GAAAD,kBAAA;AACyBA,kBAAA,CAAAuB,aAAa,GAClC,uHAAuH"}