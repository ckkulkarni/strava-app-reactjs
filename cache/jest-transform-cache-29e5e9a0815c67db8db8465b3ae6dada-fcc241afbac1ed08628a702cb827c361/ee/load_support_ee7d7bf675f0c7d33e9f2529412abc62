d8098ed9547b94f257bc6e1f553ef333
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.loadSupport = void 0;
const messages_1 = require("@cucumber/messages");
const paths_1 = require("./paths");
const support_1 = require("./support");
const environment_1 = require("./environment");
const console_logger_1 = require("./console_logger");
/**
 * Load support code for use in test runs.
 *
 * @public
 * @param options - Subset of `IRunnableConfiguration` required to find the support code.
 * @param environment - Project environment.
 */
async function loadSupport(options, environment = {}) {
  const {
    cwd,
    stderr,
    debug
  } = (0, environment_1.mergeEnvironment)(environment);
  const logger = new console_logger_1.ConsoleLogger(stderr, debug);
  const newId = messages_1.IdGenerator.uuid();
  const {
    requirePaths,
    importPaths
  } = await (0, paths_1.resolvePaths)(logger, cwd, options.sources, options.support);
  return await (0, support_1.getSupportCodeLibrary)({
    cwd,
    newId,
    requireModules: options.support.requireModules,
    requirePaths,
    importPaths
  });
}
exports.loadSupport = loadSupport;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJtZXNzYWdlc18xIiwicmVxdWlyZSIsInBhdGhzXzEiLCJzdXBwb3J0XzEiLCJlbnZpcm9ubWVudF8xIiwiY29uc29sZV9sb2dnZXJfMSIsImxvYWRTdXBwb3J0Iiwib3B0aW9ucyIsImVudmlyb25tZW50IiwiY3dkIiwic3RkZXJyIiwiZGVidWciLCJtZXJnZUVudmlyb25tZW50IiwibG9nZ2VyIiwiQ29uc29sZUxvZ2dlciIsIm5ld0lkIiwiSWRHZW5lcmF0b3IiLCJ1dWlkIiwicmVxdWlyZVBhdGhzIiwiaW1wb3J0UGF0aHMiLCJyZXNvbHZlUGF0aHMiLCJzb3VyY2VzIiwic3VwcG9ydCIsImdldFN1cHBvcnRDb2RlTGlicmFyeSIsInJlcXVpcmVNb2R1bGVzIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9hcGkvbG9hZF9zdXBwb3J0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IElkR2VuZXJhdG9yIH0gZnJvbSAnQGN1Y3VtYmVyL21lc3NhZ2VzJ1xuaW1wb3J0IHsgSUxvYWRTdXBwb3J0T3B0aW9ucywgSVJ1bkVudmlyb25tZW50IH0gZnJvbSAnLi90eXBlcydcbmltcG9ydCB7IHJlc29sdmVQYXRocyB9IGZyb20gJy4vcGF0aHMnXG5pbXBvcnQgeyBnZXRTdXBwb3J0Q29kZUxpYnJhcnkgfSBmcm9tICcuL3N1cHBvcnQnXG5pbXBvcnQgeyBtZXJnZUVudmlyb25tZW50IH0gZnJvbSAnLi9lbnZpcm9ubWVudCdcbmltcG9ydCB7IElTdXBwb3J0Q29kZUxpYnJhcnkgfSBmcm9tICcuLi9zdXBwb3J0X2NvZGVfbGlicmFyeV9idWlsZGVyL3R5cGVzJ1xuaW1wb3J0IHsgSUxvZ2dlciB9IGZyb20gJy4uL2xvZ2dlcidcbmltcG9ydCB7IENvbnNvbGVMb2dnZXIgfSBmcm9tICcuL2NvbnNvbGVfbG9nZ2VyJ1xuXG4vKipcbiAqIExvYWQgc3VwcG9ydCBjb2RlIGZvciB1c2UgaW4gdGVzdCBydW5zLlxuICpcbiAqIEBwdWJsaWNcbiAqIEBwYXJhbSBvcHRpb25zIC0gU3Vic2V0IG9mIGBJUnVubmFibGVDb25maWd1cmF0aW9uYCByZXF1aXJlZCB0byBmaW5kIHRoZSBzdXBwb3J0IGNvZGUuXG4gKiBAcGFyYW0gZW52aXJvbm1lbnQgLSBQcm9qZWN0IGVudmlyb25tZW50LlxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbG9hZFN1cHBvcnQoXG4gIG9wdGlvbnM6IElMb2FkU3VwcG9ydE9wdGlvbnMsXG4gIGVudmlyb25tZW50OiBJUnVuRW52aXJvbm1lbnQgPSB7fVxuKTogUHJvbWlzZTxJU3VwcG9ydENvZGVMaWJyYXJ5PiB7XG4gIGNvbnN0IHsgY3dkLCBzdGRlcnIsIGRlYnVnIH0gPSBtZXJnZUVudmlyb25tZW50KGVudmlyb25tZW50KVxuICBjb25zdCBsb2dnZXI6IElMb2dnZXIgPSBuZXcgQ29uc29sZUxvZ2dlcihzdGRlcnIsIGRlYnVnKVxuICBjb25zdCBuZXdJZCA9IElkR2VuZXJhdG9yLnV1aWQoKVxuICBjb25zdCB7IHJlcXVpcmVQYXRocywgaW1wb3J0UGF0aHMgfSA9IGF3YWl0IHJlc29sdmVQYXRocyhcbiAgICBsb2dnZXIsXG4gICAgY3dkLFxuICAgIG9wdGlvbnMuc291cmNlcyxcbiAgICBvcHRpb25zLnN1cHBvcnRcbiAgKVxuICByZXR1cm4gYXdhaXQgZ2V0U3VwcG9ydENvZGVMaWJyYXJ5KHtcbiAgICBjd2QsXG4gICAgbmV3SWQsXG4gICAgcmVxdWlyZU1vZHVsZXM6IG9wdGlvbnMuc3VwcG9ydC5yZXF1aXJlTW9kdWxlcyxcbiAgICByZXF1aXJlUGF0aHMsXG4gICAgaW1wb3J0UGF0aHMsXG4gIH0pXG59XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLE1BQUFBLFVBQUEsR0FBQUMsT0FBQTtBQUVBLE1BQUFDLE9BQUEsR0FBQUQsT0FBQTtBQUNBLE1BQUFFLFNBQUEsR0FBQUYsT0FBQTtBQUNBLE1BQUFHLGFBQUEsR0FBQUgsT0FBQTtBQUdBLE1BQUFJLGdCQUFBLEdBQUFKLE9BQUE7QUFFQTs7Ozs7OztBQU9PLGVBQWVLLFdBQVdBLENBQy9CQyxPQUE0QixFQUM1QkMsV0FBQSxHQUErQixFQUFFO0VBRWpDLE1BQU07SUFBRUMsR0FBRztJQUFFQyxNQUFNO0lBQUVDO0VBQUssQ0FBRSxHQUFHLElBQUFQLGFBQUEsQ0FBQVEsZ0JBQWdCLEVBQUNKLFdBQVcsQ0FBQztFQUM1RCxNQUFNSyxNQUFNLEdBQVksSUFBSVIsZ0JBQUEsQ0FBQVMsYUFBYSxDQUFDSixNQUFNLEVBQUVDLEtBQUssQ0FBQztFQUN4RCxNQUFNSSxLQUFLLEdBQUdmLFVBQUEsQ0FBQWdCLFdBQVcsQ0FBQ0MsSUFBSSxFQUFFO0VBQ2hDLE1BQU07SUFBRUMsWUFBWTtJQUFFQztFQUFXLENBQUUsR0FBRyxNQUFNLElBQUFqQixPQUFBLENBQUFrQixZQUFZLEVBQ3REUCxNQUFNLEVBQ05KLEdBQUcsRUFDSEYsT0FBTyxDQUFDYyxPQUFPLEVBQ2ZkLE9BQU8sQ0FBQ2UsT0FBTyxDQUNoQjtFQUNELE9BQU8sTUFBTSxJQUFBbkIsU0FBQSxDQUFBb0IscUJBQXFCLEVBQUM7SUFDakNkLEdBQUc7SUFDSE0sS0FBSztJQUNMUyxjQUFjLEVBQUVqQixPQUFPLENBQUNlLE9BQU8sQ0FBQ0UsY0FBYztJQUM5Q04sWUFBWTtJQUNaQztHQUNELENBQUM7QUFDSjtBQXBCQU0sT0FBQSxDQUFBbkIsV0FBQSxHQUFBQSxXQUFBIn0=