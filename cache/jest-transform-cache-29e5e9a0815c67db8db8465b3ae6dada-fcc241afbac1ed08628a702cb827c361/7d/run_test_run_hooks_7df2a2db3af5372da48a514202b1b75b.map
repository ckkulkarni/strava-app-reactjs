{"version":3,"names":["user_code_runner_1","__importDefault","require","verror_1","helpers_1","value_checker_1","makeRunTestRunHooks","dryRun","defaultTimeout","errorMessage","definitions","name","hookDefinition","error","default","run","argsArray","fn","code","thisArg","timeoutInMilliseconds","valueOrDefault","options","timeout","doesHaveValue","location","formatLocation","exports"],"sources":["../../src/runtime/run_test_run_hooks.ts"],"sourcesContent":["import UserCodeRunner from '../user_code_runner'\nimport VError from 'verror'\nimport { formatLocation } from '../formatter/helpers'\nimport { doesHaveValue, valueOrDefault } from '../value_checker'\nimport TestRunHookDefinition from '../models/test_run_hook_definition'\n\nexport type RunsTestRunHooks = (\n  definitions: TestRunHookDefinition[],\n  name: string\n) => Promise<void>\n\nexport const makeRunTestRunHooks = (\n  dryRun: boolean,\n  defaultTimeout: number,\n  errorMessage: (name: string, location: string) => string\n): RunsTestRunHooks =>\n  dryRun\n    ? async () => {}\n    : async (definitions, name) => {\n        for (const hookDefinition of definitions) {\n          const { error } = await UserCodeRunner.run({\n            argsArray: [],\n            fn: hookDefinition.code,\n            thisArg: null,\n            timeoutInMilliseconds: valueOrDefault(\n              hookDefinition.options.timeout,\n              defaultTimeout\n            ),\n          })\n          if (doesHaveValue(error)) {\n            const location = formatLocation(hookDefinition)\n            throw new VError(error, errorMessage(name, location))\n          }\n        }\n      }\n"],"mappings":";;;;;;;;;;;AAAA,MAAAA,kBAAA,GAAAC,eAAA,CAAAC,OAAA;AACA,MAAAC,QAAA,GAAAF,eAAA,CAAAC,OAAA;AACA,MAAAE,SAAA,GAAAF,OAAA;AACA,MAAAG,eAAA,GAAAH,OAAA;AAQO,MAAMI,mBAAmB,GAAGA,CACjCC,MAAe,EACfC,cAAsB,EACtBC,YAAwD,KAExDF,MAAM,GACF,YAAW,CAAE,CAAC,GACd,OAAOG,WAAW,EAAEC,IAAI,KAAI;EAC1B,KAAK,MAAMC,cAAc,IAAIF,WAAW,EAAE;IACxC,MAAM;MAAEG;IAAK,CAAE,GAAG,MAAMb,kBAAA,CAAAc,OAAc,CAACC,GAAG,CAAC;MACzCC,SAAS,EAAE,EAAE;MACbC,EAAE,EAAEL,cAAc,CAACM,IAAI;MACvBC,OAAO,EAAE,IAAI;MACbC,qBAAqB,EAAE,IAAAf,eAAA,CAAAgB,cAAc,EACnCT,cAAc,CAACU,OAAO,CAACC,OAAO,EAC9Bf,cAAc;KAEjB,CAAC;IACF,IAAI,IAAAH,eAAA,CAAAmB,aAAa,EAACX,KAAK,CAAC,EAAE;MACxB,MAAMY,QAAQ,GAAG,IAAArB,SAAA,CAAAsB,cAAc,EAACd,cAAc,CAAC;MAC/C,MAAM,IAAIT,QAAA,CAAAW,OAAM,CAACD,KAAK,EAAEJ,YAAY,CAACE,IAAI,EAAEc,QAAQ,CAAC,CAAC;;;AAG3D,CAAC;AAvBME,OAAA,CAAArB,mBAAmB,GAAAA,mBAAA"}