{"version":3,"names":["YAMLSeq","require","toJS","Node","YAMLMap","pairs","YAMLOMap","constructor","add","prototype","bind","delete","get","has","set","tag","toJSON","_","ctx","map","Map","onCreate","pair","items","key","value","isPair","Error","omap","collection","identify","nodeClass","default","resolve","seq","onError","pairs$1","resolvePairs","seenKeys","isScalar","includes","push","Object","assign","createNode","schema","iterable","createPairs","exports"],"sources":["omap.js"],"sourcesContent":["'use strict';\n\nvar YAMLSeq = require('../../nodes/YAMLSeq.js');\nvar toJS = require('../../nodes/toJS.js');\nvar Node = require('../../nodes/Node.js');\nvar YAMLMap = require('../../nodes/YAMLMap.js');\nvar pairs = require('./pairs.js');\n\nclass YAMLOMap extends YAMLSeq.YAMLSeq {\n    constructor() {\n        super();\n        this.add = YAMLMap.YAMLMap.prototype.add.bind(this);\n        this.delete = YAMLMap.YAMLMap.prototype.delete.bind(this);\n        this.get = YAMLMap.YAMLMap.prototype.get.bind(this);\n        this.has = YAMLMap.YAMLMap.prototype.has.bind(this);\n        this.set = YAMLMap.YAMLMap.prototype.set.bind(this);\n        this.tag = YAMLOMap.tag;\n    }\n    /**\n     * If `ctx` is given, the return type is actually `Map<unknown, unknown>`,\n     * but TypeScript won't allow widening the signature of a child method.\n     */\n    toJSON(_, ctx) {\n        if (!ctx)\n            return super.toJSON(_);\n        const map = new Map();\n        if (ctx?.onCreate)\n            ctx.onCreate(map);\n        for (const pair of this.items) {\n            let key, value;\n            if (Node.isPair(pair)) {\n                key = toJS.toJS(pair.key, '', ctx);\n                value = toJS.toJS(pair.value, key, ctx);\n            }\n            else {\n                key = toJS.toJS(pair, '', ctx);\n            }\n            if (map.has(key))\n                throw new Error('Ordered maps must not include duplicate keys');\n            map.set(key, value);\n        }\n        return map;\n    }\n}\nYAMLOMap.tag = 'tag:yaml.org,2002:omap';\nconst omap = {\n    collection: 'seq',\n    identify: value => value instanceof Map,\n    nodeClass: YAMLOMap,\n    default: false,\n    tag: 'tag:yaml.org,2002:omap',\n    resolve(seq, onError) {\n        const pairs$1 = pairs.resolvePairs(seq, onError);\n        const seenKeys = [];\n        for (const { key } of pairs$1.items) {\n            if (Node.isScalar(key)) {\n                if (seenKeys.includes(key.value)) {\n                    onError(`Ordered maps must not include duplicate keys: ${key.value}`);\n                }\n                else {\n                    seenKeys.push(key.value);\n                }\n            }\n        }\n        return Object.assign(new YAMLOMap(), pairs$1);\n    },\n    createNode(schema, iterable, ctx) {\n        const pairs$1 = pairs.createPairs(schema, iterable, ctx);\n        const omap = new YAMLOMap();\n        omap.items = pairs$1.items;\n        return omap;\n    }\n};\n\nexports.YAMLOMap = YAMLOMap;\nexports.omap = omap;\n"],"mappings":"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"}