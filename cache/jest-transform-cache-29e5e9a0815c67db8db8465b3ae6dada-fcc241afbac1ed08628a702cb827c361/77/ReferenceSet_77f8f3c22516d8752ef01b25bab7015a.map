{"version":3,"names":["Object","defineProperty","exports","value","default","_Reference","_interopRequireDefault","require","obj","__esModule","ReferenceSet","constructor","list","refs","Set","Map","size","describe","description","item","push","ref","toArray","Array","from","concat","values","resolveAll","resolve","reduce","acc","e","isRef","add","set","key","delete","clone","next","merge","newItems","removeItems","forEach"],"sources":["ReferenceSet.js"],"sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _Reference = _interopRequireDefault(require(\"../Reference\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nclass ReferenceSet {\n  constructor() {\n    this.list = void 0;\n    this.refs = void 0;\n    this.list = new Set();\n    this.refs = new Map();\n  }\n\n  get size() {\n    return this.list.size + this.refs.size;\n  }\n\n  describe() {\n    const description = [];\n\n    for (const item of this.list) description.push(item);\n\n    for (const [, ref] of this.refs) description.push(ref.describe());\n\n    return description;\n  }\n\n  toArray() {\n    return Array.from(this.list).concat(Array.from(this.refs.values()));\n  }\n\n  resolveAll(resolve) {\n    return this.toArray().reduce((acc, e) => acc.concat(_Reference.default.isRef(e) ? resolve(e) : e), []);\n  }\n\n  add(value) {\n    _Reference.default.isRef(value) ? this.refs.set(value.key, value) : this.list.add(value);\n  }\n\n  delete(value) {\n    _Reference.default.isRef(value) ? this.refs.delete(value.key) : this.list.delete(value);\n  }\n\n  clone() {\n    const next = new ReferenceSet();\n    next.list = new Set(this.list);\n    next.refs = new Map(this.refs);\n    return next;\n  }\n\n  merge(newItems, removeItems) {\n    const next = this.clone();\n    newItems.list.forEach(value => next.add(value));\n    newItems.refs.forEach(value => next.add(value));\n    removeItems.list.forEach(value => next.delete(value));\n    removeItems.refs.forEach(value => next.delete(value));\n    return next;\n  }\n\n}\n\nexports.default = ReferenceSet;"],"mappings":"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"}