{"version":3,"names":["optionsValidation","expectedType","predicate","options","optionsTimeoutValidation","identifier","timeout","fnValidation","code","validations","defineTestRunHook","defineTestCaseHook","tags","defineTestStepHook","defineStep","pattern","RegExp","validateArguments","args","fnName","location","forEach","Error","exports","default"],"sources":["../../src/support_code_library_builder/validate_arguments.ts"],"sourcesContent":["import { DefineStepPattern, IDefineStepOptions } from './types'\n\ninterface IValidation {\n  identifier: string\n  expectedType: string\n  predicate: (args: any) => boolean\n}\n\ninterface IDefineStepArguments {\n  pattern?: DefineStepPattern\n  options?: IDefineStepOptions\n  code?: Function\n}\n\nconst optionsValidation = {\n  expectedType: 'object or function',\n  predicate({ options }: IDefineStepArguments) {\n    return typeof options === 'object'\n  },\n}\n\nconst optionsTimeoutValidation = {\n  identifier: '\"options.timeout\"',\n  expectedType: 'integer',\n  predicate({ options }: IDefineStepArguments) {\n    return options.timeout == null || typeof options.timeout === 'number'\n  },\n}\n\nconst fnValidation = {\n  expectedType: 'function',\n  predicate({ code }: IDefineStepArguments) {\n    return typeof code === 'function'\n  },\n}\n\nconst validations: Record<string, IValidation[]> = {\n  defineTestRunHook: [\n    { identifier: 'first argument', ...optionsValidation },\n    optionsTimeoutValidation,\n    { identifier: 'second argument', ...fnValidation },\n  ],\n  defineTestCaseHook: [\n    { identifier: 'first argument', ...optionsValidation },\n    {\n      identifier: '\"options.tags\"',\n      expectedType: 'string',\n      predicate({ options }) {\n        return options.tags == null || typeof options.tags === 'string'\n      },\n    },\n    optionsTimeoutValidation,\n    { identifier: 'second argument', ...fnValidation },\n  ],\n  defineTestStepHook: [\n    { identifier: 'first argument', ...optionsValidation },\n    {\n      identifier: '\"options.tags\"',\n      expectedType: 'string',\n      predicate({ options }) {\n        return options.tags == null || typeof options.tags === 'string'\n      },\n    },\n    optionsTimeoutValidation,\n    { identifier: 'second argument', ...fnValidation },\n  ],\n  defineStep: [\n    {\n      identifier: 'first argument',\n      expectedType: 'string or regular expression',\n      predicate({ pattern }) {\n        return pattern instanceof RegExp || typeof pattern === 'string'\n      },\n    },\n    { identifier: 'second argument', ...optionsValidation },\n    optionsTimeoutValidation,\n    { identifier: 'third argument', ...fnValidation },\n  ],\n}\n\nexport default function validateArguments({\n  args,\n  fnName,\n  location,\n}: {\n  args?: IDefineStepArguments\n  fnName: string\n  location: string\n}): void {\n  validations[fnName].forEach(({ identifier, expectedType, predicate }) => {\n    if (!predicate(args)) {\n      throw new Error(\n        `${location}: Invalid ${identifier}: should be a ${expectedType}`\n      )\n    }\n  })\n}\n"],"mappings":";;;;;AAcA,MAAMA,iBAAiB,GAAG;EACxBC,YAAY,EAAE,oBAAoB;EAClCC,SAASA,CAAC;IAAEC;EAAO,CAAwB;IACzC,OAAO,OAAOA,OAAO,KAAK,QAAQ;EACpC;CACD;AAED,MAAMC,wBAAwB,GAAG;EAC/BC,UAAU,EAAE,mBAAmB;EAC/BJ,YAAY,EAAE,SAAS;EACvBC,SAASA,CAAC;IAAEC;EAAO,CAAwB;IACzC,OAAOA,OAAO,CAACG,OAAO,IAAI,IAAI,IAAI,OAAOH,OAAO,CAACG,OAAO,KAAK,QAAQ;EACvE;CACD;AAED,MAAMC,YAAY,GAAG;EACnBN,YAAY,EAAE,UAAU;EACxBC,SAASA,CAAC;IAAEM;EAAI,CAAwB;IACtC,OAAO,OAAOA,IAAI,KAAK,UAAU;EACnC;CACD;AAED,MAAMC,WAAW,GAAkC;EACjDC,iBAAiB,EAAE,CACjB;IAAEL,UAAU,EAAE,gBAAgB;IAAE,GAAGL;EAAiB,CAAE,EACtDI,wBAAwB,EACxB;IAAEC,UAAU,EAAE,iBAAiB;IAAE,GAAGE;EAAY,CAAE,CACnD;EACDI,kBAAkB,EAAE,CAClB;IAAEN,UAAU,EAAE,gBAAgB;IAAE,GAAGL;EAAiB,CAAE,EACtD;IACEK,UAAU,EAAE,gBAAgB;IAC5BJ,YAAY,EAAE,QAAQ;IACtBC,SAASA,CAAC;MAAEC;IAAO,CAAE;MACnB,OAAOA,OAAO,CAACS,IAAI,IAAI,IAAI,IAAI,OAAOT,OAAO,CAACS,IAAI,KAAK,QAAQ;IACjE;GACD,EACDR,wBAAwB,EACxB;IAAEC,UAAU,EAAE,iBAAiB;IAAE,GAAGE;EAAY,CAAE,CACnD;EACDM,kBAAkB,EAAE,CAClB;IAAER,UAAU,EAAE,gBAAgB;IAAE,GAAGL;EAAiB,CAAE,EACtD;IACEK,UAAU,EAAE,gBAAgB;IAC5BJ,YAAY,EAAE,QAAQ;IACtBC,SAASA,CAAC;MAAEC;IAAO,CAAE;MACnB,OAAOA,OAAO,CAACS,IAAI,IAAI,IAAI,IAAI,OAAOT,OAAO,CAACS,IAAI,KAAK,QAAQ;IACjE;GACD,EACDR,wBAAwB,EACxB;IAAEC,UAAU,EAAE,iBAAiB;IAAE,GAAGE;EAAY,CAAE,CACnD;EACDO,UAAU,EAAE,CACV;IACET,UAAU,EAAE,gBAAgB;IAC5BJ,YAAY,EAAE,8BAA8B;IAC5CC,SAASA,CAAC;MAAEa;IAAO,CAAE;MACnB,OAAOA,OAAO,YAAYC,MAAM,IAAI,OAAOD,OAAO,KAAK,QAAQ;IACjE;GACD,EACD;IAAEV,UAAU,EAAE,iBAAiB;IAAE,GAAGL;EAAiB,CAAE,EACvDI,wBAAwB,EACxB;IAAEC,UAAU,EAAE,gBAAgB;IAAE,GAAGE;EAAY,CAAE;CAEpD;AAED,SAAwBU,iBAAiBA,CAAC;EACxCC,IAAI;EACJC,MAAM;EACNC;AAAQ,CAKT;EACCX,WAAW,CAACU,MAAM,CAAC,CAACE,OAAO,CAAC,CAAC;IAAEhB,UAAU;IAAEJ,YAAY;IAAEC;EAAS,CAAE,KAAI;IACtE,IAAI,CAACA,SAAS,CAACgB,IAAI,CAAC,EAAE;MACpB,MAAM,IAAII,KAAK,CACb,GAAGF,QAAQ,aAAaf,UAAU,iBAAiBJ,YAAY,EAAE,CAClE;;EAEL,CAAC,CAAC;AACJ;AAhBAsB,OAAA,CAAAC,OAAA,GAAAP,iBAAA"}