{"version":3,"names":["_1","__importDefault","require","resolve_pkg_1","html_formatter_1","stream_1","util_1","HtmlFormatter","default","constructor","options","_htmlStream","cwd","__dirname","eventBroadcaster","on","envelope","write","chunk","log","finished","end","promisify","exports","documentation"],"sources":["../../src/formatter/html_formatter.ts"],"sourcesContent":["import Formatter, { IFormatterOptions } from '.'\nimport * as messages from '@cucumber/messages'\nimport resolvePkg from 'resolve-pkg'\nimport CucumberHtmlStream from '@cucumber/html-formatter'\nimport { finished } from 'stream'\nimport { promisify } from 'util'\n\nexport default class HtmlFormatter extends Formatter {\n  private readonly _htmlStream: CucumberHtmlStream\n  public static readonly documentation: string = 'Outputs HTML report'\n\n  constructor(options: IFormatterOptions) {\n    super(options)\n    this._htmlStream = new CucumberHtmlStream(\n      resolvePkg('@cucumber/html-formatter', { cwd: __dirname }) +\n        '/dist/main.css',\n      resolvePkg('@cucumber/html-formatter', { cwd: __dirname }) +\n        '/dist/main.js'\n    )\n    options.eventBroadcaster.on('envelope', (envelope: messages.Envelope) => {\n      this._htmlStream.write(envelope)\n    })\n    this._htmlStream.on('data', (chunk) => this.log(chunk))\n  }\n\n  async finished(): Promise<void> {\n    this._htmlStream.end()\n    await promisify(finished)(this._htmlStream)\n    await super.finished()\n  }\n}\n"],"mappings":";;;;;;;;;;AAAA,MAAAA,EAAA,GAAAC,eAAA,CAAAC,OAAA;AAEA,MAAAC,aAAA,GAAAF,eAAA,CAAAC,OAAA;AACA,MAAAE,gBAAA,GAAAH,eAAA,CAAAC,OAAA;AACA,MAAAG,QAAA,GAAAH,OAAA;AACA,MAAAI,MAAA,GAAAJ,OAAA;AAEA,MAAqBK,aAAc,SAAQP,EAAA,CAAAQ,OAAS;EAIlDC,YAAYC,OAA0B;IACpC,KAAK,CAACA,OAAO,CAAC;IACd,IAAI,CAACC,WAAW,GAAG,IAAIP,gBAAA,CAAAI,OAAkB,CACvC,IAAAL,aAAA,CAAAK,OAAU,EAAC,0BAA0B,EAAE;MAAEI,GAAG,EAAEC;IAAS,CAAE,CAAC,GACxD,gBAAgB,EAClB,IAAAV,aAAA,CAAAK,OAAU,EAAC,0BAA0B,EAAE;MAAEI,GAAG,EAAEC;IAAS,CAAE,CAAC,GACxD,eAAe,CAClB;IACDH,OAAO,CAACI,gBAAgB,CAACC,EAAE,CAAC,UAAU,EAAGC,QAA2B,IAAI;MACtE,IAAI,CAACL,WAAW,CAACM,KAAK,CAACD,QAAQ,CAAC;IAClC,CAAC,CAAC;IACF,IAAI,CAACL,WAAW,CAACI,EAAE,CAAC,MAAM,EAAGG,KAAK,IAAK,IAAI,CAACC,GAAG,CAACD,KAAK,CAAC,CAAC;EACzD;EAEA,MAAME,QAAQA,CAAA;IACZ,IAAI,CAACT,WAAW,CAACU,GAAG,EAAE;IACtB,MAAM,IAAAf,MAAA,CAAAgB,SAAS,EAACjB,QAAA,CAAAe,QAAQ,CAAC,CAAC,IAAI,CAACT,WAAW,CAAC;IAC3C,MAAM,KAAK,CAACS,QAAQ,EAAE;EACxB;;AAtBFG,OAAA,CAAAf,OAAA,GAAAD,aAAA;AAEyBA,aAAA,CAAAiB,aAAa,GAAW,qBAAqB"}