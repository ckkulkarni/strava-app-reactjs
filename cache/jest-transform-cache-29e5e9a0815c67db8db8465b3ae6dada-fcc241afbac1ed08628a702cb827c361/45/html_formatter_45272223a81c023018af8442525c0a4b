3e75ea815156ab16136c87d143dadb84
"use strict";

var __importDefault = void 0 && (void 0).__importDefault || function (mod) {
  return mod && mod.__esModule ? mod : {
    "default": mod
  };
};
Object.defineProperty(exports, "__esModule", {
  value: true
});
const _1 = __importDefault(require("."));
const resolve_pkg_1 = __importDefault(require("resolve-pkg"));
const html_formatter_1 = __importDefault(require("@cucumber/html-formatter"));
const stream_1 = require("stream");
const util_1 = require("util");
class HtmlFormatter extends _1.default {
  constructor(options) {
    super(options);
    this._htmlStream = new html_formatter_1.default((0, resolve_pkg_1.default)('@cucumber/html-formatter', {
      cwd: __dirname
    }) + '/dist/main.css', (0, resolve_pkg_1.default)('@cucumber/html-formatter', {
      cwd: __dirname
    }) + '/dist/main.js');
    options.eventBroadcaster.on('envelope', envelope => {
      this._htmlStream.write(envelope);
    });
    this._htmlStream.on('data', chunk => this.log(chunk));
  }
  async finished() {
    this._htmlStream.end();
    await (0, util_1.promisify)(stream_1.finished)(this._htmlStream);
    await super.finished();
  }
}
exports.default = HtmlFormatter;
HtmlFormatter.documentation = 'Outputs HTML report';
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfMSIsIl9faW1wb3J0RGVmYXVsdCIsInJlcXVpcmUiLCJyZXNvbHZlX3BrZ18xIiwiaHRtbF9mb3JtYXR0ZXJfMSIsInN0cmVhbV8xIiwidXRpbF8xIiwiSHRtbEZvcm1hdHRlciIsImRlZmF1bHQiLCJjb25zdHJ1Y3RvciIsIm9wdGlvbnMiLCJfaHRtbFN0cmVhbSIsImN3ZCIsIl9fZGlybmFtZSIsImV2ZW50QnJvYWRjYXN0ZXIiLCJvbiIsImVudmVsb3BlIiwid3JpdGUiLCJjaHVuayIsImxvZyIsImZpbmlzaGVkIiwiZW5kIiwicHJvbWlzaWZ5IiwiZXhwb3J0cyIsImRvY3VtZW50YXRpb24iXSwic291cmNlcyI6WyIuLi8uLi9zcmMvZm9ybWF0dGVyL2h0bWxfZm9ybWF0dGVyLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBGb3JtYXR0ZXIsIHsgSUZvcm1hdHRlck9wdGlvbnMgfSBmcm9tICcuJ1xuaW1wb3J0ICogYXMgbWVzc2FnZXMgZnJvbSAnQGN1Y3VtYmVyL21lc3NhZ2VzJ1xuaW1wb3J0IHJlc29sdmVQa2cgZnJvbSAncmVzb2x2ZS1wa2cnXG5pbXBvcnQgQ3VjdW1iZXJIdG1sU3RyZWFtIGZyb20gJ0BjdWN1bWJlci9odG1sLWZvcm1hdHRlcidcbmltcG9ydCB7IGZpbmlzaGVkIH0gZnJvbSAnc3RyZWFtJ1xuaW1wb3J0IHsgcHJvbWlzaWZ5IH0gZnJvbSAndXRpbCdcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgSHRtbEZvcm1hdHRlciBleHRlbmRzIEZvcm1hdHRlciB7XG4gIHByaXZhdGUgcmVhZG9ubHkgX2h0bWxTdHJlYW06IEN1Y3VtYmVySHRtbFN0cmVhbVxuICBwdWJsaWMgc3RhdGljIHJlYWRvbmx5IGRvY3VtZW50YXRpb246IHN0cmluZyA9ICdPdXRwdXRzIEhUTUwgcmVwb3J0J1xuXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnM6IElGb3JtYXR0ZXJPcHRpb25zKSB7XG4gICAgc3VwZXIob3B0aW9ucylcbiAgICB0aGlzLl9odG1sU3RyZWFtID0gbmV3IEN1Y3VtYmVySHRtbFN0cmVhbShcbiAgICAgIHJlc29sdmVQa2coJ0BjdWN1bWJlci9odG1sLWZvcm1hdHRlcicsIHsgY3dkOiBfX2Rpcm5hbWUgfSkgK1xuICAgICAgICAnL2Rpc3QvbWFpbi5jc3MnLFxuICAgICAgcmVzb2x2ZVBrZygnQGN1Y3VtYmVyL2h0bWwtZm9ybWF0dGVyJywgeyBjd2Q6IF9fZGlybmFtZSB9KSArXG4gICAgICAgICcvZGlzdC9tYWluLmpzJ1xuICAgIClcbiAgICBvcHRpb25zLmV2ZW50QnJvYWRjYXN0ZXIub24oJ2VudmVsb3BlJywgKGVudmVsb3BlOiBtZXNzYWdlcy5FbnZlbG9wZSkgPT4ge1xuICAgICAgdGhpcy5faHRtbFN0cmVhbS53cml0ZShlbnZlbG9wZSlcbiAgICB9KVxuICAgIHRoaXMuX2h0bWxTdHJlYW0ub24oJ2RhdGEnLCAoY2h1bmspID0+IHRoaXMubG9nKGNodW5rKSlcbiAgfVxuXG4gIGFzeW5jIGZpbmlzaGVkKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRoaXMuX2h0bWxTdHJlYW0uZW5kKClcbiAgICBhd2FpdCBwcm9taXNpZnkoZmluaXNoZWQpKHRoaXMuX2h0bWxTdHJlYW0pXG4gICAgYXdhaXQgc3VwZXIuZmluaXNoZWQoKVxuICB9XG59XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFBQSxNQUFBQSxFQUFBLEdBQUFDLGVBQUEsQ0FBQUMsT0FBQTtBQUVBLE1BQUFDLGFBQUEsR0FBQUYsZUFBQSxDQUFBQyxPQUFBO0FBQ0EsTUFBQUUsZ0JBQUEsR0FBQUgsZUFBQSxDQUFBQyxPQUFBO0FBQ0EsTUFBQUcsUUFBQSxHQUFBSCxPQUFBO0FBQ0EsTUFBQUksTUFBQSxHQUFBSixPQUFBO0FBRUEsTUFBcUJLLGFBQWMsU0FBUVAsRUFBQSxDQUFBUSxPQUFTO0VBSWxEQyxZQUFZQyxPQUEwQjtJQUNwQyxLQUFLLENBQUNBLE9BQU8sQ0FBQztJQUNkLElBQUksQ0FBQ0MsV0FBVyxHQUFHLElBQUlQLGdCQUFBLENBQUFJLE9BQWtCLENBQ3ZDLElBQUFMLGFBQUEsQ0FBQUssT0FBVSxFQUFDLDBCQUEwQixFQUFFO01BQUVJLEdBQUcsRUFBRUM7SUFBUyxDQUFFLENBQUMsR0FDeEQsZ0JBQWdCLEVBQ2xCLElBQUFWLGFBQUEsQ0FBQUssT0FBVSxFQUFDLDBCQUEwQixFQUFFO01BQUVJLEdBQUcsRUFBRUM7SUFBUyxDQUFFLENBQUMsR0FDeEQsZUFBZSxDQUNsQjtJQUNESCxPQUFPLENBQUNJLGdCQUFnQixDQUFDQyxFQUFFLENBQUMsVUFBVSxFQUFHQyxRQUEyQixJQUFJO01BQ3RFLElBQUksQ0FBQ0wsV0FBVyxDQUFDTSxLQUFLLENBQUNELFFBQVEsQ0FBQztJQUNsQyxDQUFDLENBQUM7SUFDRixJQUFJLENBQUNMLFdBQVcsQ0FBQ0ksRUFBRSxDQUFDLE1BQU0sRUFBR0csS0FBSyxJQUFLLElBQUksQ0FBQ0MsR0FBRyxDQUFDRCxLQUFLLENBQUMsQ0FBQztFQUN6RDtFQUVBLE1BQU1FLFFBQVFBLENBQUE7SUFDWixJQUFJLENBQUNULFdBQVcsQ0FBQ1UsR0FBRyxFQUFFO0lBQ3RCLE1BQU0sSUFBQWYsTUFBQSxDQUFBZ0IsU0FBUyxFQUFDakIsUUFBQSxDQUFBZSxRQUFRLENBQUMsQ0FBQyxJQUFJLENBQUNULFdBQVcsQ0FBQztJQUMzQyxNQUFNLEtBQUssQ0FBQ1MsUUFBUSxFQUFFO0VBQ3hCOztBQXRCRkcsT0FBQSxDQUFBZixPQUFBLEdBQUFELGFBQUE7QUFFeUJBLGFBQUEsQ0FBQWlCLGFBQWEsR0FBVyxxQkFBcUIifQ==