a4707bebdeb60f02f1ff5e3f11406146
"use strict";

var _react = _interopRequireDefault(require("react"));
var _react2 = require("@testing-library/react");
var _reactRouterDom = require("react-router-dom");
var _PaymentScreen = _interopRequireDefault(require("../../PaymentScreen"));
var _toolkit = require("@reduxjs/toolkit");
var _parkingSlice = _interopRequireDefault(require("./../../redux/reducer/parkingSlice"));
var _reactRedux = require("react-redux");
require("@testing-library/jest-dom/extend-expect");
var _jestCucumber = require("jest-cucumber");
function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }
const feature = (0, _jestCucumber.loadFeature)("src/components/features/paymentscreen.feature");
(0, _jestCucumber.defineFeature)(feature, test => {
  test("User pays for occupied parking spot", ({
    given,
    when,
    then,
    and
  }) => {
    const alertMock = jest.spyOn(window, "alert").mockImplementation(() => {});
    const state = {
      spaceDetails: {
        registration: "ABC",
        parkingTime: "10:00"
      },
      space: "1"
    };
    const store = (0, _toolkit.configureStore)({
      reducer: {
        parkingSpaces: _parkingSlice.default
      }
    });
    const screen = (0, _react2.render)( /*#__PURE__*/_react.default.createElement(_reactRedux.Provider, {
      store: store
    }, /*#__PURE__*/_react.default.createElement(_reactRouterDom.MemoryRouter, {
      initialEntries: [{
        pathname: "/payment",
        state
      }]
    }, /*#__PURE__*/_react.default.createElement(_reactRouterDom.Routes, null, /*#__PURE__*/_react.default.createElement(_reactRouterDom.Route, {
      path: "/payment",
      element: /*#__PURE__*/_react.default.createElement(_PaymentScreen.default, null)
    })))));
    given("I am on the Payment Screen", () => {
      expect(screen).toBeDefined();
    });
    and("I see the vehicle registration and hours parked for the occupied parking spot", () => {
      const regElement = screen.getByTestId("reg");
      expect(regElement).toHaveTextContent("Vehicle Registration: ABC");
      const parkingHoursElement = screen.getByTestId("parkingHours");
      expect(parkingHoursElement).toHaveTextContent("Hours Parked: 9");
    });
    and("I see the parking charge for the occupied parking spot", () => {
      const paymentElement = screen.getByTestId("payment");
      expect(paymentElement).toHaveTextContent("Parking Charge: $80");
    });
    when("I click on the Make Payment button", () => {
      const paymentButton = screen.getByTestId("paymentButton");
      _react2.fireEvent.click(paymentButton);
    });
    then("I see an alert indicating that the payment was successful", async () => {
      const postMock = jest.fn().mockResolvedValueOnce({
        ok: true
      });
      global.fetch = jest.fn().mockResolvedValueOnce({
        ok: true,
        json: jest.fn().mockResolvedValueOnce({})
      });
      const paymentButton = screen.getByTestId("paymentButton");
      _react2.fireEvent.click(paymentButton);
      expect(fetch).toHaveBeenCalledWith("https://httpstat.us/200", {
        method: "POST",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify({
          "car-registration": state.spaceDetails.registration,
          charge: 10
        })
      });
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcmVhY3QiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9yZWFjdDIiLCJfcmVhY3RSb3V0ZXJEb20iLCJfUGF5bWVudFNjcmVlbiIsIl90b29sa2l0IiwiX3BhcmtpbmdTbGljZSIsIl9yZWFjdFJlZHV4IiwiX2plc3RDdWN1bWJlciIsIm9iaiIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiZmVhdHVyZSIsImxvYWRGZWF0dXJlIiwiZGVmaW5lRmVhdHVyZSIsInRlc3QiLCJnaXZlbiIsIndoZW4iLCJ0aGVuIiwiYW5kIiwiYWxlcnRNb2NrIiwiamVzdCIsInNweU9uIiwid2luZG93IiwibW9ja0ltcGxlbWVudGF0aW9uIiwic3RhdGUiLCJzcGFjZURldGFpbHMiLCJyZWdpc3RyYXRpb24iLCJwYXJraW5nVGltZSIsInNwYWNlIiwic3RvcmUiLCJjb25maWd1cmVTdG9yZSIsInJlZHVjZXIiLCJwYXJraW5nU3BhY2VzIiwicGFya2luZ1NsaWNlIiwic2NyZWVuIiwicmVuZGVyIiwiY3JlYXRlRWxlbWVudCIsIlByb3ZpZGVyIiwiTWVtb3J5Um91dGVyIiwiaW5pdGlhbEVudHJpZXMiLCJwYXRobmFtZSIsIlJvdXRlcyIsIlJvdXRlIiwicGF0aCIsImVsZW1lbnQiLCJleHBlY3QiLCJ0b0JlRGVmaW5lZCIsInJlZ0VsZW1lbnQiLCJnZXRCeVRlc3RJZCIsInRvSGF2ZVRleHRDb250ZW50IiwicGFya2luZ0hvdXJzRWxlbWVudCIsInBheW1lbnRFbGVtZW50IiwicGF5bWVudEJ1dHRvbiIsImZpcmVFdmVudCIsImNsaWNrIiwicG9zdE1vY2siLCJmbiIsIm1vY2tSZXNvbHZlZFZhbHVlT25jZSIsIm9rIiwiZ2xvYmFsIiwiZmV0Y2giLCJqc29uIiwidG9IYXZlQmVlbkNhbGxlZFdpdGgiLCJtZXRob2QiLCJoZWFkZXJzIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJjaGFyZ2UiXSwic291cmNlcyI6WyJwYXltZW50c2NyZWVuLnN0ZXBzLnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QgZnJvbSBcInJlYWN0XCI7XHJcbmltcG9ydCB7IHJlbmRlciwgZmlyZUV2ZW50LCBzY3JlZW4sIHdhaXRGb3IgfSBmcm9tIFwiQHRlc3RpbmctbGlicmFyeS9yZWFjdFwiO1xyXG5pbXBvcnQgeyBNZW1vcnlSb3V0ZXIsIFJvdXRlLCBSb3V0ZXMgfSBmcm9tIFwicmVhY3Qtcm91dGVyLWRvbVwiO1xyXG5pbXBvcnQgUGF5bWVudFNjcmVlbiBmcm9tIFwiLi4vLi4vUGF5bWVudFNjcmVlblwiO1xyXG5pbXBvcnQgeyBjb25maWd1cmVTdG9yZSB9IGZyb20gXCJAcmVkdXhqcy90b29sa2l0XCI7XHJcbmltcG9ydCBwYXJraW5nU2xpY2UgZnJvbSBcIi4vLi4vLi4vcmVkdXgvcmVkdWNlci9wYXJraW5nU2xpY2VcIjtcclxuaW1wb3J0IHsgUHJvdmlkZXIgfSBmcm9tIFwicmVhY3QtcmVkdXhcIjtcclxuaW1wb3J0IFwiQHRlc3RpbmctbGlicmFyeS9qZXN0LWRvbS9leHRlbmQtZXhwZWN0XCI7XHJcbmltcG9ydCB7IGxvYWRGZWF0dXJlLCBkZWZpbmVGZWF0dXJlIH0gZnJvbSBcImplc3QtY3VjdW1iZXJcIjtcclxuXHJcbmNvbnN0IGZlYXR1cmUgPSBsb2FkRmVhdHVyZShcInNyYy9jb21wb25lbnRzL2ZlYXR1cmVzL3BheW1lbnRzY3JlZW4uZmVhdHVyZVwiKTtcclxuXHJcbmRlZmluZUZlYXR1cmUoZmVhdHVyZSwgKHRlc3QpID0+IHtcclxuICB0ZXN0KFwiVXNlciBwYXlzIGZvciBvY2N1cGllZCBwYXJraW5nIHNwb3RcIiwgKHsgZ2l2ZW4sIHdoZW4sIHRoZW4sIGFuZCB9KSA9PiB7XHJcbiAgICBjb25zdCBhbGVydE1vY2sgPSBqZXN0LnNweU9uKHdpbmRvdywgXCJhbGVydFwiKS5tb2NrSW1wbGVtZW50YXRpb24oKCkgPT4ge30pO1xyXG4gICAgY29uc3Qgc3RhdGUgPSB7XHJcbiAgICAgIHNwYWNlRGV0YWlsczoge1xyXG4gICAgICAgIHJlZ2lzdHJhdGlvbjogXCJBQkNcIixcclxuICAgICAgICBwYXJraW5nVGltZTogXCIxMDowMFwiLFxyXG4gICAgICB9LFxyXG4gICAgICBzcGFjZTogXCIxXCIsXHJcbiAgICB9O1xyXG4gICAgY29uc3Qgc3RvcmUgPSBjb25maWd1cmVTdG9yZSh7XHJcbiAgICAgIHJlZHVjZXI6IHtcclxuICAgICAgICBwYXJraW5nU3BhY2VzOiBwYXJraW5nU2xpY2UsXHJcbiAgICAgIH0sXHJcbiAgICB9KTtcclxuICAgIGNvbnN0IHNjcmVlbiA9IHJlbmRlcihcclxuICAgICAgPFByb3ZpZGVyIHN0b3JlPXtzdG9yZX0+XHJcbiAgICAgICAgPE1lbW9yeVJvdXRlciBpbml0aWFsRW50cmllcz17W3sgcGF0aG5hbWU6IFwiL3BheW1lbnRcIiwgc3RhdGUgfV19PlxyXG4gICAgICAgICAgPFJvdXRlcz5cclxuICAgICAgICAgICAgPFJvdXRlIHBhdGg9XCIvcGF5bWVudFwiIGVsZW1lbnQ9ezxQYXltZW50U2NyZWVuIC8+fSAvPlxyXG4gICAgICAgICAgPC9Sb3V0ZXM+XHJcbiAgICAgICAgPC9NZW1vcnlSb3V0ZXI+XHJcbiAgICAgIDwvUHJvdmlkZXI+XHJcbiAgICApO1xyXG4gICAgZ2l2ZW4oXCJJIGFtIG9uIHRoZSBQYXltZW50IFNjcmVlblwiLCAoKSA9PiB7XHJcbiAgICAgIGV4cGVjdChzY3JlZW4pLnRvQmVEZWZpbmVkKCk7XHJcbiAgICB9KTtcclxuICAgIGFuZChcclxuICAgICAgXCJJIHNlZSB0aGUgdmVoaWNsZSByZWdpc3RyYXRpb24gYW5kIGhvdXJzIHBhcmtlZCBmb3IgdGhlIG9jY3VwaWVkIHBhcmtpbmcgc3BvdFwiLFxyXG4gICAgICAoKSA9PiB7XHJcbiAgICAgICAgY29uc3QgcmVnRWxlbWVudCA9IHNjcmVlbi5nZXRCeVRlc3RJZChcInJlZ1wiKTtcclxuICAgICAgICBleHBlY3QocmVnRWxlbWVudCkudG9IYXZlVGV4dENvbnRlbnQoXCJWZWhpY2xlIFJlZ2lzdHJhdGlvbjogQUJDXCIpO1xyXG5cclxuICAgICAgICBjb25zdCBwYXJraW5nSG91cnNFbGVtZW50ID0gc2NyZWVuLmdldEJ5VGVzdElkKFwicGFya2luZ0hvdXJzXCIpO1xyXG4gICAgICAgIGV4cGVjdChwYXJraW5nSG91cnNFbGVtZW50KS50b0hhdmVUZXh0Q29udGVudChcIkhvdXJzIFBhcmtlZDogOVwiKTtcclxuICAgICAgfVxyXG4gICAgKTtcclxuICAgIGFuZChcIkkgc2VlIHRoZSBwYXJraW5nIGNoYXJnZSBmb3IgdGhlIG9jY3VwaWVkIHBhcmtpbmcgc3BvdFwiLCAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHBheW1lbnRFbGVtZW50ID0gc2NyZWVuLmdldEJ5VGVzdElkKFwicGF5bWVudFwiKTtcclxuICAgICAgZXhwZWN0KHBheW1lbnRFbGVtZW50KS50b0hhdmVUZXh0Q29udGVudChcIlBhcmtpbmcgQ2hhcmdlOiAkODBcIik7XHJcbiAgICB9KTtcclxuICAgIHdoZW4oXCJJIGNsaWNrIG9uIHRoZSBNYWtlIFBheW1lbnQgYnV0dG9uXCIsICgpID0+IHtcclxuICAgICAgY29uc3QgcGF5bWVudEJ1dHRvbiA9IHNjcmVlbi5nZXRCeVRlc3RJZChcInBheW1lbnRCdXR0b25cIik7XHJcbiAgICAgIGZpcmVFdmVudC5jbGljayhwYXltZW50QnV0dG9uKTtcclxuICAgIH0pO1xyXG4gICAgdGhlbihcclxuICAgICAgXCJJIHNlZSBhbiBhbGVydCBpbmRpY2F0aW5nIHRoYXQgdGhlIHBheW1lbnQgd2FzIHN1Y2Nlc3NmdWxcIixcclxuICAgICAgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IHBvc3RNb2NrID0gamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlT25jZSh7IG9rOiB0cnVlIH0pO1xyXG4gICAgICAgIGdsb2JhbC5mZXRjaCA9IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2Uoe1xyXG4gICAgICAgICAgb2s6IHRydWUsXHJcbiAgICAgICAgICBqc29uOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWVPbmNlKHt9KSxcclxuICAgICAgICB9KTtcclxuICAgICAgICBjb25zdCBwYXltZW50QnV0dG9uID0gc2NyZWVuLmdldEJ5VGVzdElkKFwicGF5bWVudEJ1dHRvblwiKTtcclxuICAgICAgICBmaXJlRXZlbnQuY2xpY2socGF5bWVudEJ1dHRvbik7XHJcbiAgICAgICAgZXhwZWN0KGZldGNoKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcImh0dHBzOi8vaHR0cHN0YXQudXMvMjAwXCIsIHtcclxuICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICAgICAgXCJjYXItcmVnaXN0cmF0aW9uXCI6IHN0YXRlLnNwYWNlRGV0YWlscy5yZWdpc3RyYXRpb24sXHJcbiAgICAgICAgICAgIGNoYXJnZTogMTAsXHJcbiAgICAgICAgICB9KSxcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgKTtcclxuICB9KTtcclxufSk7XHJcbiJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxJQUFBQSxNQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBQyxPQUFBLEdBQUFELE9BQUE7QUFDQSxJQUFBRSxlQUFBLEdBQUFGLE9BQUE7QUFDQSxJQUFBRyxjQUFBLEdBQUFKLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBSSxRQUFBLEdBQUFKLE9BQUE7QUFDQSxJQUFBSyxhQUFBLEdBQUFOLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBTSxXQUFBLEdBQUFOLE9BQUE7QUFDQUEsT0FBQTtBQUNBLElBQUFPLGFBQUEsR0FBQVAsT0FBQTtBQUEyRCxTQUFBRCx1QkFBQVMsR0FBQSxXQUFBQSxHQUFBLElBQUFBLEdBQUEsQ0FBQUMsVUFB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