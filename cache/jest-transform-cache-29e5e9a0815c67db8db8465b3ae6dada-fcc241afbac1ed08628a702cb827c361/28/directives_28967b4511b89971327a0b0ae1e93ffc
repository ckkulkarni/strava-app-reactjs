7ed6df66e6f70efe9c3ff6664faeda56
'use strict';

var Node = require('../nodes/Node.js');
var visit = require('../visit.js');
const escapeChars = {
  '!': '%21',
  ',': '%2C',
  '[': '%5B',
  ']': '%5D',
  '{': '%7B',
  '}': '%7D'
};
const escapeTagName = tn => tn.replace(/[!,[\]{}]/g, ch => escapeChars[ch]);
class Directives {
  constructor(yaml, tags) {
    /**
     * The directives-end/doc-start marker `---`. If `null`, a marker may still be
     * included in the document's stringified representation.
     */
    this.docStart = null;
    /** The doc-end marker `...`.  */
    this.docEnd = false;
    this.yaml = Object.assign({}, Directives.defaultYaml, yaml);
    this.tags = Object.assign({}, Directives.defaultTags, tags);
  }
  clone() {
    const copy = new Directives(this.yaml, this.tags);
    copy.docStart = this.docStart;
    return copy;
  }
  /**
   * During parsing, get a Directives instance for the current document and
   * update the stream state according to the current version's spec.
   */
  atDocument() {
    const res = new Directives(this.yaml, this.tags);
    switch (this.yaml.version) {
      case '1.1':
        this.atNextDocument = true;
        break;
      case '1.2':
        this.atNextDocument = false;
        this.yaml = {
          explicit: Directives.defaultYaml.explicit,
          version: '1.2'
        };
        this.tags = Object.assign({}, Directives.defaultTags);
        break;
    }
    return res;
  }
  /**
   * @param onError - May be called even if the action was successful
   * @returns `true` on success
   */
  add(line, onError) {
    if (this.atNextDocument) {
      this.yaml = {
        explicit: Directives.defaultYaml.explicit,
        version: '1.1'
      };
      this.tags = Object.assign({}, Directives.defaultTags);
      this.atNextDocument = false;
    }
    const parts = line.trim().split(/[ \t]+/);
    const name = parts.shift();
    switch (name) {
      case '%TAG':
        {
          if (parts.length !== 2) {
            onError(0, '%TAG directive should contain exactly two parts');
            if (parts.length < 2) return false;
          }
          const [handle, prefix] = parts;
          this.tags[handle] = prefix;
          return true;
        }
      case '%YAML':
        {
          this.yaml.explicit = true;
          if (parts.length !== 1) {
            onError(0, '%YAML directive should contain exactly one part');
            return false;
          }
          const [version] = parts;
          if (version === '1.1' || version === '1.2') {
            this.yaml.version = version;
            return true;
          } else {
            const isValid = /^\d+\.\d+$/.test(version);
            onError(6, `Unsupported YAML version ${version}`, isValid);
            return false;
          }
        }
      default:
        onError(0, `Unknown directive ${name}`, true);
        return false;
    }
  }
  /**
   * Resolves a tag, matching handles to those defined in %TAG directives.
   *
   * @returns Resolved tag, which may also be the non-specific tag `'!'` or a
   *   `'!local'` tag, or `null` if unresolvable.
   */
  tagName(source, onError) {
    if (source === '!') return '!'; // non-specific tag
    if (source[0] !== '!') {
      onError(`Not a valid tag: ${source}`);
      return null;
    }
    if (source[1] === '<') {
      const verbatim = source.slice(2, -1);
      if (verbatim === '!' || verbatim === '!!') {
        onError(`Verbatim tags aren't resolved, so ${source} is invalid.`);
        return null;
      }
      if (source[source.length - 1] !== '>') onError('Verbatim tags must end with a >');
      return verbatim;
    }
    const [, handle, suffix] = source.match(/^(.*!)([^!]*)$/);
    if (!suffix) onError(`The ${source} tag has no suffix`);
    const prefix = this.tags[handle];
    if (prefix) return prefix + decodeURIComponent(suffix);
    if (handle === '!') return source; // local tag
    onError(`Could not resolve tag: ${source}`);
    return null;
  }
  /**
   * Given a fully resolved tag, returns its printable string form,
   * taking into account current tag prefixes and defaults.
   */
  tagString(tag) {
    for (const [handle, prefix] of Object.entries(this.tags)) {
      if (tag.startsWith(prefix)) return handle + escapeTagName(tag.substring(prefix.length));
    }
    return tag[0] === '!' ? tag : `!<${tag}>`;
  }
  toString(doc) {
    const lines = this.yaml.explicit ? [`%YAML ${this.yaml.version || '1.2'}`] : [];
    const tagEntries = Object.entries(this.tags);
    let tagNames;
    if (doc && tagEntries.length > 0 && Node.isNode(doc.contents)) {
      const tags = {};
      visit.visit(doc.contents, (_key, node) => {
        if (Node.isNode(node) && node.tag) tags[node.tag] = true;
      });
      tagNames = Object.keys(tags);
    } else tagNames = [];
    for (const [handle, prefix] of tagEntries) {
      if (handle === '!!' && prefix === 'tag:yaml.org,2002:') continue;
      if (!doc || tagNames.some(tn => tn.startsWith(prefix))) lines.push(`%TAG ${handle} ${prefix}`);
    }
    return lines.join('\n');
  }
}
Directives.defaultYaml = {
  explicit: false,
  version: '1.2'
};
Directives.defaultTags = {
  '!!': 'tag:yaml.org,2002:'
};
exports.Directives = Directives;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJOb2RlIiwicmVxdWlyZSIsInZpc2l0IiwiZXNjYXBlQ2hhcnMiLCJlc2NhcGVUYWdOYW1lIiwidG4iLCJyZXBsYWNlIiwiY2giLCJEaXJlY3RpdmVzIiwiY29uc3RydWN0b3IiLCJ5YW1sIiwidGFncyIsImRvY1N0YXJ0IiwiZG9jRW5kIiwiT2JqZWN0IiwiYXNzaWduIiwiZGVmYXVsdFlhbWwiLCJkZWZhdWx0VGFncyIsImNsb25lIiwiY29weSIsImF0RG9jdW1lbnQiLCJyZXMiLCJ2ZXJzaW9uIiwiYXROZXh0RG9jdW1lbnQiLCJleHBsaWNpdCIsImFkZCIsImxpbmUiLCJvbkVycm9yIiwicGFydHMiLCJ0cmltIiwic3BsaXQiLCJuYW1lIiwic2hpZnQiLCJsZW5ndGgiLCJoYW5kbGUiLCJwcmVmaXgiLCJpc1ZhbGlkIiwidGVzdCIsInRhZ05hbWUiLCJzb3VyY2UiLCJ2ZXJiYXRpbSIsInNsaWNlIiwic3VmZml4IiwibWF0Y2giLCJkZWNvZGVVUklDb21wb25lbnQiLCJ0YWdTdHJpbmciLCJ0YWciLCJlbnRyaWVzIiwic3RhcnRzV2l0aCIsInN1YnN0cmluZyIsInRvU3RyaW5nIiwiZG9jIiwibGluZXMiLCJ0YWdFbnRyaWVzIiwidGFnTmFtZXMiLCJpc05vZGUiLCJjb250ZW50cyIsIl9rZXkiLCJub2RlIiwia2V5cyIsInNvbWUiLCJwdXNoIiwiam9pbiIsImV4cG9ydHMiXSwic291cmNlcyI6WyJkaXJlY3RpdmVzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxudmFyIE5vZGUgPSByZXF1aXJlKCcuLi9ub2Rlcy9Ob2RlLmpzJyk7XG52YXIgdmlzaXQgPSByZXF1aXJlKCcuLi92aXNpdC5qcycpO1xuXG5jb25zdCBlc2NhcGVDaGFycyA9IHtcbiAgICAnISc6ICclMjEnLFxuICAgICcsJzogJyUyQycsXG4gICAgJ1snOiAnJTVCJyxcbiAgICAnXSc6ICclNUQnLFxuICAgICd7JzogJyU3QicsXG4gICAgJ30nOiAnJTdEJ1xufTtcbmNvbnN0IGVzY2FwZVRhZ05hbWUgPSAodG4pID0+IHRuLnJlcGxhY2UoL1shLFtcXF17fV0vZywgY2ggPT4gZXNjYXBlQ2hhcnNbY2hdKTtcbmNsYXNzIERpcmVjdGl2ZXMge1xuICAgIGNvbnN0cnVjdG9yKHlhbWwsIHRhZ3MpIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBkaXJlY3RpdmVzLWVuZC9kb2Mtc3RhcnQgbWFya2VyIGAtLS1gLiBJZiBgbnVsbGAsIGEgbWFya2VyIG1heSBzdGlsbCBiZVxuICAgICAgICAgKiBpbmNsdWRlZCBpbiB0aGUgZG9jdW1lbnQncyBzdHJpbmdpZmllZCByZXByZXNlbnRhdGlvbi5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZG9jU3RhcnQgPSBudWxsO1xuICAgICAgICAvKiogVGhlIGRvYy1lbmQgbWFya2VyIGAuLi5gLiAgKi9cbiAgICAgICAgdGhpcy5kb2NFbmQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy55YW1sID0gT2JqZWN0LmFzc2lnbih7fSwgRGlyZWN0aXZlcy5kZWZhdWx0WWFtbCwgeWFtbCk7XG4gICAgICAgIHRoaXMudGFncyA9IE9iamVjdC5hc3NpZ24oe30sIERpcmVjdGl2ZXMuZGVmYXVsdFRhZ3MsIHRhZ3MpO1xuICAgIH1cbiAgICBjbG9uZSgpIHtcbiAgICAgICAgY29uc3QgY29weSA9IG5ldyBEaXJlY3RpdmVzKHRoaXMueWFtbCwgdGhpcy50YWdzKTtcbiAgICAgICAgY29weS5kb2NTdGFydCA9IHRoaXMuZG9jU3RhcnQ7XG4gICAgICAgIHJldHVybiBjb3B5O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBEdXJpbmcgcGFyc2luZywgZ2V0IGEgRGlyZWN0aXZlcyBpbnN0YW5jZSBmb3IgdGhlIGN1cnJlbnQgZG9jdW1lbnQgYW5kXG4gICAgICogdXBkYXRlIHRoZSBzdHJlYW0gc3RhdGUgYWNjb3JkaW5nIHRvIHRoZSBjdXJyZW50IHZlcnNpb24ncyBzcGVjLlxuICAgICAqL1xuICAgIGF0RG9jdW1lbnQoKSB7XG4gICAgICAgIGNvbnN0IHJlcyA9IG5ldyBEaXJlY3RpdmVzKHRoaXMueWFtbCwgdGhpcy50YWdzKTtcbiAgICAgICAgc3dpdGNoICh0aGlzLnlhbWwudmVyc2lvbikge1xuICAgICAgICAgICAgY2FzZSAnMS4xJzpcbiAgICAgICAgICAgICAgICB0aGlzLmF0TmV4dERvY3VtZW50ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJzEuMic6XG4gICAgICAgICAgICAgICAgdGhpcy5hdE5leHREb2N1bWVudCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHRoaXMueWFtbCA9IHtcbiAgICAgICAgICAgICAgICAgICAgZXhwbGljaXQ6IERpcmVjdGl2ZXMuZGVmYXVsdFlhbWwuZXhwbGljaXQsXG4gICAgICAgICAgICAgICAgICAgIHZlcnNpb246ICcxLjInXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB0aGlzLnRhZ3MgPSBPYmplY3QuYXNzaWduKHt9LCBEaXJlY3RpdmVzLmRlZmF1bHRUYWdzKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAcGFyYW0gb25FcnJvciAtIE1heSBiZSBjYWxsZWQgZXZlbiBpZiB0aGUgYWN0aW9uIHdhcyBzdWNjZXNzZnVsXG4gICAgICogQHJldHVybnMgYHRydWVgIG9uIHN1Y2Nlc3NcbiAgICAgKi9cbiAgICBhZGQobGluZSwgb25FcnJvcikge1xuICAgICAgICBpZiAodGhpcy5hdE5leHREb2N1bWVudCkge1xuICAgICAgICAgICAgdGhpcy55YW1sID0geyBleHBsaWNpdDogRGlyZWN0aXZlcy5kZWZhdWx0WWFtbC5leHBsaWNpdCwgdmVyc2lvbjogJzEuMScgfTtcbiAgICAgICAgICAgIHRoaXMudGFncyA9IE9iamVjdC5hc3NpZ24oe30sIERpcmVjdGl2ZXMuZGVmYXVsdFRhZ3MpO1xuICAgICAgICAgICAgdGhpcy5hdE5leHREb2N1bWVudCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHBhcnRzID0gbGluZS50cmltKCkuc3BsaXQoL1sgXFx0XSsvKTtcbiAgICAgICAgY29uc3QgbmFtZSA9IHBhcnRzLnNoaWZ0KCk7XG4gICAgICAgIHN3aXRjaCAobmFtZSkge1xuICAgICAgICAgICAgY2FzZSAnJVRBRyc6IHtcbiAgICAgICAgICAgICAgICBpZiAocGFydHMubGVuZ3RoICE9PSAyKSB7XG4gICAgICAgICAgICAgICAgICAgIG9uRXJyb3IoMCwgJyVUQUcgZGlyZWN0aXZlIHNob3VsZCBjb250YWluIGV4YWN0bHkgdHdvIHBhcnRzJyk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwYXJ0cy5sZW5ndGggPCAyKVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zdCBbaGFuZGxlLCBwcmVmaXhdID0gcGFydHM7XG4gICAgICAgICAgICAgICAgdGhpcy50YWdzW2hhbmRsZV0gPSBwcmVmaXg7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXNlICclWUFNTCc6IHtcbiAgICAgICAgICAgICAgICB0aGlzLnlhbWwuZXhwbGljaXQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGlmIChwYXJ0cy5sZW5ndGggIT09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgb25FcnJvcigwLCAnJVlBTUwgZGlyZWN0aXZlIHNob3VsZCBjb250YWluIGV4YWN0bHkgb25lIHBhcnQnKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zdCBbdmVyc2lvbl0gPSBwYXJ0cztcbiAgICAgICAgICAgICAgICBpZiAodmVyc2lvbiA9PT0gJzEuMScgfHwgdmVyc2lvbiA9PT0gJzEuMicpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy55YW1sLnZlcnNpb24gPSB2ZXJzaW9uO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGlzVmFsaWQgPSAvXlxcZCtcXC5cXGQrJC8udGVzdCh2ZXJzaW9uKTtcbiAgICAgICAgICAgICAgICAgICAgb25FcnJvcig2LCBgVW5zdXBwb3J0ZWQgWUFNTCB2ZXJzaW9uICR7dmVyc2lvbn1gLCBpc1ZhbGlkKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgb25FcnJvcigwLCBgVW5rbm93biBkaXJlY3RpdmUgJHtuYW1lfWAsIHRydWUpO1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXNvbHZlcyBhIHRhZywgbWF0Y2hpbmcgaGFuZGxlcyB0byB0aG9zZSBkZWZpbmVkIGluICVUQUcgZGlyZWN0aXZlcy5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIFJlc29sdmVkIHRhZywgd2hpY2ggbWF5IGFsc28gYmUgdGhlIG5vbi1zcGVjaWZpYyB0YWcgYCchJ2Agb3IgYVxuICAgICAqICAgYCchbG9jYWwnYCB0YWcsIG9yIGBudWxsYCBpZiB1bnJlc29sdmFibGUuXG4gICAgICovXG4gICAgdGFnTmFtZShzb3VyY2UsIG9uRXJyb3IpIHtcbiAgICAgICAgaWYgKHNvdXJjZSA9PT0gJyEnKVxuICAgICAgICAgICAgcmV0dXJuICchJzsgLy8gbm9uLXNwZWNpZmljIHRhZ1xuICAgICAgICBpZiAoc291cmNlWzBdICE9PSAnIScpIHtcbiAgICAgICAgICAgIG9uRXJyb3IoYE5vdCBhIHZhbGlkIHRhZzogJHtzb3VyY2V9YCk7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc291cmNlWzFdID09PSAnPCcpIHtcbiAgICAgICAgICAgIGNvbnN0IHZlcmJhdGltID0gc291cmNlLnNsaWNlKDIsIC0xKTtcbiAgICAgICAgICAgIGlmICh2ZXJiYXRpbSA9PT0gJyEnIHx8IHZlcmJhdGltID09PSAnISEnKSB7XG4gICAgICAgICAgICAgICAgb25FcnJvcihgVmVyYmF0aW0gdGFncyBhcmVuJ3QgcmVzb2x2ZWQsIHNvICR7c291cmNlfSBpcyBpbnZhbGlkLmApO1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHNvdXJjZVtzb3VyY2UubGVuZ3RoIC0gMV0gIT09ICc+JylcbiAgICAgICAgICAgICAgICBvbkVycm9yKCdWZXJiYXRpbSB0YWdzIG11c3QgZW5kIHdpdGggYSA+Jyk7XG4gICAgICAgICAgICByZXR1cm4gdmVyYmF0aW07XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgWywgaGFuZGxlLCBzdWZmaXhdID0gc291cmNlLm1hdGNoKC9eKC4qISkoW14hXSopJC8pO1xuICAgICAgICBpZiAoIXN1ZmZpeClcbiAgICAgICAgICAgIG9uRXJyb3IoYFRoZSAke3NvdXJjZX0gdGFnIGhhcyBubyBzdWZmaXhgKTtcbiAgICAgICAgY29uc3QgcHJlZml4ID0gdGhpcy50YWdzW2hhbmRsZV07XG4gICAgICAgIGlmIChwcmVmaXgpXG4gICAgICAgICAgICByZXR1cm4gcHJlZml4ICsgZGVjb2RlVVJJQ29tcG9uZW50KHN1ZmZpeCk7XG4gICAgICAgIGlmIChoYW5kbGUgPT09ICchJylcbiAgICAgICAgICAgIHJldHVybiBzb3VyY2U7IC8vIGxvY2FsIHRhZ1xuICAgICAgICBvbkVycm9yKGBDb3VsZCBub3QgcmVzb2x2ZSB0YWc6ICR7c291cmNlfWApO1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2l2ZW4gYSBmdWxseSByZXNvbHZlZCB0YWcsIHJldHVybnMgaXRzIHByaW50YWJsZSBzdHJpbmcgZm9ybSxcbiAgICAgKiB0YWtpbmcgaW50byBhY2NvdW50IGN1cnJlbnQgdGFnIHByZWZpeGVzIGFuZCBkZWZhdWx0cy5cbiAgICAgKi9cbiAgICB0YWdTdHJpbmcodGFnKSB7XG4gICAgICAgIGZvciAoY29uc3QgW2hhbmRsZSwgcHJlZml4XSBvZiBPYmplY3QuZW50cmllcyh0aGlzLnRhZ3MpKSB7XG4gICAgICAgICAgICBpZiAodGFnLnN0YXJ0c1dpdGgocHJlZml4KSlcbiAgICAgICAgICAgICAgICByZXR1cm4gaGFuZGxlICsgZXNjYXBlVGFnTmFtZSh0YWcuc3Vic3RyaW5nKHByZWZpeC5sZW5ndGgpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGFnWzBdID09PSAnIScgPyB0YWcgOiBgITwke3RhZ30+YDtcbiAgICB9XG4gICAgdG9TdHJpbmcoZG9jKSB7XG4gICAgICAgIGNvbnN0IGxpbmVzID0gdGhpcy55YW1sLmV4cGxpY2l0XG4gICAgICAgICAgICA/IFtgJVlBTUwgJHt0aGlzLnlhbWwudmVyc2lvbiB8fCAnMS4yJ31gXVxuICAgICAgICAgICAgOiBbXTtcbiAgICAgICAgY29uc3QgdGFnRW50cmllcyA9IE9iamVjdC5lbnRyaWVzKHRoaXMudGFncyk7XG4gICAgICAgIGxldCB0YWdOYW1lcztcbiAgICAgICAgaWYgKGRvYyAmJiB0YWdFbnRyaWVzLmxlbmd0aCA+IDAgJiYgTm9kZS5pc05vZGUoZG9jLmNvbnRlbnRzKSkge1xuICAgICAgICAgICAgY29uc3QgdGFncyA9IHt9O1xuICAgICAgICAgICAgdmlzaXQudmlzaXQoZG9jLmNvbnRlbnRzLCAoX2tleSwgbm9kZSkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChOb2RlLmlzTm9kZShub2RlKSAmJiBub2RlLnRhZylcbiAgICAgICAgICAgICAgICAgICAgdGFnc1tub2RlLnRhZ10gPSB0cnVlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0YWdOYW1lcyA9IE9iamVjdC5rZXlzKHRhZ3MpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIHRhZ05hbWVzID0gW107XG4gICAgICAgIGZvciAoY29uc3QgW2hhbmRsZSwgcHJlZml4XSBvZiB0YWdFbnRyaWVzKSB7XG4gICAgICAgICAgICBpZiAoaGFuZGxlID09PSAnISEnICYmIHByZWZpeCA9PT0gJ3RhZzp5YW1sLm9yZywyMDAyOicpXG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICBpZiAoIWRvYyB8fCB0YWdOYW1lcy5zb21lKHRuID0+IHRuLnN0YXJ0c1dpdGgocHJlZml4KSkpXG4gICAgICAgICAgICAgICAgbGluZXMucHVzaChgJVRBRyAke2hhbmRsZX0gJHtwcmVmaXh9YCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGxpbmVzLmpvaW4oJ1xcbicpO1xuICAgIH1cbn1cbkRpcmVjdGl2ZXMuZGVmYXVsdFlhbWwgPSB7IGV4cGxpY2l0OiBmYWxzZSwgdmVyc2lvbjogJzEuMicgfTtcbkRpcmVjdGl2ZXMuZGVmYXVsdFRhZ3MgPSB7ICchISc6ICd0YWc6eWFtbC5vcmcsMjAwMjonIH07XG5cbmV4cG9ydHMuRGlyZWN0aXZlcyA9IERpcmVjdGl2ZXM7XG4iXSwibWFwcGluZ3MiOiJBQUFBLFlBQVk7O0FBRVosSUFBSUEsSUFBSSxHQUFHQyxPQUFPLENBQUMsa0JBQWtCLENBQUM7QUFDdEMsSUFBSUMsS0FBSyxHQUFHRCxPQUFPLENBQUMsYUFBYSxDQUFDO0FBRWxDLE1BQU1FLFdBQVcsR0FBRztFQUNoQixHQUFHLEVBQUUsS0FBSztFQUNWLEdBQUcsRUFBRSxLQUFLO0VBQ1YsR0FBRyxFQUFFLEtBQUs7RUFDVixHQUFHLEVBQUUsS0FBSztFQUNWLEdBQUcsRUFBRSxLQUFLO0VBQ1YsR0FBRyxFQUFFO0FBQ1QsQ0FBQztBQUNELE1BQU1DLGFBQWEsR0FBSUMs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