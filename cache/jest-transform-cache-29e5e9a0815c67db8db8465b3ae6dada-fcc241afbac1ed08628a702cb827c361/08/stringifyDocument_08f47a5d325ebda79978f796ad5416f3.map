{"version":3,"names":["Node","require","stringify","stringifyComment","stringifyDocument","doc","options","lines","hasDirectives","directives","dir","toString","push","docStart","ctx","createStringifyContext","commentString","commentBefore","length","unshift","cs","indentComment","chompKeep","contentComment","contents","isNode","spaceBefore","forceBlockIndent","comment","onChompKeep","undefined","body","lineComment","docEnd","includes","dc","replace","join","exports"],"sources":["stringifyDocument.js"],"sourcesContent":["'use strict';\n\nvar Node = require('../nodes/Node.js');\nvar stringify = require('./stringify.js');\nvar stringifyComment = require('./stringifyComment.js');\n\nfunction stringifyDocument(doc, options) {\n    const lines = [];\n    let hasDirectives = options.directives === true;\n    if (options.directives !== false && doc.directives) {\n        const dir = doc.directives.toString(doc);\n        if (dir) {\n            lines.push(dir);\n            hasDirectives = true;\n        }\n        else if (doc.directives.docStart)\n            hasDirectives = true;\n    }\n    if (hasDirectives)\n        lines.push('---');\n    const ctx = stringify.createStringifyContext(doc, options);\n    const { commentString } = ctx.options;\n    if (doc.commentBefore) {\n        if (lines.length !== 1)\n            lines.unshift('');\n        const cs = commentString(doc.commentBefore);\n        lines.unshift(stringifyComment.indentComment(cs, ''));\n    }\n    let chompKeep = false;\n    let contentComment = null;\n    if (doc.contents) {\n        if (Node.isNode(doc.contents)) {\n            if (doc.contents.spaceBefore && hasDirectives)\n                lines.push('');\n            if (doc.contents.commentBefore) {\n                const cs = commentString(doc.contents.commentBefore);\n                lines.push(stringifyComment.indentComment(cs, ''));\n            }\n            // top-level block scalars need to be indented if followed by a comment\n            ctx.forceBlockIndent = !!doc.comment;\n            contentComment = doc.contents.comment;\n        }\n        const onChompKeep = contentComment ? undefined : () => (chompKeep = true);\n        let body = stringify.stringify(doc.contents, ctx, () => (contentComment = null), onChompKeep);\n        if (contentComment)\n            body += stringifyComment.lineComment(body, '', commentString(contentComment));\n        if ((body[0] === '|' || body[0] === '>') &&\n            lines[lines.length - 1] === '---') {\n            // Top-level block scalars with a preceding doc marker ought to use the\n            // same line for their header.\n            lines[lines.length - 1] = `--- ${body}`;\n        }\n        else\n            lines.push(body);\n    }\n    else {\n        lines.push(stringify.stringify(doc.contents, ctx));\n    }\n    if (doc.directives?.docEnd) {\n        if (doc.comment) {\n            const cs = commentString(doc.comment);\n            if (cs.includes('\\n')) {\n                lines.push('...');\n                lines.push(stringifyComment.indentComment(cs, ''));\n            }\n            else {\n                lines.push(`... ${cs}`);\n            }\n        }\n        else {\n            lines.push('...');\n        }\n    }\n    else {\n        let dc = doc.comment;\n        if (dc && chompKeep)\n            dc = dc.replace(/^\\n+/, '');\n        if (dc) {\n            if ((!chompKeep || contentComment) && lines[lines.length - 1] !== '')\n                lines.push('');\n            lines.push(stringifyComment.indentComment(commentString(dc), ''));\n        }\n    }\n    return lines.join('\\n') + '\\n';\n}\n\nexports.stringifyDocument = stringifyDocument;\n"],"mappings":"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"}