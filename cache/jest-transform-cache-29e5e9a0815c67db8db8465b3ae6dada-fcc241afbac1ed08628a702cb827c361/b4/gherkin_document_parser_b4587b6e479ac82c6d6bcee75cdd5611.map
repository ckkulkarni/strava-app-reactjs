{"version":3,"names":["value_checker_1","require","getGherkinStepMap","gherkinDocument","result","feature","children","map","extractStepContainers","flat","forEach","x","steps","step","id","exports","child","doesHaveValue","background","rule","ruleChild","scenario","getGherkinScenarioMap","getGherkinExampleRuleMap","filter","getGherkinScenarioLocationMap","locationMap","scenarioMap","Object","keys","location","examples","tableBody","tableRow"],"sources":["../../../src/formatter/helpers/gherkin_document_parser.ts"],"sourcesContent":["import * as messages from '@cucumber/messages'\nimport { doesHaveValue } from '../../value_checker'\n\nexport function getGherkinStepMap(\n  gherkinDocument: messages.GherkinDocument\n): Record<string, messages.Step> {\n  const result: Record<string, messages.Step> = {}\n  gherkinDocument.feature.children\n    .map(extractStepContainers)\n    .flat()\n    .forEach((x) =>\n      x.steps.forEach((step: messages.Step) => (result[step.id] = step))\n    )\n  return result\n}\n\nfunction extractStepContainers(\n  child: messages.FeatureChild\n): Array<messages.Scenario | messages.Background> {\n  if (doesHaveValue(child.background)) {\n    return [child.background]\n  } else if (doesHaveValue(child.rule)) {\n    return child.rule.children.map((ruleChild) =>\n      doesHaveValue(ruleChild.background)\n        ? ruleChild.background\n        : ruleChild.scenario\n    )\n  }\n  return [child.scenario]\n}\n\nexport function getGherkinScenarioMap(\n  gherkinDocument: messages.GherkinDocument\n): Record<string, messages.Scenario> {\n  const result: Record<string, messages.Scenario> = {}\n  gherkinDocument.feature.children\n    .map((child: messages.FeatureChild) => {\n      if (doesHaveValue(child.rule)) {\n        return child.rule.children\n      }\n      return [child]\n    })\n    .flat()\n    .forEach((x) => {\n      if (x.scenario != null) {\n        result[x.scenario.id] = x.scenario\n      }\n    })\n  return result\n}\n\nexport function getGherkinExampleRuleMap(\n  gherkinDocument: messages.GherkinDocument\n): Record<string, messages.Rule> {\n  const result: Record<string, messages.Rule> = {}\n  gherkinDocument.feature.children\n    .filter((x) => x.rule != null)\n    .forEach((x) =>\n      x.rule.children\n        .filter((child) => doesHaveValue(child.scenario))\n        .forEach((child) => (result[child.scenario.id] = x.rule))\n    )\n  return result\n}\n\nexport function getGherkinScenarioLocationMap(\n  gherkinDocument: messages.GherkinDocument\n): Record<string, messages.Location> {\n  const locationMap: Record<string, messages.Location> = {}\n  const scenarioMap: Record<string, messages.Scenario> =\n    getGherkinScenarioMap(gherkinDocument)\n  Object.keys(scenarioMap).forEach((id) => {\n    const scenario = scenarioMap[id]\n    locationMap[id] = scenario.location\n    if (doesHaveValue(scenario.examples)) {\n      scenario.examples.forEach((x) =>\n        x.tableBody.forEach(\n          (tableRow) => (locationMap[tableRow.id] = tableRow.location)\n        )\n      )\n    }\n  })\n  return locationMap\n}\n"],"mappings":"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"}