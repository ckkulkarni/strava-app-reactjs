{"version":3,"names":["location_helpers_1","require","cli_table3_1","__importDefault","indent_string_1","pickle_filter_1","messages","__importStar","getAmbiguousStepException","stepDefinitions","table","default","chars","bottom","left","mid","middle","right","top","style","border","push","map","stepDefinition","pattern","toString","formatLocation","exports","retriesForPickle","pickle","options","retry","retries","retryTagFilter","pickleTagFilter","PickleTagFilter","matchesAllTagExpressions","shouldCauseFailure","status","dryRun","failureStatuses","TestStepResultStatus","AMBIGUOUS","FAILED","UNDEFINED","strict","PENDING","includes"],"sources":["../../src/runtime/helpers.ts"],"sourcesContent":["import { formatLocation } from '../formatter/helpers/location_helpers'\nimport Table from 'cli-table3'\nimport indentString from 'indent-string'\nimport { PickleTagFilter } from '../pickle_filter'\nimport StepDefinition from '../models/step_definition'\nimport * as messages from '@cucumber/messages'\nimport { IRuntimeOptions } from '.'\n\nexport function getAmbiguousStepException(\n  stepDefinitions: StepDefinition[]\n): string {\n  const table = new Table({\n    chars: {\n      bottom: '',\n      'bottom-left': '',\n      'bottom-mid': '',\n      'bottom-right': '',\n      left: '',\n      'left-mid': '',\n      mid: '',\n      'mid-mid': '',\n      middle: ' - ',\n      right: '',\n      'right-mid': '',\n      top: '',\n      'top-left': '',\n      'top-mid': '',\n      'top-right': '',\n    },\n    style: {\n      border: [],\n      'padding-left': 0,\n      'padding-right': 0,\n    },\n  })\n  table.push(\n    ...stepDefinitions.map((stepDefinition) => {\n      const pattern = stepDefinition.pattern.toString()\n      return [pattern, formatLocation(stepDefinition)]\n    })\n  )\n  return `${'Multiple step definitions match:' + '\\n'}${indentString(\n    table.toString(),\n    2\n  )}`\n}\n\nexport function retriesForPickle(\n  pickle: messages.Pickle,\n  options: IRuntimeOptions\n): number {\n  if (!options.retry) {\n    return 0\n  }\n  const retries = options.retry\n  if (retries === 0) {\n    return 0\n  }\n  const retryTagFilter = options.retryTagFilter\n  if (!retryTagFilter) {\n    return retries\n  }\n  const pickleTagFilter = new PickleTagFilter(retryTagFilter)\n  if (pickleTagFilter.matchesAllTagExpressions(pickle)) {\n    return retries\n  }\n  return 0\n}\n\nexport function shouldCauseFailure(\n  status: messages.TestStepResultStatus,\n  options: IRuntimeOptions\n): boolean {\n  if (options.dryRun) {\n    return false\n  }\n  const failureStatuses: messages.TestStepResultStatus[] = [\n    messages.TestStepResultStatus.AMBIGUOUS,\n    messages.TestStepResultStatus.FAILED,\n    messages.TestStepResultStatus.UNDEFINED,\n  ]\n  if (options.strict) {\n    failureStatuses.push(messages.TestStepResultStatus.PENDING)\n  }\n  return failureStatuses.includes(status)\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,MAAAA,kBAAA,GAAAC,OAAA;AACA,MAAAC,YAAA,GAAAC,eAAA,CAAAF,OAAA;AACA,MAAAG,eAAA,GAAAD,eAAA,CAAAF,OAAA;AACA,MAAAI,eAAA,GAAAJ,OAAA;AAEA,MAAAK,QAAA,GAAAC,YAAA,CAAAN,OAAA;AAGA,SAAgBO,yBAAyBA,CACvCC,eAAiC;EAEjC,MAAMC,KAAK,GAAG,IAAIR,YAAA,CAAAS,OAAK,CAAC;IACtBC,KAAK,EAAE;MACLC,MAAM,EAAE,EAAE;MACV,aAAa,EAAE,EAAE;MACjB,YAAY,EAAE,EAAE;MAChB,cAAc,EAAE,EAAE;MAClBC,IAAI,EAAE,EAAE;MACR,UAAU,EAAE,EAAE;MACdC,GAAG,EAAE,EAAE;MACP,SAAS,EAAE,EAAE;MACbC,MAAM,EAAE,KAAK;MACbC,KAAK,EAAE,EAAE;MACT,WAAW,EAAE,EAAE;MACfC,GAAG,EAAE,EAAE;MACP,UAAU,EAAE,EAAE;MACd,SAAS,EAAE,EAAE;MACb,WAAW,EAAE;KACd;IACDC,KAAK,EAAE;MACLC,MAAM,EAAE,EAAE;MACV,cAAc,EAAE,CAAC;MACjB,eAAe,EAAE;;GAEpB,CAAC;EACFV,KAAK,CAACW,IAAI,CACR,GAAGZ,eAAe,CAACa,GAAG,CAAEC,cAAc,IAAI;IACxC,MAAMC,OAAO,GAAGD,cAAc,CAACC,OAAO,CAACC,QAAQ,EAAE;IACjD,OAAO,CAACD,OAAO,EAAE,IAAAxB,kBAAA,CAAA0B,cAAc,EAACH,cAAc,CAAC,CAAC;EAClD,CAAC,CAAC,CACH;EACD,OAAO,GAAG,kCAAkC,GAAG,IAAI,GAAG,IAAAnB,eAAA,CAAAO,OAAY,EAChED,KAAK,CAACe,QAAQ,EAAE,EAChB,CAAC,CACF,EAAE;AACL;AArCAE,OAAA,CAAAnB,yBAAA,GAAAA,yBAAA;AAuCA,SAAgBoB,gBAAgBA,CAC9BC,MAAuB,EACvBC,OAAwB;EAExB,IAAI,CAACA,OAAO,CAACC,KAAK,EAAE;IAClB,OAAO,CAAC;;EAEV,MAAMC,OAAO,GAAGF,OAAO,CAACC,KAAK;EAC7B,IAAIC,OAAO,KAAK,CAAC,EAAE;IACjB,OAAO,CAAC;;EAEV,MAAMC,cAAc,GAAGH,OAAO,CAACG,cAAc;EAC7C,IAAI,CAACA,cAAc,EAAE;IACnB,OAAOD,OAAO;;EAEhB,MAAME,eAAe,GAAG,IAAI7B,eAAA,CAAA8B,eAAe,CAACF,cAAc,CAAC;EAC3D,IAAIC,eAAe,CAACE,wBAAwB,CAACP,MAAM,CAAC,EAAE;IACpD,OAAOG,OAAO;;EAEhB,OAAO,CAAC;AACV;AApBAL,OAAA,CAAAC,gBAAA,GAAAA,gBAAA;AAsBA,SAAgBS,kBAAkBA,CAChCC,MAAqC,EACrCR,OAAwB;EAExB,IAAIA,OAAO,CAACS,MAAM,EAAE;IAClB,OAAO,KAAK;;EAEd,MAAMC,eAAe,GAAoC,CACvDlC,QAAQ,CAACmC,oBAAoB,CAACC,SAAS,EACvCpC,QAAQ,CAACmC,oBAAoB,CAACE,MAAM,EACpCrC,QAAQ,CAACmC,oBAAoB,CAACG,SAAS,CACxC;EACD,IAAId,OAAO,CAACe,MAAM,EAAE;IAClBL,eAAe,CAACnB,IAAI,CAACf,QAAQ,CAACmC,oBAAoB,CAACK,OAAO,CAAC;;EAE7D,OAAON,eAAe,CAACO,QAAQ,CAACT,MAAM,CAAC;AACzC;AAhBAX,OAAA,CAAAU,kBAAA,GAAAA,kBAAA"}