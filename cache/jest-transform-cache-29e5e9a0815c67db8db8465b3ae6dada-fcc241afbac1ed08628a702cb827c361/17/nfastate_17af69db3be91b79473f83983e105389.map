{"version":3,"names":["_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","Constructor","protoProps","staticProps","prototype","_classCallCheck","instance","TypeError","_possibleConstructorReturn","self","call","ReferenceError","_inherits","subClass","superClass","create","constructor","value","setPrototypeOf","__proto__","State","require","_require","EPSILON","NFAState","_State","getPrototypeOf","apply","arguments","matches","string","visited","undefined","Set","has","add","accepting","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_iterator","getTransitionsOnSymbol","Symbol","iterator","_step","next","done","nextState","err","return","symbol","rest","slice","symbolTransitions","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_iterator2","_step2","_nextState","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_iterator3","_step3","_nextState2","getEpsilonClosure","_this2","_epsilonClosure","epsilonTransitions","closure","_iteratorNormalCompletion4","_didIteratorError4","_iteratorError4","_iterator4","_step4","nextClosure","forEach","state","module","exports"],"sources":["nfa-state.js"],"sourcesContent":["/**\n * The MIT License (MIT)\n * Copyright (c) 2017-present Dmitry Soshnikov <dmitry.soshnikov@gmail.com>\n */\n\n'use strict';\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar State = require('../state');\n\nvar _require = require('../special-symbols'),\n    EPSILON = _require.EPSILON;\n\n/**\n * NFA state.\n *\n * Allows nondeterministic transitions to several states on the\n * same symbol, and also epsilon-transitions.\n */\n\n\nvar NFAState = function (_State) {\n  _inherits(NFAState, _State);\n\n  function NFAState() {\n    _classCallCheck(this, NFAState);\n\n    return _possibleConstructorReturn(this, (NFAState.__proto__ || Object.getPrototypeOf(NFAState)).apply(this, arguments));\n  }\n\n  _createClass(NFAState, [{\n    key: 'matches',\n\n\n    /**\n     * Whether this state matches a string.\n     *\n     * We maintain set of visited epsilon-states to avoid infinite loops\n     * when an epsilon-transition goes eventually to itself.\n     *\n     * NOTE: this function is rather \"educational\", since we use DFA for strings\n     * matching. DFA is built on top of NFA, and uses fast transition table.\n     */\n    value: function matches(string) {\n      var visited = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : new Set();\n\n      // An epsilon-state has been visited, stop to avoid infinite loop.\n      if (visited.has(this)) {\n        return false;\n      }\n\n      visited.add(this);\n\n      // No symbols left..\n      if (string.length === 0) {\n        // .. and we're in the accepting state.\n        if (this.accepting) {\n          return true;\n        }\n\n        // Check if we can reach any accepting state from\n        // on the epsilon transitions.\n        var _iteratorNormalCompletion = true;\n        var _didIteratorError = false;\n        var _iteratorError = undefined;\n\n        try {\n          for (var _iterator = this.getTransitionsOnSymbol(EPSILON)[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n            var nextState = _step.value;\n\n            if (nextState.matches('', visited)) {\n              return true;\n            }\n          }\n        } catch (err) {\n          _didIteratorError = true;\n          _iteratorError = err;\n        } finally {\n          try {\n            if (!_iteratorNormalCompletion && _iterator.return) {\n              _iterator.return();\n            }\n          } finally {\n            if (_didIteratorError) {\n              throw _iteratorError;\n            }\n          }\n        }\n\n        return false;\n      }\n\n      // Else, we get some symbols.\n      var symbol = string[0];\n      var rest = string.slice(1);\n\n      var symbolTransitions = this.getTransitionsOnSymbol(symbol);\n      var _iteratorNormalCompletion2 = true;\n      var _didIteratorError2 = false;\n      var _iteratorError2 = undefined;\n\n      try {\n        for (var _iterator2 = symbolTransitions[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n          var _nextState = _step2.value;\n\n          if (_nextState.matches(rest)) {\n            return true;\n          }\n        }\n\n        // If we couldn't match on symbol, check still epsilon-transitions\n        // without consuming the symbol (i.e. continue from `string`, not `rest`).\n      } catch (err) {\n        _didIteratorError2 = true;\n        _iteratorError2 = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion2 && _iterator2.return) {\n            _iterator2.return();\n          }\n        } finally {\n          if (_didIteratorError2) {\n            throw _iteratorError2;\n          }\n        }\n      }\n\n      var _iteratorNormalCompletion3 = true;\n      var _didIteratorError3 = false;\n      var _iteratorError3 = undefined;\n\n      try {\n        for (var _iterator3 = this.getTransitionsOnSymbol(EPSILON)[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n          var _nextState2 = _step3.value;\n\n          if (_nextState2.matches(string, visited)) {\n            return true;\n          }\n        }\n      } catch (err) {\n        _didIteratorError3 = true;\n        _iteratorError3 = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion3 && _iterator3.return) {\n            _iterator3.return();\n          }\n        } finally {\n          if (_didIteratorError3) {\n            throw _iteratorError3;\n          }\n        }\n      }\n\n      return false;\n    }\n\n    /**\n     * Returns an ε-closure for this state:\n     * self + all states following ε-transitions.\n     */\n\n  }, {\n    key: 'getEpsilonClosure',\n    value: function getEpsilonClosure() {\n      var _this2 = this;\n\n      if (!this._epsilonClosure) {\n        (function () {\n          var epsilonTransitions = _this2.getTransitionsOnSymbol(EPSILON);\n          var closure = _this2._epsilonClosure = new Set();\n          closure.add(_this2);\n          var _iteratorNormalCompletion4 = true;\n          var _didIteratorError4 = false;\n          var _iteratorError4 = undefined;\n\n          try {\n            for (var _iterator4 = epsilonTransitions[Symbol.iterator](), _step4; !(_iteratorNormalCompletion4 = (_step4 = _iterator4.next()).done); _iteratorNormalCompletion4 = true) {\n              var nextState = _step4.value;\n\n              if (!closure.has(nextState)) {\n                closure.add(nextState);\n                var nextClosure = nextState.getEpsilonClosure();\n                nextClosure.forEach(function (state) {\n                  return closure.add(state);\n                });\n              }\n            }\n          } catch (err) {\n            _didIteratorError4 = true;\n            _iteratorError4 = err;\n          } finally {\n            try {\n              if (!_iteratorNormalCompletion4 && _iterator4.return) {\n                _iterator4.return();\n              }\n            } finally {\n              if (_didIteratorError4) {\n                throw _iteratorError4;\n              }\n            }\n          }\n        })();\n      }\n\n      return this._epsilonClosure;\n    }\n  }]);\n\n  return NFAState;\n}(State);\n\nmodule.exports = NFAState;"],"mappings":"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"}