409f41464e5958c2e3aa2ba61f9f484e
'use strict';

var Node = require('../nodes/Node.js');
var Pair = require('../nodes/Pair.js');
var YAMLMap = require('../nodes/YAMLMap.js');
var YAMLSeq = require('../nodes/YAMLSeq.js');
var resolveEnd = require('./resolve-end.js');
var resolveProps = require('./resolve-props.js');
var utilContainsNewline = require('./util-contains-newline.js');
var utilMapIncludes = require('./util-map-includes.js');
const blockMsg = 'Block collections are not allowed within flow collections';
const isBlock = token => token && (token.type === 'block-map' || token.type === 'block-seq');
function resolveFlowCollection({
  composeNode,
  composeEmptyNode
}, ctx, fc, onError) {
  const isMap = fc.start.source === '{';
  const fcName = isMap ? 'flow map' : 'flow sequence';
  const coll = isMap ? new YAMLMap.YAMLMap(ctx.schema) : new YAMLSeq.YAMLSeq(ctx.schema);
  coll.flow = true;
  const atRoot = ctx.atRoot;
  if (atRoot) ctx.atRoot = false;
  let offset = fc.offset + fc.start.source.length;
  for (let i = 0; i < fc.items.length; ++i) {
    const collItem = fc.items[i];
    const {
      start,
      key,
      sep,
      value
    } = collItem;
    const props = resolveProps.resolveProps(start, {
      flow: fcName,
      indicator: 'explicit-key-ind',
      next: key ?? sep?.[0],
      offset,
      onError,
      startOnNewline: false
    });
    if (!props.found) {
      if (!props.anchor && !props.tag && !sep && !value) {
        if (i === 0 && props.comma) onError(props.comma, 'UNEXPECTED_TOKEN', `Unexpected , in ${fcName}`);else if (i < fc.items.length - 1) onError(props.start, 'UNEXPECTED_TOKEN', `Unexpected empty item in ${fcName}`);
        if (props.comment) {
          if (coll.comment) coll.comment += '\n' + props.comment;else coll.comment = props.comment;
        }
        offset = props.end;
        continue;
      }
      if (!isMap && ctx.options.strict && utilContainsNewline.containsNewline(key)) onError(key,
      // checked by containsNewline()
      'MULTILINE_IMPLICIT_KEY', 'Implicit keys of flow sequence pairs need to be on a single line');
    }
    if (i === 0) {
      if (props.comma) onError(props.comma, 'UNEXPECTED_TOKEN', `Unexpected , in ${fcName}`);
    } else {
      if (!props.comma) onError(props.start, 'MISSING_CHAR', `Missing , between ${fcName} items`);
      if (props.comment) {
        let prevItemComment = '';
        loop: for (const st of start) {
          switch (st.type) {
            case 'comma':
            case 'space':
              break;
            case 'comment':
              prevItemComment = st.source.substring(1);
              break loop;
            default:
              break loop;
          }
        }
        if (prevItemComment) {
          let prev = coll.items[coll.items.length - 1];
          if (Node.isPair(prev)) prev = prev.value ?? prev.key;
          if (prev.comment) prev.comment += '\n' + prevItemComment;else prev.comment = prevItemComment;
          props.comment = props.comment.substring(prevItemComment.length + 1);
        }
      }
    }
    if (!isMap && !sep && !props.found) {
      // item is a value in a seq
      // â†’ key & sep are empty, start does not include ? or :
      const valueNode = value ? composeNode(ctx, value, props, onError) : composeEmptyNode(ctx, props.end, sep, null, props, onError);
      coll.items.push(valueNode);
      offset = valueNode.range[2];
      if (isBlock(value)) onError(valueNode.range, 'BLOCK_IN_FLOW', blockMsg);
    } else {
      // item is a key+value pair
      // key value
      const keyStart = props.end;
      const keyNode = key ? composeNode(ctx, key, props, onError) : composeEmptyNode(ctx, keyStart, start, null, props, onError);
      if (isBlock(key)) onError(keyNode.range, 'BLOCK_IN_FLOW', blockMsg);
      // value properties
      const valueProps = resolveProps.resolveProps(sep ?? [], {
        flow: fcName,
        indicator: 'map-value-ind',
        next: value,
        offset: keyNode.range[2],
        onError,
        startOnNewline: false
      });
      if (valueProps.found) {
        if (!isMap && !props.found && ctx.options.strict) {
          if (sep) for (const st of sep) {
            if (st === valueProps.found) break;
            if (st.type === 'newline') {
              onError(st, 'MULTILINE_IMPLICIT_KEY', 'Implicit keys of flow sequence pairs need to be on a single line');
              break;
            }
          }
          if (props.start < valueProps.found.offset - 1024) onError(valueProps.found, 'KEY_OVER_1024_CHARS', 'The : indicator must be at most 1024 chars after the start of an implicit flow sequence key');
        }
      } else if (value) {
        if ('source' in value && value.source && value.source[0] === ':') onError(value, 'MISSING_CHAR', `Missing space after : in ${fcName}`);else onError(valueProps.start, 'MISSING_CHAR', `Missing , or : between ${fcName} items`);
      }
      // value value
      const valueNode = value ? composeNode(ctx, value, valueProps, onError) : valueProps.found ? composeEmptyNode(ctx, valueProps.end, sep, null, valueProps, onError) : null;
      if (valueNode) {
        if (isBlock(value)) onError(valueNode.range, 'BLOCK_IN_FLOW', blockMsg);
      } else if (valueProps.comment) {
        if (keyNode.comment) keyNode.comment += '\n' + valueProps.comment;else keyNode.comment = valueProps.comment;
      }
      const pair = new Pair.Pair(keyNode, valueNode);
      if (ctx.options.keepSourceTokens) pair.srcToken = collItem;
      if (isMap) {
        const map = coll;
        if (utilMapIncludes.mapIncludes(ctx, map.items, keyNode)) onError(keyStart, 'DUPLICATE_KEY', 'Map keys must be unique');
        map.items.push(pair);
      } else {
        const map = new YAMLMap.YAMLMap(ctx.schema);
        map.flow = true;
        map.items.push(pair);
        coll.items.push(map);
      }
      offset = valueNode ? valueNode.range[2] : valueProps.end;
    }
  }
  const expectedEnd = isMap ? '}' : ']';
  const [ce, ...ee] = fc.end;
  let cePos = offset;
  if (ce && ce.source === expectedEnd) cePos = ce.offset + ce.source.length;else {
    const name = fcName[0].toUpperCase() + fcName.substring(1);
    const msg = atRoot ? `${name} must end with a ${expectedEnd}` : `${name} in block collection must be sufficiently indented and end with a ${expectedEnd}`;
    onError(offset, atRoot ? 'MISSING_CHAR' : 'BAD_INDENT', msg);
    if (ce && ce.source.length !== 1) ee.unshift(ce);
  }
  if (ee.length > 0) {
    const end = resolveEnd.resolveEnd(ee, cePos, ctx.options.strict, onError);
    if (end.comment) {
      if (coll.comment) coll.comment += '\n' + end.comment;else coll.comment = end.comment;
    }
    coll.range = [fc.offset, cePos, end.offset];
  } else {
    coll.range = [fc.offset, cePos, cePos];
  }
  return coll;
}
exports.resolveFlowCollection = resolveFlowCollection;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJOb2RlIiwicmVxdWlyZSIsIlBhaXIiLCJZQU1MTWFwIiwiWUFNTFNlcSIsInJlc29sdmVFbmQiLCJyZXNvbHZlUHJvcHMiLCJ1dGlsQ29udGFpbnNOZXdsaW5lIiwidXRpbE1hcEluY2x1ZGVzIiwiYmxvY2tNc2ciLCJpc0Jsb2NrIiwidG9rZW4iLCJ0eXBlIiwicmVzb2x2ZUZsb3dDb2xsZWN0aW9uIiwiY29tcG9zZU5vZGUiLCJjb21wb3NlRW1wdHlOb2RlIiwiY3R4IiwiZmMiLCJvbkVycm9yIiwiaXNNYXAiLCJzdGFydCIsInNvdXJjZSIsImZjTmFtZSIsImNvbGwiLCJzY2hlbWEiLCJmbG93IiwiYXRSb290Iiwib2Zmc2V0IiwibGVuZ3RoIiwiaSIsIml0ZW1zIiwiY29sbEl0ZW0iLCJrZXkiLCJzZXAiLCJ2YWx1ZSIsInByb3BzIiwiaW5kaWNhdG9yIiwibmV4dCIsInN0YXJ0T25OZXdsaW5lIiwiZm91bmQiLCJhbmNob3IiLCJ0YWciLCJjb21tYSIsImNvbW1lbnQiLCJlbmQiLCJvcHRpb25zIiwic3RyaWN0IiwiY29udGFpbnNOZXdsaW5lIiwicHJldkl0ZW1Db21tZW50IiwibG9vcCIsInN0Iiwic3Vic3RyaW5nIiwicHJldiIsImlzUGFpciIsInZhbHVlTm9kZSIsInB1c2giLCJyYW5nZSIsImtleVN0YXJ0Iiwia2V5Tm9kZSIsInZhbHVlUHJvcHMiLCJwYWlyIiwia2VlcFNvdXJjZVRva2VucyIsInNyY1Rva2VuIiwibWFwIiwibWFwSW5jbHVkZXMiLCJleHBlY3RlZEVuZCIsImNlIiwiZWUiLCJjZVBvcyIsIm5hbWUiLCJ0b1VwcGVyQ2FzZSIsIm1zZyIsInVuc2hpZnQiLCJleHBvcnRzIl0sInNvdXJjZXMiOlsicmVzb2x2ZS1mbG93LWNvbGxlY3Rpb24uanMiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG52YXIgTm9kZSA9IHJlcXVpcmUoJy4uL25vZGVzL05vZGUuanMnKTtcbnZhciBQYWlyID0gcmVxdWlyZSgnLi4vbm9kZXMvUGFpci5qcycpO1xudmFyIFlBTUxNYXAgPSByZXF1aXJlKCcuLi9ub2Rlcy9ZQU1MTWFwLmpzJyk7XG52YXIgWUFNTFNlcSA9IHJlcXVpcmUoJy4uL25vZGVzL1lBTUxTZXEuanMnKTtcbnZhciByZXNvbHZlRW5kID0gcmVxdWlyZSgnLi9yZXNvbHZlLWVuZC5qcycpO1xudmFyIHJlc29sdmVQcm9wcyA9IHJlcXVpcmUoJy4vcmVzb2x2ZS1wcm9wcy5qcycpO1xudmFyIHV0aWxDb250YWluc05ld2xpbmUgPSByZXF1aXJlKCcuL3V0aWwtY29udGFpbnMtbmV3bGluZS5qcycpO1xudmFyIHV0aWxNYXBJbmNsdWRlcyA9IHJlcXVpcmUoJy4vdXRpbC1tYXAtaW5jbHVkZXMuanMnKTtcblxuY29uc3QgYmxvY2tNc2cgPSAnQmxvY2sgY29sbGVjdGlvbnMgYXJlIG5vdCBhbGxvd2VkIHdpdGhpbiBmbG93IGNvbGxlY3Rpb25zJztcbmNvbnN0IGlzQmxvY2sgPSAodG9rZW4pID0+IHRva2VuICYmICh0b2tlbi50eXBlID09PSAnYmxvY2stbWFwJyB8fCB0b2tlbi50eXBlID09PSAnYmxvY2stc2VxJyk7XG5mdW5jdGlvbiByZXNvbHZlRmxvd0NvbGxlY3Rpb24oeyBjb21wb3NlTm9kZSwgY29tcG9zZUVtcHR5Tm9kZSB9LCBjdHgsIGZjLCBvbkVycm9yKSB7XG4gICAgY29uc3QgaXNNYXAgPSBmYy5zdGFydC5zb3VyY2UgPT09ICd7JztcbiAgICBjb25zdCBmY05hbWUgPSBpc01hcCA/ICdmbG93IG1hcCcgOiAnZmxvdyBzZXF1ZW5jZSc7XG4gICAgY29uc3QgY29sbCA9IGlzTWFwXG4gICAgICAgID8gbmV3IFlBTUxNYXAuWUFNTE1hcChjdHguc2NoZW1hKVxuICAgICAgICA6IG5ldyBZQU1MU2VxLllBTUxTZXEoY3R4LnNjaGVtYSk7XG4gICAgY29sbC5mbG93ID0gdHJ1ZTtcbiAgICBjb25zdCBhdFJvb3QgPSBjdHguYXRSb290O1xuICAgIGlmIChhdFJvb3QpXG4gICAgICAgIGN0eC5hdFJvb3QgPSBmYWxzZTtcbiAgICBsZXQgb2Zmc2V0ID0gZmMub2Zmc2V0ICsgZmMuc3RhcnQuc291cmNlLmxlbmd0aDtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGZjLml0ZW1zLmxlbmd0aDsgKytpKSB7XG4gICAgICAgIGNvbnN0IGNvbGxJdGVtID0gZmMuaXRlbXNbaV07XG4gICAgICAgIGNvbnN0IHsgc3RhcnQsIGtleSwgc2VwLCB2YWx1ZSB9ID0gY29sbEl0ZW07XG4gICAgICAgIGNvbnN0IHByb3BzID0gcmVzb2x2ZVByb3BzLnJlc29sdmVQcm9wcyhzdGFydCwge1xuICAgICAgICAgICAgZmxvdzogZmNOYW1lLFxuICAgICAgICAgICAgaW5kaWNhdG9yOiAnZXhwbGljaXQta2V5LWluZCcsXG4gICAgICAgICAgICBuZXh0OiBrZXkgPz8gc2VwPy5bMF0sXG4gICAgICAgICAgICBvZmZzZXQsXG4gICAgICAgICAgICBvbkVycm9yLFxuICAgICAgICAgICAgc3RhcnRPbk5ld2xpbmU6IGZhbHNlXG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoIXByb3BzLmZvdW5kKSB7XG4gICAgICAgICAgICBpZiAoIXByb3BzLmFuY2hvciAmJiAhcHJvcHMudGFnICYmICFzZXAgJiYgIXZhbHVlKSB7XG4gICAgICAgICAgICAgICAgaWYgKGkgPT09IDAgJiYgcHJvcHMuY29tbWEpXG4gICAgICAgICAgICAgICAgICAgIG9uRXJyb3IocHJvcHMuY29tbWEsICdVTkVYUEVDVEVEX1RPS0VOJywgYFVuZXhwZWN0ZWQgLCBpbiAke2ZjTmFtZX1gKTtcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChpIDwgZmMuaXRlbXMubGVuZ3RoIC0gMSlcbiAgICAgICAgICAgICAgICAgICAgb25FcnJvcihwcm9wcy5zdGFydCwgJ1VORVhQRUNURURfVE9LRU4nLCBgVW5leHBlY3RlZCBlbXB0eSBpdGVtIGluICR7ZmNOYW1lfWApO1xuICAgICAgICAgICAgICAgIGlmIChwcm9wcy5jb21tZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjb2xsLmNvbW1lbnQpXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2xsLmNvbW1lbnQgKz0gJ1xcbicgKyBwcm9wcy5jb21tZW50O1xuICAgICAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2xsLmNvbW1lbnQgPSBwcm9wcy5jb21tZW50O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBvZmZzZXQgPSBwcm9wcy5lbmQ7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIWlzTWFwICYmIGN0eC5vcHRpb25zLnN0cmljdCAmJiB1dGlsQ29udGFpbnNOZXdsaW5lLmNvbnRhaW5zTmV3bGluZShrZXkpKVxuICAgICAgICAgICAgICAgIG9uRXJyb3Ioa2V5LCAvLyBjaGVja2VkIGJ5IGNvbnRhaW5zTmV3bGluZSgpXG4gICAgICAgICAgICAgICAgJ01VTFRJTElORV9JTVBMSUNJVF9LRVknLCAnSW1wbGljaXQga2V5cyBvZiBmbG93IHNlcXVlbmNlIHBhaXJzIG5lZWQgdG8gYmUgb24gYSBzaW5nbGUgbGluZScpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpID09PSAwKSB7XG4gICAgICAgICAgICBpZiAocHJvcHMuY29tbWEpXG4gICAgICAgICAgICAgICAgb25FcnJvcihwcm9wcy5jb21tYSwgJ1VORVhQRUNURURfVE9LRU4nLCBgVW5leHBlY3RlZCAsIGluICR7ZmNOYW1lfWApO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaWYgKCFwcm9wcy5jb21tYSlcbiAgICAgICAgICAgICAgICBvbkVycm9yKHByb3BzLnN0YXJ0LCAnTUlTU0lOR19DSEFSJywgYE1pc3NpbmcgLCBiZXR3ZWVuICR7ZmNOYW1lfSBpdGVtc2ApO1xuICAgICAgICAgICAgaWYgKHByb3BzLmNvbW1lbnQpIHtcbiAgICAgICAgICAgICAgICBsZXQgcHJldkl0ZW1Db21tZW50ID0gJyc7XG4gICAgICAgICAgICAgICAgbG9vcDogZm9yIChjb25zdCBzdCBvZiBzdGFydCkge1xuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKHN0LnR5cGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2NvbW1hJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3NwYWNlJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2NvbW1lbnQnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZXZJdGVtQ29tbWVudCA9IHN0LnNvdXJjZS5zdWJzdHJpbmcoMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsgbG9vcDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsgbG9vcDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAocHJldkl0ZW1Db21tZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBwcmV2ID0gY29sbC5pdGVtc1tjb2xsLml0ZW1zLmxlbmd0aCAtIDFdO1xuICAgICAgICAgICAgICAgICAgICBpZiAoTm9kZS5pc1BhaXIocHJldikpXG4gICAgICAgICAgICAgICAgICAgICAgICBwcmV2ID0gcHJldi52YWx1ZSA/PyBwcmV2LmtleTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHByZXYuY29tbWVudClcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZXYuY29tbWVudCArPSAnXFxuJyArIHByZXZJdGVtQ29tbWVudDtcbiAgICAgICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICAgICAgcHJldi5jb21tZW50ID0gcHJldkl0ZW1Db21tZW50O1xuICAgICAgICAgICAgICAgICAgICBwcm9wcy5jb21tZW50ID0gcHJvcHMuY29tbWVudC5zdWJzdHJpbmcocHJldkl0ZW1Db21tZW50Lmxlbmd0aCArIDEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoIWlzTWFwICYmICFzZXAgJiYgIXByb3BzLmZvdW5kKSB7XG4gICAgICAgICAgICAvLyBpdGVtIGlzIGEgdmFsdWUgaW4gYSBzZXFcbiAgICAgICAgICAgIC8vIOKGkiBrZXkgJiBzZXAgYXJlIGVtcHR5LCBzdGFydCBkb2VzIG5vdCBpbmNsdWRlID8gb3IgOlxuICAgICAgICAgICAgY29uc3QgdmFsdWVOb2RlID0gdmFsdWVcbiAgICAgICAgICAgICAgICA/IGNvbXBvc2VOb2RlKGN0eCwgdmFsdWUsIHByb3BzLCBvbkVycm9yKVxuICAgICAgICAgICAgICAgIDogY29tcG9zZUVtcHR5Tm9kZShjdHgsIHByb3BzLmVuZCwgc2VwLCBudWxsLCBwcm9wcywgb25FcnJvcik7XG4gICAgICAgICAgICBjb2xsLml0ZW1zLnB1c2godmFsdWVOb2RlKTtcbiAgICAgICAgICAgIG9mZnNldCA9IHZhbHVlTm9kZS5yYW5nZVsyXTtcbiAgICAgICAgICAgIGlmIChpc0Jsb2NrKHZhbHVlKSlcbiAgICAgICAgICAgICAgICBvbkVycm9yKHZhbHVlTm9kZS5yYW5nZSwgJ0JMT0NLX0lOX0ZMT1cnLCBibG9ja01zZyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvLyBpdGVtIGlzIGEga2V5K3ZhbHVlIHBhaXJcbiAgICAgICAgICAgIC8vIGtleSB2YWx1ZVxuICAgICAgICAgICAgY29uc3Qga2V5U3RhcnQgPSBwcm9wcy5lbmQ7XG4gICAgICAgICAgICBjb25zdCBrZXlOb2RlID0ga2V5XG4gICAgICAgICAgICAgICAgPyBjb21wb3NlTm9kZShjdHgsIGtleSwgcHJvcHMsIG9uRXJyb3IpXG4gICAgICAgICAgICAgICAgOiBjb21wb3NlRW1wdHlOb2RlKGN0eCwga2V5U3RhcnQsIHN0YXJ0LCBudWxsLCBwcm9wcywgb25FcnJvcik7XG4gICAgICAgICAgICBpZiAoaXNCbG9jayhrZXkpKVxuICAgICAgICAgICAgICAgIG9uRXJyb3Ioa2V5Tm9kZS5yYW5nZSwgJ0JMT0NLX0lOX0ZMT1cnLCBibG9ja01zZyk7XG4gICAgICAgICAgICAvLyB2YWx1ZSBwcm9wZXJ0aWVzXG4gICAgICAgICAgICBjb25zdCB2YWx1ZVByb3BzID0gcmVzb2x2ZVByb3BzLnJlc29sdmVQcm9wcyhzZXAgPz8gW10sIHtcbiAgICAgICAgICAgICAgICBmbG93OiBmY05hbWUsXG4gICAgICAgICAgICAgICAgaW5kaWNhdG9yOiAnbWFwLXZhbHVlLWluZCcsXG4gICAgICAgICAgICAgICAgbmV4dDogdmFsdWUsXG4gICAgICAgICAgICAgICAgb2Zmc2V0OiBrZXlOb2RlLnJhbmdlWzJdLFxuICAgICAgICAgICAgICAgIG9uRXJyb3IsXG4gICAgICAgICAgICAgICAgc3RhcnRPbk5ld2xpbmU6IGZhbHNlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmICh2YWx1ZVByb3BzLmZvdW5kKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFpc01hcCAmJiAhcHJvcHMuZm91bmQgJiYgY3R4Lm9wdGlvbnMuc3RyaWN0KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzZXApXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHN0IG9mIHNlcCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdCA9PT0gdmFsdWVQcm9wcy5mb3VuZClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN0LnR5cGUgPT09ICduZXdsaW5lJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkVycm9yKHN0LCAnTVVMVElMSU5FX0lNUExJQ0lUX0tFWScsICdJbXBsaWNpdCBrZXlzIG9mIGZsb3cgc2VxdWVuY2UgcGFpcnMgbmVlZCB0byBiZSBvbiBhIHNpbmdsZSBsaW5lJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHByb3BzLnN0YXJ0IDwgdmFsdWVQcm9wcy5mb3VuZC5vZmZzZXQgLSAxMDI0KVxuICAgICAgICAgICAgICAgICAgICAgICAgb25FcnJvcih2YWx1ZVByb3BzLmZvdW5kLCAnS0VZX09WRVJfMTAyNF9DSEFSUycsICdUaGUgOiBpbmRpY2F0b3IgbXVzdCBiZSBhdCBtb3N0IDEwMjQgY2hhcnMgYWZ0ZXIgdGhlIHN0YXJ0IG9mIGFuIGltcGxpY2l0IGZsb3cgc2VxdWVuY2Uga2V5Jyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAodmFsdWUpIHtcbiAgICAgICAgICAgICAgICBpZiAoJ3NvdXJjZScgaW4gdmFsdWUgJiYgdmFsdWUuc291cmNlICYmIHZhbHVlLnNvdXJjZVswXSA9PT0gJzonKVxuICAgICAgICAgICAgICAgICAgICBvbkVycm9yKHZhbHVlLCAnTUlTU0lOR19DSEFSJywgYE1pc3Npbmcgc3BhY2UgYWZ0ZXIgOiBpbiAke2ZjTmFtZX1gKTtcbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgIG9uRXJyb3IodmFsdWVQcm9wcy5zdGFydCwgJ01JU1NJTkdfQ0hBUicsIGBNaXNzaW5nICwgb3IgOiBiZXR3ZWVuICR7ZmNOYW1lfSBpdGVtc2ApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gdmFsdWUgdmFsdWVcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlTm9kZSA9IHZhbHVlXG4gICAgICAgICAgICAgICAgPyBjb21wb3NlTm9kZShjdHgsIHZhbHVlLCB2YWx1ZVByb3BzLCBvbkVycm9yKVxuICAgICAgICAgICAgICAgIDogdmFsdWVQcm9wcy5mb3VuZFxuICAgICAgICAgICAgICAgICAgICA/IGNvbXBvc2VFbXB0eU5vZGUoY3R4LCB2YWx1ZVByb3BzLmVuZCwgc2VwLCBudWxsLCB2YWx1ZVByb3BzLCBvbkVycm9yKVxuICAgICAgICAgICAgICAgICAgICA6IG51bGw7XG4gICAgICAgICAgICBpZiAodmFsdWVOb2RlKSB7XG4gICAgICAgICAgICAgICAgaWYgKGlzQmxvY2sodmFsdWUpKVxuICAgICAgICAgICAgICAgICAgICBvbkVycm9yKHZhbHVlTm9kZS5yYW5nZSwgJ0JMT0NLX0lOX0ZMT1cnLCBibG9ja01zZyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh2YWx1ZVByb3BzLmNvbW1lbnQpIHtcbiAgICAgICAgICAgICAgICBpZiAoa2V5Tm9kZS5jb21tZW50KVxuICAgICAgICAgICAgICAgICAgICBrZXlOb2RlLmNvbW1lbnQgKz0gJ1xcbicgKyB2YWx1ZVByb3BzLmNvbW1lbnQ7XG4gICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICBrZXlOb2RlLmNvbW1lbnQgPSB2YWx1ZVByb3BzLmNvbW1lbnQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBwYWlyID0gbmV3IFBhaXIuUGFpcihrZXlOb2RlLCB2YWx1ZU5vZGUpO1xuICAgICAgICAgICAgaWYgKGN0eC5vcHRpb25zLmtlZXBTb3VyY2VUb2tlbnMpXG4gICAgICAgICAgICAgICAgcGFpci5zcmNUb2tlbiA9IGNvbGxJdGVtO1xuICAgICAgICAgICAgaWYgKGlzTWFwKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbWFwID0gY29sbDtcbiAgICAgICAgICAgICAgICBpZiAodXRpbE1hcEluY2x1ZGVzLm1hcEluY2x1ZGVzKGN0eCwgbWFwLml0ZW1zLCBrZXlOb2RlKSlcbiAgICAgICAgICAgICAgICAgICAgb25FcnJvcihrZXlTdGFydCwgJ0RVUExJQ0FURV9LRVknLCAnTWFwIGtleXMgbXVzdCBiZSB1bmlxdWUnKTtcbiAgICAgICAgICAgICAgICBtYXAuaXRlbXMucHVzaChwYWlyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnN0IG1hcCA9IG5ldyBZQU1MTWFwLllBTUxNYXAoY3R4LnNjaGVtYSk7XG4gICAgICAgICAgICAgICAgbWFwLmZsb3cgPSB0cnVlO1xuICAgICAgICAgICAgICAgIG1hcC5pdGVtcy5wdXNoKHBhaXIpO1xuICAgICAgICAgICAgICAgIGNvbGwuaXRlbXMucHVzaChtYXApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgb2Zmc2V0ID0gdmFsdWVOb2RlID8gdmFsdWVOb2RlLnJhbmdlWzJdIDogdmFsdWVQcm9wcy5lbmQ7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY29uc3QgZXhwZWN0ZWRFbmQgPSBpc01hcCA/ICd9JyA6ICddJztcbiAgICBjb25zdCBbY2UsIC4uLmVlXSA9IGZjLmVuZDtcbiAgICBsZXQgY2VQb3MgPSBvZmZzZXQ7XG4gICAgaWYgKGNlICYmIGNlLnNvdXJjZSA9PT0gZXhwZWN0ZWRFbmQpXG4gICAgICAgIGNlUG9zID0gY2Uub2Zmc2V0ICsgY2Uuc291cmNlLmxlbmd0aDtcbiAgICBlbHNlIHtcbiAgICAgICAgY29uc3QgbmFtZSA9IGZjTmFtZVswXS50b1VwcGVyQ2FzZSgpICsgZmNOYW1lLnN1YnN0cmluZygxKTtcbiAgICAgICAgY29uc3QgbXNnID0gYXRSb290XG4gICAgICAgICAgICA/IGAke25hbWV9IG11c3QgZW5kIHdpdGggYSAke2V4cGVjdGVkRW5kfWBcbiAgICAgICAgICAgIDogYCR7bmFtZX0gaW4gYmxvY2sgY29sbGVjdGlvbiBtdXN0IGJlIHN1ZmZpY2llbnRseSBpbmRlbnRlZCBhbmQgZW5kIHdpdGggYSAke2V4cGVjdGVkRW5kfWA7XG4gICAgICAgIG9uRXJyb3Iob2Zmc2V0LCBhdFJvb3QgPyAnTUlTU0lOR19DSEFSJyA6ICdCQURfSU5ERU5UJywgbXNnKTtcbiAgICAgICAgaWYgKGNlICYmIGNlLnNvdXJjZS5sZW5ndGggIT09IDEpXG4gICAgICAgICAgICBlZS51bnNoaWZ0KGNlKTtcbiAgICB9XG4gICAgaWYgKGVlLmxlbmd0aCA+IDApIHtcbiAgICAgICAgY29uc3QgZW5kID0gcmVzb2x2ZUVuZC5yZXNvbHZlRW5kKGVlLCBjZVBvcywgY3R4Lm9wdGlvbnMuc3RyaWN0LCBvbkVycm9yKTtcbiAgICAgICAgaWYgKGVuZC5jb21tZW50KSB7XG4gICAgICAgICAgICBpZiAoY29sbC5jb21tZW50KVxuICAgICAgICAgICAgICAgIGNvbGwuY29tbWVudCArPSAnXFxuJyArIGVuZC5jb21tZW50O1xuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIGNvbGwuY29tbWVudCA9IGVuZC5jb21tZW50O1xuICAgICAgICB9XG4gICAgICAgIGNvbGwucmFuZ2UgPSBbZmMub2Zmc2V0LCBjZVBvcywgZW5kLm9mZnNldF07XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBjb2xsLnJhbmdlID0gW2ZjLm9mZnNldCwgY2VQb3MsIGNlUG9zXTtcbiAgICB9XG4gICAgcmV0dXJuIGNvbGw7XG59XG5cbmV4cG9ydHMucmVzb2x2ZUZsb3dDb2xsZWN0aW9uID0gcmVzb2x2ZUZsb3dDb2xsZWN0aW9uO1xuIl0sIm1hcHBpbmdzIjoiQUFBQSxZQUFZOztBQUVaLElBQUlBLElBQUksR0FBR0MsT0FBTyxDQUFDLGtCQUFrQixDQUFDO0FBQ3RDLElBQUlDLElBQUksR0FBR0QsT0FBTyxDQUFDLGtCQUFrQixDQUFDO0FBQ3RDLElBQUlFLE9BQU8sR0FBR0YsT0FBTyxDQUFDLHFCQUFxQixDQUFDO0FBQzVDLElBQUlHLE9BQU8sR0FBR0gsT0FBTyxDQUFDLHFCQUFxQixDQUFDO0FBQzVDLElBQUlJLFVBQVUsR0FBR0osT0FBTyxDQUFDLGtCQUFrQixDQUFDO0FBQzVDLElBQUlLLFlBQVksR0FBR0wsT0FBTyxDQUFDLG9CQUFvQixD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