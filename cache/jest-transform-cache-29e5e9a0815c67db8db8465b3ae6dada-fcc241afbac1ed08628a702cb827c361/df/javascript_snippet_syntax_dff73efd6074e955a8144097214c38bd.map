{"version":3,"names":["snippet_syntax_1","require","CALLBACK_NAME","JavaScriptSnippetSyntax","constructor","snippetInterface","build","comment","generatedExpressions","functionName","stepParameterNames","functionKeyword","SnippetInterface","AsyncAwait","implementation","Callback","Promise","definitionChoices","map","generatedExpression","index","prefix","allParameterNames","parameterNames","concat","push","escapeSpecialCharacters","join","source","replace","exports","default"],"sources":["../../../src/formatter/step_definition_snippet_builder/javascript_snippet_syntax.ts"],"sourcesContent":["import { GeneratedExpression } from '@cucumber/cucumber-expressions'\nimport {\n  ISnippetSnytax,\n  ISnippetSyntaxBuildOptions,\n  SnippetInterface,\n} from './snippet_syntax'\n\nconst CALLBACK_NAME = 'callback'\n\nexport default class JavaScriptSnippetSyntax implements ISnippetSnytax {\n  private readonly snippetInterface: SnippetInterface\n\n  constructor(snippetInterface: SnippetInterface) {\n    this.snippetInterface = snippetInterface\n  }\n\n  build({\n    comment,\n    generatedExpressions,\n    functionName,\n    stepParameterNames,\n  }: ISnippetSyntaxBuildOptions): string {\n    let functionKeyword = 'function '\n    if (this.snippetInterface === SnippetInterface.AsyncAwait) {\n      functionKeyword = 'async ' + functionKeyword\n    }\n\n    let implementation: string\n    if (this.snippetInterface === SnippetInterface.Callback) {\n      implementation = `${CALLBACK_NAME}(null, 'pending');`\n    } else if (this.snippetInterface === SnippetInterface.Promise) {\n      implementation = \"return Promise.resolve('pending');\"\n    } else {\n      implementation = \"return 'pending';\"\n    }\n\n    const definitionChoices = generatedExpressions.map(\n      (generatedExpression, index) => {\n        const prefix = index === 0 ? '' : '// '\n        const allParameterNames =\n          generatedExpression.parameterNames.concat(stepParameterNames)\n        if (this.snippetInterface === SnippetInterface.Callback) {\n          allParameterNames.push(CALLBACK_NAME)\n        }\n        return `${prefix + functionName}('${this.escapeSpecialCharacters(\n          generatedExpression\n        )}', ${functionKeyword}(${allParameterNames.join(', ')}) {\\n`\n      }\n    )\n\n    return (\n      `${definitionChoices.join('')}  // ${comment}\\n` +\n      `  ${implementation}\\n` +\n      '});'\n    )\n  }\n\n  private escapeSpecialCharacters(generatedExpression: GeneratedExpression) {\n    let source = generatedExpression.source\n    // double up any backslashes because we're in a javascript string\n    source = source.replace(/\\\\/g, '\\\\\\\\')\n    // escape any single quotes because that's our quote delimiter\n    source = source.replace(/'/g, \"\\\\'\")\n    return source\n  }\n}\n"],"mappings":";;;;;AACA,MAAAA,gBAAA,GAAAC,OAAA;AAMA,MAAMC,aAAa,GAAG,UAAU;AAEhC,MAAqBC,uBAAuB;EAG1CC,YAAYC,gBAAkC;IAC5C,IAAI,CAACA,gBAAgB,GAAGA,gBAAgB;EAC1C;EAEAC,KAAKA,CAAC;IACJC,OAAO;IACPC,oBAAoB;IACpBC,YAAY;IACZC;EAAkB,CACS;IAC3B,IAAIC,eAAe,GAAG,WAAW;IACjC,IAAI,IAAI,CAACN,gBAAgB,KAAKL,gBAAA,CAAAY,gBAAgB,CAACC,UAAU,EAAE;MACzDF,eAAe,GAAG,QAAQ,GAAGA,eAAe;;IAG9C,IAAIG,cAAsB;IAC1B,IAAI,IAAI,CAACT,gBAAgB,KAAKL,gBAAA,CAAAY,gBAAgB,CAACG,QAAQ,EAAE;MACvDD,cAAc,GAAG,GAAGZ,aAAa,oBAAoB;KACtD,MAAM,IAAI,IAAI,CAACG,gBAAgB,KAAKL,gBAAA,CAAAY,gBAAgB,CAACI,OAAO,EAAE;MAC7DF,cAAc,GAAG,oCAAoC;KACtD,MAAM;MACLA,cAAc,GAAG,mBAAmB;;IAGtC,MAAMG,iBAAiB,GAAGT,oBAAoB,CAACU,GAAG,CAChD,CAACC,mBAAmB,EAAEC,KAAK,KAAI;MAC7B,MAAMC,MAAM,GAAGD,KAAK,KAAK,CAAC,GAAG,EAAE,GAAG,KAAK;MACvC,MAAME,iBAAiB,GACrBH,mBAAmB,CAACI,cAAc,CAACC,MAAM,CAACd,kBAAkB,CAAC;MAC/D,IAAI,IAAI,CAACL,gBAAgB,KAAKL,gBAAA,CAAAY,gBAAgB,CAACG,QAAQ,EAAE;QACvDO,iBAAiB,CAACG,IAAI,CAACvB,aAAa,CAAC;;MAEvC,OAAO,GAAGmB,MAAM,GAAGZ,YAAY,KAAK,IAAI,CAACiB,uBAAuB,CAC9DP,mBAAmB,CACpB,MAAMR,eAAe,IAAIW,iBAAiB,CAACK,IAAI,CAAC,IAAI,CAAC,OAAO;IAC/D,CAAC,CACF;IAED,OACE,GAAGV,iBAAiB,CAACU,IAAI,CAAC,EAAE,CAAC,QAAQpB,OAAO,IAAI,GAChD,KAAKO,cAAc,IAAI,GACvB,KAAK;EAET;EAEQY,uBAAuBA,CAACP,mBAAwC;IACtE,IAAIS,MAAM,GAAGT,mBAAmB,CAACS,MAAM;IACvC;IACAA,MAAM,GAAGA,MAAM,CAACC,OAAO,CAAC,KAAK,EAAE,MAAM,CAAC;IACtC;IACAD,MAAM,GAAGA,MAAM,CAACC,OAAO,CAAC,IAAI,EAAE,KAAK,CAAC;IACpC,OAAOD,MAAM;EACf;;AAvDFE,OAAA,CAAAC,OAAA,GAAA5B,uBAAA"}