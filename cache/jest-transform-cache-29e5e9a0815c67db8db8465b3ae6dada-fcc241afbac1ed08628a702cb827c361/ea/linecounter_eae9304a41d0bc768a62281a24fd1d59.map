{"version":3,"names":["LineCounter","constructor","lineStarts","addNewLine","offset","push","linePos","low","high","length","mid","line","col","start","exports"],"sources":["line-counter.js"],"sourcesContent":["'use strict';\n\n/**\n * Tracks newlines during parsing in order to provide an efficient API for\n * determining the one-indexed `{ line, col }` position for any offset\n * within the input.\n */\nclass LineCounter {\n    constructor() {\n        this.lineStarts = [];\n        /**\n         * Should be called in ascending order. Otherwise, call\n         * `lineCounter.lineStarts.sort()` before calling `linePos()`.\n         */\n        this.addNewLine = (offset) => this.lineStarts.push(offset);\n        /**\n         * Performs a binary search and returns the 1-indexed { line, col }\n         * position of `offset`. If `line === 0`, `addNewLine` has never been\n         * called or `offset` is before the first known newline.\n         */\n        this.linePos = (offset) => {\n            let low = 0;\n            let high = this.lineStarts.length;\n            while (low < high) {\n                const mid = (low + high) >> 1; // Math.floor((low + high) / 2)\n                if (this.lineStarts[mid] < offset)\n                    low = mid + 1;\n                else\n                    high = mid;\n            }\n            if (this.lineStarts[low] === offset)\n                return { line: low + 1, col: 1 };\n            if (low === 0)\n                return { line: 0, col: offset };\n            const start = this.lineStarts[low - 1];\n            return { line: low, col: offset - start + 1 };\n        };\n    }\n}\n\nexports.LineCounter = LineCounter;\n"],"mappings":"AAAA,YAAY;;AAEZ;AACA;AACA;AACA;AACA;AACA,MAAMA,WAAW,CAAC;EACdC,WAAWA,CAAA,EAAG;IACV,IAAI,CAACC,UAAU,GAAG,EAAE;IACpB;AACR;AACA;AACA;IACQ,IAAI,CAACC,UAAU,GAAIC,MAAM,IAAK,IAAI,CAACF,UAAU,CAACG,IAAI,CAACD,MAAM,CAAC;IAC1D;AACR;AACA;AACA;AACA;IACQ,IAAI,CAACE,OAAO,GAAIF,MAAM,IAAK;MACvB,IAAIG,GAAG,GAAG,CAAC;MACX,IAAIC,IAAI,GAAG,IAAI,CAACN,UAAU,CAACO,MAAM;MACjC,OAAOF,GAAG,GAAGC,IAAI,EAAE;QACf,MAAME,GAAG,GAAIH,GAAG,GAAGC,IAAI,IAAK,CAAC,CAAC,CAAC;QAC/B,IAAI,IAAI,CAACN,UAAU,CAACQ,GAAG,CAAC,GAAGN,MAAM,EAC7BG,GAAG,GAAGG,GAAG,GAAG,CAAC,CAAC,KAEdF,IAAI,GAAGE,GAAG;MAClB;MACA,IAAI,IAAI,CAACR,UAAU,CAACK,GAAG,CAAC,KAAKH,MAAM,EAC/B,OAAO;QAAEO,IAAI,EAAEJ,GAAG,GAAG,CAAC;QAAEK,GAAG,EAAE;MAAE,CAAC;MACpC,IAAIL,GAAG,KAAK,CAAC,EACT,OAAO;QAAEI,IAAI,EAAE,CAAC;QAAEC,GAAG,EAAER;MAAO,CAAC;MACnC,MAAMS,KAAK,GAAG,IAAI,CAACX,UAAU,CAACK,GAAG,GAAG,CAAC,CAAC;MACtC,OAAO;QAAEI,IAAI,EAAEJ,GAAG;QAAEK,GAAG,EAAER,MAAM,GAAGS,KAAK,GAAG;MAAE,CAAC;IACjD,CAAC;EACL;AACJ;AAEAC,OAAO,CAACd,WAAW,GAAGA,WAAW"}