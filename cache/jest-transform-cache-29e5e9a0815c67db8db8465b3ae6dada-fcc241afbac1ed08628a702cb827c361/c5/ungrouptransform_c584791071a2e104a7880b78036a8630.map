{"version":3,"names":["_toConsumableArray","arr","Array","isArray","i","arr2","length","from","module","exports","Group","path","node","parent","childPath","getChild","capturing","hasAppropriateSiblings","type","parentPath","getParent","replace","expressions","concat","slice","index","previousNode","kind"],"sources":["ungroup-transform.js"],"sourcesContent":["/**\n * The MIT License (MIT)\n * Copyright (c) 2017-present Dmitry Soshnikov <dmitry.soshnikov@gmail.com>\n */\n\n'use strict';\n\n/**\n * A regexp-tree plugin to remove unnecessary groups.\n *\n * /(?:a)/ -> /a/\n */\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nmodule.exports = {\n  Group: function Group(path) {\n    var node = path.node,\n        parent = path.parent;\n\n    var childPath = path.getChild();\n\n    if (node.capturing || !childPath) {\n      return;\n    }\n\n    // Don't optimize \\1(?:0) to \\10\n    if (!hasAppropriateSiblings(path)) {\n      return;\n    }\n\n    // Don't optimize /a(?:b|c)/ to /ab|c/\n    // but /(?:b|c)/ to /b|c/ is ok\n    if (childPath.node.type === 'Disjunction' && parent.type !== 'RegExp') {\n      return;\n    }\n\n    // Don't optimize /(?:ab)+/ to /ab+/\n    // but /(?:a)+/ to /a+/ is ok\n    // and /(?:[a-d])+/ to /[a-d]+/ is ok too\n    if (parent.type === 'Repetition' && childPath.node.type !== 'Char' && childPath.node.type !== 'CharacterClass') {\n      return;\n    }\n\n    if (childPath.node.type === 'Alternative') {\n      var parentPath = path.getParent();\n      if (parentPath.node.type === 'Alternative') {\n        // /abc(?:def)ghi/ When (?:def) is ungrouped its content must be merged with parent alternative\n\n        parentPath.replace({\n          type: 'Alternative',\n          expressions: [].concat(_toConsumableArray(parent.expressions.slice(0, path.index)), _toConsumableArray(childPath.node.expressions), _toConsumableArray(parent.expressions.slice(path.index + 1)))\n        });\n      }\n    } else {\n      path.replace(childPath.node);\n    }\n  }\n};\n\nfunction hasAppropriateSiblings(path) {\n  var parent = path.parent,\n      index = path.index;\n\n\n  if (parent.type !== 'Alternative') {\n    return true;\n  }\n\n  var previousNode = parent.expressions[index - 1];\n  if (previousNode == null) {\n    return true;\n  }\n\n  // Don't optimized \\1(?:0) to \\10\n  if (previousNode.type === 'Backreference' && previousNode.kind === 'number') {\n    return false;\n  }\n\n  // Don't optimized \\2(?:0) to \\20\n  if (previousNode.type === 'Char' && previousNode.kind === 'decimal') {\n    return false;\n  }\n\n  return true;\n}"],"mappings":"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"}