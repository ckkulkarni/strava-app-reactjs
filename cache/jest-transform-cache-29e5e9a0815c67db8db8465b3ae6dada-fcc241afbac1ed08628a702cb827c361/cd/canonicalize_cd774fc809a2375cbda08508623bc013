54be4fb706b3de8df00a739eaabe325b
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = canonicalize;
var _has_property = _interopRequireDefault(require("./has_property"));
var _type = _interopRequireDefault(require("./type"));
function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : {
    default: obj
  };
}
function canonicalize(value, stack) {
  stack = stack || [];
  function withStack(fn) {
    stack.push(value);
    const result = fn();
    stack.pop();
    return result;
  }
  if (stack.indexOf(value) !== -1) {
    return '[Circular]';
  }
  switch ((0, _type.default)(value)) {
    case 'array':
      return withStack(function () {
        return value.map(function (item) {
          return canonicalize(item, stack);
        });
      });
    case 'function':
      if (!(0, _has_property.default)(value)) {
        return '[Function]';
      }
    /* falls through */
    case 'object':
      return withStack(function () {
        const canonicalizedObj = {};
        Object.keys(value).sort().map(function (key) {
          canonicalizedObj[key] = canonicalize(value[key], stack);
        });
        return canonicalizedObj;
      });
    case 'boolean':
    case 'buffer':
    case 'date':
    case 'null':
    case 'number':
    case 'regexp':
    case 'symbol':
    case 'undefined':
      return value;
    default:
      return value.toString();
  }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImV4cG9ydHMiLCJ2YWx1ZSIsImRlZmF1bHQiLCJjYW5vbmljYWxpemUiLCJfaGFzX3Byb3BlcnR5IiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInJlcXVpcmUiLCJfdHlwZSIsIm9iaiIsIl9fZXNNb2R1bGUiLCJzdGFjayIsIndpdGhTdGFjayIsImZuIiwicHVzaCIsInJlc3VsdCIsInBvcCIsImluZGV4T2YiLCJtYXAiLCJpdGVtIiwiY2Fub25pY2FsaXplZE9iaiIsImtleXMiLCJzb3J0Iiwia2V5IiwidG9TdHJpbmciXSwic291cmNlcyI6WyJjYW5vbmljYWxpemUuanMiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO2V4cG9ydHMuZGVmYXVsdCA9IGNhbm9uaWNhbGl6ZTt2YXIgX2hhc19wcm9wZXJ0eSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4vaGFzX3Byb3BlcnR5XCIpKTtcbnZhciBfdHlwZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4vdHlwZVwiKSk7ZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHtyZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTt9XG5cbmZ1bmN0aW9uIGNhbm9uaWNhbGl6ZSh2YWx1ZSwgc3RhY2spIHtcbiAgc3RhY2sgPSBzdGFjayB8fCBbXTtcblxuICBmdW5jdGlvbiB3aXRoU3RhY2soZm4pIHtcbiAgICBzdGFjay5wdXNoKHZhbHVlKTtcbiAgICBjb25zdCByZXN1bHQgPSBmbigpO1xuICAgIHN0YWNrLnBvcCgpO1xuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICBpZiAoc3RhY2suaW5kZXhPZih2YWx1ZSkgIT09IC0xKSB7XG4gICAgcmV0dXJuICdbQ2lyY3VsYXJdJztcbiAgfVxuXG4gIHN3aXRjaCAoKDAsIF90eXBlLmRlZmF1bHQpKHZhbHVlKSkge1xuICAgIGNhc2UgJ2FycmF5JzpcbiAgICAgIHJldHVybiB3aXRoU3RhY2soZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdmFsdWUubWFwKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgcmV0dXJuIGNhbm9uaWNhbGl6ZShpdGVtLCBzdGFjayk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgY2FzZSAnZnVuY3Rpb24nOlxuICAgICAgaWYgKCEoMCwgX2hhc19wcm9wZXJ0eS5kZWZhdWx0KSh2YWx1ZSkpIHtcbiAgICAgICAgcmV0dXJuICdbRnVuY3Rpb25dJztcbiAgICAgIH1cbiAgICAvKiBmYWxscyB0aHJvdWdoICovXG4gICAgY2FzZSAnb2JqZWN0JzpcbiAgICAgIHJldHVybiB3aXRoU3RhY2soZnVuY3Rpb24gKCkge1xuICAgICAgICBjb25zdCBjYW5vbmljYWxpemVkT2JqID0ge307XG4gICAgICAgIE9iamVjdC5rZXlzKHZhbHVlKS5cbiAgICAgICAgc29ydCgpLlxuICAgICAgICBtYXAoZnVuY3Rpb24gKGtleSkge1xuICAgICAgICAgIGNhbm9uaWNhbGl6ZWRPYmpba2V5XSA9IGNhbm9uaWNhbGl6ZSh2YWx1ZVtrZXldLCBzdGFjayk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gY2Fub25pY2FsaXplZE9iajtcbiAgICAgIH0pO1xuICAgIGNhc2UgJ2Jvb2xlYW4nOlxuICAgIGNhc2UgJ2J1ZmZlcic6XG4gICAgY2FzZSAnZGF0ZSc6XG4gICAgY2FzZSAnbnVsbCc6XG4gICAgY2FzZSAnbnVtYmVyJzpcbiAgICBjYXNlICdyZWdleHAnOlxuICAgIGNhc2UgJ3N5bWJvbCc6XG4gICAgY2FzZSAndW5kZWZpbmVkJzpcbiAgICAgIHJldHVybiB2YWx1ZTtcbiAgICBkZWZhdWx0OlxuICAgICAgcmV0dXJuIHZhbHVlLnRvU3RyaW5n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