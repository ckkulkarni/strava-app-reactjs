{"version":3,"names":["debug","require","utils","tableLayout","Table","Array","constructor","opts","options","mergeOptions","Object","defineProperty","value","enumerable","setDebugLevel","WARN","parseInt","warn","get","debugMessages","toString","array","headersPresent","head","length","push","apply","style","cells","makeTableLayout","forEach","row","cell","mergeTableOptions","computeWidths","colWidths","computeHeights","rowHeights","init","result","rowIndex","heightOfRow","compact","doDraw","lineNum","join","width","str","split","reset","line","draw","module","exports"],"sources":["table.js"],"sourcesContent":["const debug = require('./debug');\nconst utils = require('./utils');\nconst tableLayout = require('./layout-manager');\n\nclass Table extends Array {\n  constructor(opts) {\n    super();\n\n    const options = utils.mergeOptions(opts);\n    Object.defineProperty(this, 'options', {\n      value: options,\n      enumerable: options.debug,\n    });\n\n    if (options.debug) {\n      switch (typeof options.debug) {\n        case 'boolean':\n          debug.setDebugLevel(debug.WARN);\n          break;\n        case 'number':\n          debug.setDebugLevel(options.debug);\n          break;\n        case 'string':\n          debug.setDebugLevel(parseInt(options.debug, 10));\n          break;\n        default:\n          debug.setDebugLevel(debug.WARN);\n          debug.warn(`Debug option is expected to be boolean, number, or string. Received a ${typeof options.debug}`);\n      }\n      Object.defineProperty(this, 'messages', {\n        get() {\n          return debug.debugMessages();\n        },\n      });\n    }\n  }\n\n  toString() {\n    let array = this;\n    let headersPresent = this.options.head && this.options.head.length;\n    if (headersPresent) {\n      array = [this.options.head];\n      if (this.length) {\n        array.push.apply(array, this);\n      }\n    } else {\n      this.options.style.head = [];\n    }\n\n    let cells = tableLayout.makeTableLayout(array);\n\n    cells.forEach(function (row) {\n      row.forEach(function (cell) {\n        cell.mergeTableOptions(this.options, cells);\n      }, this);\n    }, this);\n\n    tableLayout.computeWidths(this.options.colWidths, cells);\n    tableLayout.computeHeights(this.options.rowHeights, cells);\n\n    cells.forEach(function (row) {\n      row.forEach(function (cell) {\n        cell.init(this.options);\n      }, this);\n    }, this);\n\n    let result = [];\n\n    for (let rowIndex = 0; rowIndex < cells.length; rowIndex++) {\n      let row = cells[rowIndex];\n      let heightOfRow = this.options.rowHeights[rowIndex];\n\n      if (rowIndex === 0 || !this.options.style.compact || (rowIndex == 1 && headersPresent)) {\n        doDraw(row, 'top', result);\n      }\n\n      for (let lineNum = 0; lineNum < heightOfRow; lineNum++) {\n        doDraw(row, lineNum, result);\n      }\n\n      if (rowIndex + 1 == cells.length) {\n        doDraw(row, 'bottom', result);\n      }\n    }\n\n    return result.join('\\n');\n  }\n\n  get width() {\n    let str = this.toString().split('\\n');\n    return str[0].length;\n  }\n}\n\nTable.reset = () => debug.reset();\n\nfunction doDraw(row, lineNum, result) {\n  let line = [];\n  row.forEach(function (cell) {\n    line.push(cell.draw(lineNum));\n  });\n  let str = line.join('');\n  if (str.length) result.push(str);\n}\n\nmodule.exports = Table;\n"],"mappings":"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"}