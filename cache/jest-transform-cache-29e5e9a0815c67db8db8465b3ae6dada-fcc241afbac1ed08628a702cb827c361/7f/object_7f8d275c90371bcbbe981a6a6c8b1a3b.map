{"version":3,"names":["Object","defineProperty","exports","value","create","default","_has","_interopRequireDefault","require","_snakeCase","_camelCase","_mapKeys","_mapValues","_propertyExpr","_locale","_sortFields","_sortByKeyOrder","_runTests","_ValidationError","_schema","obj","__esModule","_extends","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","apply","isObject","toString","unknown","ctx","known","keys","fields","filter","indexOf","defaultSort","ObjectSchema","constructor","spec","type","_sortErrors","_nodes","_excludedEdges","withMutation","transform","coerce","JSON","parse","err","isType","shape","_typeCheck","_cast","_value","options","_options$stripUnknown","undefined","getDefault","strip","stripUnknown","noUnknown","props","concat","v","intermediateValue","innerOptions","parent","__validating","isChanged","prop","field","exists","fieldValue","inputValue","path","resolve","context","fieldSpec","strict","cast","_validate","opts","callback","errors","sync","from","originalValue","abortEarly","recursive","schema","isError","push","tests","map","_","cb","validate","endEarly","sort","clone","next","nextFields","schemaOrRef","entries","getDefaultFromShape","dft","forEach","_getDefault","additions","excludes","Array","isArray","pick","picked","omit","to","alias","fromGetter","getter","newObj","noAllow","message","object","test","name","exclusive","unknownKeys","createError","params","join","allow","transformKeys","fn","camelCase","snakeCase","constantCase","toUpperCase","describe","base"],"sources":["object.js"],"sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.create = create;\nexports.default = void 0;\n\nvar _has = _interopRequireDefault(require(\"lodash/has\"));\n\nvar _snakeCase = _interopRequireDefault(require(\"lodash/snakeCase\"));\n\nvar _camelCase = _interopRequireDefault(require(\"lodash/camelCase\"));\n\nvar _mapKeys = _interopRequireDefault(require(\"lodash/mapKeys\"));\n\nvar _mapValues = _interopRequireDefault(require(\"lodash/mapValues\"));\n\nvar _propertyExpr = require(\"property-expr\");\n\nvar _locale = require(\"./locale\");\n\nvar _sortFields = _interopRequireDefault(require(\"./util/sortFields\"));\n\nvar _sortByKeyOrder = _interopRequireDefault(require(\"./util/sortByKeyOrder\"));\n\nvar _runTests = _interopRequireDefault(require(\"./util/runTests\"));\n\nvar _ValidationError = _interopRequireDefault(require(\"./ValidationError\"));\n\nvar _schema = _interopRequireDefault(require(\"./schema\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nlet isObject = obj => Object.prototype.toString.call(obj) === '[object Object]';\n\nfunction unknown(ctx, value) {\n  let known = Object.keys(ctx.fields);\n  return Object.keys(value).filter(key => known.indexOf(key) === -1);\n}\n\nconst defaultSort = (0, _sortByKeyOrder.default)([]);\n\nclass ObjectSchema extends _schema.default {\n  constructor(spec) {\n    super({\n      type: 'object'\n    });\n    this.fields = Object.create(null);\n    this._sortErrors = defaultSort;\n    this._nodes = [];\n    this._excludedEdges = [];\n    this.withMutation(() => {\n      this.transform(function coerce(value) {\n        if (typeof value === 'string') {\n          try {\n            value = JSON.parse(value);\n          } catch (err) {\n            value = null;\n          }\n        }\n\n        if (this.isType(value)) return value;\n        return null;\n      });\n\n      if (spec) {\n        this.shape(spec);\n      }\n    });\n  }\n\n  _typeCheck(value) {\n    return isObject(value) || typeof value === 'function';\n  }\n\n  _cast(_value, options = {}) {\n    var _options$stripUnknown;\n\n    let value = super._cast(_value, options); //should ignore nulls here\n\n\n    if (value === undefined) return this.getDefault();\n    if (!this._typeCheck(value)) return value;\n    let fields = this.fields;\n    let strip = (_options$stripUnknown = options.stripUnknown) != null ? _options$stripUnknown : this.spec.noUnknown;\n\n    let props = this._nodes.concat(Object.keys(value).filter(v => this._nodes.indexOf(v) === -1));\n\n    let intermediateValue = {}; // is filled during the transform below\n\n    let innerOptions = _extends({}, options, {\n      parent: intermediateValue,\n      __validating: options.__validating || false\n    });\n\n    let isChanged = false;\n\n    for (const prop of props) {\n      let field = fields[prop];\n      let exists = (0, _has.default)(value, prop);\n\n      if (field) {\n        let fieldValue;\n        let inputValue = value[prop]; // safe to mutate since this is fired in sequence\n\n        innerOptions.path = (options.path ? `${options.path}.` : '') + prop; // innerOptions.value = value[prop];\n\n        field = field.resolve({\n          value: inputValue,\n          context: options.context,\n          parent: intermediateValue\n        });\n        let fieldSpec = 'spec' in field ? field.spec : undefined;\n        let strict = fieldSpec == null ? void 0 : fieldSpec.strict;\n\n        if (fieldSpec == null ? void 0 : fieldSpec.strip) {\n          isChanged = isChanged || prop in value;\n          continue;\n        }\n\n        fieldValue = !options.__validating || !strict ? // TODO: use _cast, this is double resolving\n        field.cast(value[prop], innerOptions) : value[prop];\n\n        if (fieldValue !== undefined) {\n          intermediateValue[prop] = fieldValue;\n        }\n      } else if (exists && !strip) {\n        intermediateValue[prop] = value[prop];\n      }\n\n      if (intermediateValue[prop] !== value[prop]) {\n        isChanged = true;\n      }\n    }\n\n    return isChanged ? intermediateValue : value;\n  }\n\n  _validate(_value, opts = {}, callback) {\n    let errors = [];\n    let {\n      sync,\n      from = [],\n      originalValue = _value,\n      abortEarly = this.spec.abortEarly,\n      recursive = this.spec.recursive\n    } = opts;\n    from = [{\n      schema: this,\n      value: originalValue\n    }, ...from]; // this flag is needed for handling `strict` correctly in the context of\n    // validation vs just casting. e.g strict() on a field is only used when validating\n\n    opts.__validating = true;\n    opts.originalValue = originalValue;\n    opts.from = from;\n\n    super._validate(_value, opts, (err, value) => {\n      if (err) {\n        if (!_ValidationError.default.isError(err) || abortEarly) {\n          return void callback(err, value);\n        }\n\n        errors.push(err);\n      }\n\n      if (!recursive || !isObject(value)) {\n        callback(errors[0] || null, value);\n        return;\n      }\n\n      originalValue = originalValue || value;\n\n      let tests = this._nodes.map(key => (_, cb) => {\n        let path = key.indexOf('.') === -1 ? (opts.path ? `${opts.path}.` : '') + key : `${opts.path || ''}[\"${key}\"]`;\n        let field = this.fields[key];\n\n        if (field && 'validate' in field) {\n          field.validate(value[key], _extends({}, opts, {\n            // @ts-ignore\n            path,\n            from,\n            // inner fields are always strict:\n            // 1. this isn't strict so the casting will also have cast inner values\n            // 2. this is strict in which case the nested values weren't cast either\n            strict: true,\n            parent: value,\n            originalValue: originalValue[key]\n          }), cb);\n          return;\n        }\n\n        cb(null);\n      });\n\n      (0, _runTests.default)({\n        sync,\n        tests,\n        value,\n        errors,\n        endEarly: abortEarly,\n        sort: this._sortErrors,\n        path: opts.path\n      }, callback);\n    });\n  }\n\n  clone(spec) {\n    const next = super.clone(spec);\n    next.fields = _extends({}, this.fields);\n    next._nodes = this._nodes;\n    next._excludedEdges = this._excludedEdges;\n    next._sortErrors = this._sortErrors;\n    return next;\n  }\n\n  concat(schema) {\n    let next = super.concat(schema);\n    let nextFields = next.fields;\n\n    for (let [field, schemaOrRef] of Object.entries(this.fields)) {\n      const target = nextFields[field];\n\n      if (target === undefined) {\n        nextFields[field] = schemaOrRef;\n      } else if (target instanceof _schema.default && schemaOrRef instanceof _schema.default) {\n        nextFields[field] = schemaOrRef.concat(target);\n      }\n    }\n\n    return next.withMutation(() => next.shape(nextFields, this._excludedEdges));\n  }\n\n  getDefaultFromShape() {\n    let dft = {};\n\n    this._nodes.forEach(key => {\n      const field = this.fields[key];\n      dft[key] = 'default' in field ? field.getDefault() : undefined;\n    });\n\n    return dft;\n  }\n\n  _getDefault() {\n    if ('default' in this.spec) {\n      return super._getDefault();\n    } // if there is no default set invent one\n\n\n    if (!this._nodes.length) {\n      return undefined;\n    }\n\n    return this.getDefaultFromShape();\n  }\n\n  shape(additions, excludes = []) {\n    let next = this.clone();\n    let fields = Object.assign(next.fields, additions);\n    next.fields = fields;\n    next._sortErrors = (0, _sortByKeyOrder.default)(Object.keys(fields));\n\n    if (excludes.length) {\n      // this is a convenience for when users only supply a single pair\n      if (!Array.isArray(excludes[0])) excludes = [excludes];\n      next._excludedEdges = [...next._excludedEdges, ...excludes];\n    }\n\n    next._nodes = (0, _sortFields.default)(fields, next._excludedEdges);\n    return next;\n  }\n\n  pick(keys) {\n    const picked = {};\n\n    for (const key of keys) {\n      if (this.fields[key]) picked[key] = this.fields[key];\n    }\n\n    return this.clone().withMutation(next => {\n      next.fields = {};\n      return next.shape(picked);\n    });\n  }\n\n  omit(keys) {\n    const next = this.clone();\n    const fields = next.fields;\n    next.fields = {};\n\n    for (const key of keys) {\n      delete fields[key];\n    }\n\n    return next.withMutation(() => next.shape(fields));\n  }\n\n  from(from, to, alias) {\n    let fromGetter = (0, _propertyExpr.getter)(from, true);\n    return this.transform(obj => {\n      if (obj == null) return obj;\n      let newObj = obj;\n\n      if ((0, _has.default)(obj, from)) {\n        newObj = _extends({}, obj);\n        if (!alias) delete newObj[from];\n        newObj[to] = fromGetter(obj);\n      }\n\n      return newObj;\n    });\n  }\n\n  noUnknown(noAllow = true, message = _locale.object.noUnknown) {\n    if (typeof noAllow === 'string') {\n      message = noAllow;\n      noAllow = true;\n    }\n\n    let next = this.test({\n      name: 'noUnknown',\n      exclusive: true,\n      message: message,\n\n      test(value) {\n        if (value == null) return true;\n        const unknownKeys = unknown(this.schema, value);\n        return !noAllow || unknownKeys.length === 0 || this.createError({\n          params: {\n            unknown: unknownKeys.join(', ')\n          }\n        });\n      }\n\n    });\n    next.spec.noUnknown = noAllow;\n    return next;\n  }\n\n  unknown(allow = true, message = _locale.object.noUnknown) {\n    return this.noUnknown(!allow, message);\n  }\n\n  transformKeys(fn) {\n    return this.transform(obj => obj && (0, _mapKeys.default)(obj, (_, key) => fn(key)));\n  }\n\n  camelCase() {\n    return this.transformKeys(_camelCase.default);\n  }\n\n  snakeCase() {\n    return this.transformKeys(_snakeCase.default);\n  }\n\n  constantCase() {\n    return this.transformKeys(key => (0, _snakeCase.default)(key).toUpperCase());\n  }\n\n  describe() {\n    let base = super.describe();\n    base.fields = (0, _mapValues.default)(this.fields, value => value.describe());\n    return base;\n  }\n\n}\n\nexports.default = ObjectSchema;\n\nfunction create(spec) {\n  return new ObjectSchema(spec);\n}\n\ncreate.prototype = ObjectSchema.prototype;"],"mappings":"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"}