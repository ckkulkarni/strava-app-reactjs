{"version":3,"names":["Node","require","Pair","YAMLMap","YAMLSet","constructor","schema","tag","add","key","pair","isPair","value","prev","findPair","items","push","get","keepPair","isScalar","set","Error","splice","indexOf","toJSON","_","ctx","Set","toString","onComment","onChompKeep","JSON","stringify","hasAllNullValues","Object","assign","allNullValues","collection","identify","nodeClass","default","resolve","map","onError","isMap","createNode","iterable","replacer","Symbol","iterator","call","createPair","exports"],"sources":["set.js"],"sourcesContent":["'use strict';\n\nvar Node = require('../../nodes/Node.js');\nvar Pair = require('../../nodes/Pair.js');\nvar YAMLMap = require('../../nodes/YAMLMap.js');\n\nclass YAMLSet extends YAMLMap.YAMLMap {\n    constructor(schema) {\n        super(schema);\n        this.tag = YAMLSet.tag;\n    }\n    add(key) {\n        let pair;\n        if (Node.isPair(key))\n            pair = key;\n        else if (key &&\n            typeof key === 'object' &&\n            'key' in key &&\n            'value' in key &&\n            key.value === null)\n            pair = new Pair.Pair(key.key, null);\n        else\n            pair = new Pair.Pair(key, null);\n        const prev = YAMLMap.findPair(this.items, pair.key);\n        if (!prev)\n            this.items.push(pair);\n    }\n    /**\n     * If `keepPair` is `true`, returns the Pair matching `key`.\n     * Otherwise, returns the value of that Pair's key.\n     */\n    get(key, keepPair) {\n        const pair = YAMLMap.findPair(this.items, key);\n        return !keepPair && Node.isPair(pair)\n            ? Node.isScalar(pair.key)\n                ? pair.key.value\n                : pair.key\n            : pair;\n    }\n    set(key, value) {\n        if (typeof value !== 'boolean')\n            throw new Error(`Expected boolean value for set(key, value) in a YAML set, not ${typeof value}`);\n        const prev = YAMLMap.findPair(this.items, key);\n        if (prev && !value) {\n            this.items.splice(this.items.indexOf(prev), 1);\n        }\n        else if (!prev && value) {\n            this.items.push(new Pair.Pair(key));\n        }\n    }\n    toJSON(_, ctx) {\n        return super.toJSON(_, ctx, Set);\n    }\n    toString(ctx, onComment, onChompKeep) {\n        if (!ctx)\n            return JSON.stringify(this);\n        if (this.hasAllNullValues(true))\n            return super.toString(Object.assign({}, ctx, { allNullValues: true }), onComment, onChompKeep);\n        else\n            throw new Error('Set items must all have null values');\n    }\n}\nYAMLSet.tag = 'tag:yaml.org,2002:set';\nconst set = {\n    collection: 'map',\n    identify: value => value instanceof Set,\n    nodeClass: YAMLSet,\n    default: false,\n    tag: 'tag:yaml.org,2002:set',\n    resolve(map, onError) {\n        if (Node.isMap(map)) {\n            if (map.hasAllNullValues(true))\n                return Object.assign(new YAMLSet(), map);\n            else\n                onError('Set items must all have null values');\n        }\n        else\n            onError('Expected a mapping for this tag');\n        return map;\n    },\n    createNode(schema, iterable, ctx) {\n        const { replacer } = ctx;\n        const set = new YAMLSet(schema);\n        if (iterable && Symbol.iterator in Object(iterable))\n            for (let value of iterable) {\n                if (typeof replacer === 'function')\n                    value = replacer.call(iterable, value, value);\n                set.items.push(Pair.createPair(value, null, ctx));\n            }\n        return set;\n    }\n};\n\nexports.YAMLSet = YAMLSet;\nexports.set = set;\n"],"mappings":"AAAA,YAAY;;AAEZ,IAAIA,IAAI,GAAGC,OAAO,CAAC,qBAAqB,CAAC;AACzC,IAAIC,IAAI,GAAGD,OAAO,CAAC,qBAAqB,CAAC;AACzC,IAAIE,OAAO,GAAGF,OAAO,CAAC,wBAAwB,CAAC;AAE/C,MAAMG,OAAO,SAASD,OAAO,CAACA,OAAO,CAAC;EAClCE,WAAWA,CAACC,MAAM,EAAE;IAChB,KAAK,CAACA,MAAM,CAAC;IACb,IAAI,CAACC,GAAG,GAAGH,OAAO,CAACG,GAAG;EAC1B;EACAC,GAAGA,CAACC,GAAG,EAAE;IACL,IAAIC,IAAI;IACR,IAAIV,IAAI,CAACW,MAAM,CAACF,GAAG,CAAC,EAChBC,IAAI,GAAGD,GAAG,CAAC,KACV,IAAIA,GAAG,IACR,OAAOA,GAAG,KAAK,QAAQ,IACvB,KAAK,IAAIA,GAAG,IACZ,OAAO,IAAIA,GAAG,IACdA,GAAG,CAACG,KAAK,KAAK,IAAI,EAClBF,IAAI,GAAG,IAAIR,IAAI,CAACA,IAAI,CAACO,GAAG,CAACA,GAAG,EAAE,IAAI,CAAC,CAAC,KAEpCC,IAAI,GAAG,IAAIR,IAAI,CAACA,IAAI,CAACO,GAAG,EAAE,IAAI,CAAC;IACnC,MAAMI,IAAI,GAAGV,OAAO,CAACW,QAAQ,CAAC,IAAI,CAACC,KAAK,EAAEL,IAAI,CAACD,GAAG,CAAC;IACnD,IAAI,CAACI,IAAI,EACL,IAAI,CAACE,KAAK,CAACC,IAAI,CAACN,IAAI,CAAC;EAC7B;EACA;AACJ;AACA;AACA;EACIO,GAAGA,CAACR,GAAG,EAAES,QAAQ,EAAE;IACf,MAAMR,IAAI,GAAGP,OAAO,CAACW,QAAQ,CAAC,IAAI,CAACC,KAAK,EAAEN,GAAG,CAAC;IAC9C,OAAO,CAACS,QAAQ,IAAIlB,IAAI,CAACW,MAAM,CAACD,IAAI,CAAC,GAC/BV,IAAI,CAACmB,QAAQ,CAACT,IAAI,CAACD,GAAG,CAAC,GACnBC,IAAI,CAACD,GAAG,CAACG,KAAK,GACdF,IAAI,CAACD,GAAG,GACZC,IAAI;EACd;EACAU,GAAGA,CAACX,GAAG,EAAEG,KAAK,EAAE;IACZ,IAAI,OAAOA,KAAK,KAAK,SAAS,EAC1B,MAAM,IAAIS,KAAK,CAAE,iEAAgE,OAAOT,KAAM,EAAC,CAAC;IACpG,MAAMC,IAAI,GAAGV,OAAO,CAACW,QAAQ,CAAC,IAAI,CAACC,KAAK,EAAEN,GAAG,CAAC;IAC9C,IAAII,IAAI,IAAI,CAACD,KAAK,EAAE;MAChB,IAAI,CAACG,KAAK,CAACO,MAAM,CAAC,IAAI,CAACP,KAAK,CAACQ,OAAO,CAACV,IAAI,CAAC,EAAE,CAAC,CAAC;IAClD,CAAC,MACI,IAAI,CAACA,IAAI,IAAID,KAAK,EAAE;MACrB,IAAI,CAACG,KAAK,CAACC,IAAI,CAAC,IAAId,IAAI,CAACA,IAAI,CAACO,GAAG,CAAC,CAAC;IACvC;EACJ;EACAe,MAAMA,CAACC,CAAC,EAAEC,GAAG,EAAE;IACX,OAAO,KAAK,CAACF,MAAM,CAACC,CAAC,EAAEC,GAAG,EAAEC,GAAG,CAAC;EACpC;EACAC,QAAQA,CAACF,GAAG,EAAEG,SAAS,EAAEC,WAAW,EAAE;IAClC,IAAI,CAACJ,GAAG,EACJ,OAAOK,IAAI,CAACC,SAAS,CAAC,IAAI,CAAC;IAC/B,IAAI,IAAI,CAACC,gBAAgB,CAAC,IAAI,CAAC,EAC3B,OAAO,KAAK,CAACL,QAAQ,CAACM,MAAM,CAACC,MAAM,CAAC,CAAC,CAAC,EAAET,GAAG,EAAE;MAAEU,aAAa,EAAE;IAAK,CAAC,CAAC,EAAEP,SAAS,EAAEC,WAAW,CAAC,CAAC,KAE/F,MAAM,IAAIT,KAAK,CAAC,qCAAqC,CAAC;EAC9D;AACJ;AACAjB,OAAO,CAACG,GAAG,GAAG,uBAAuB;AACrC,MAAMa,GAAG,GAAG;EACRiB,UAAU,EAAE,KAAK;EACjBC,QAAQ,EAAE1B,KAAK,IAAIA,KAAK,YAAYe,GAAG;EACvCY,SAAS,EAAEnC,OAAO;EAClBoC,OAAO,EAAE,KAAK;EACdjC,GAAG,EAAE,uBAAuB;EAC5BkC,OAAOA,CAACC,GAAG,EAAEC,OAAO,EAAE;IAClB,IAAI3C,IAAI,CAAC4C,KAAK,CAACF,GAAG,CAAC,EAAE;MACjB,IAAIA,GAAG,CAACT,gBAAgB,CAAC,IAAI,CAAC,EAC1B,OAAOC,MAAM,CAACC,MAAM,CAAC,IAAI/B,OAAO,EAAE,EAAEsC,GAAG,CAAC,CAAC,KAEzCC,OAAO,CAAC,qCAAqC,CAAC;IACtD,CAAC,MAEGA,OAAO,CAAC,iCAAiC,CAAC;IAC9C,OAAOD,GAAG;EACd,CAAC;EACDG,UAAUA,CAACvC,MAAM,EAAEwC,QAAQ,EAAEpB,GAAG,EAAE;IAC9B,MAAM;MAAEqB;IAAS,CAAC,GAAGrB,GAAG;IACxB,MAAMN,GAAG,GAAG,IAAIhB,OAAO,CAACE,MAAM,CAAC;IAC/B,IAAIwC,QAAQ,IAAIE,MAAM,CAACC,QAAQ,IAAIf,MAAM,CAACY,QAAQ,CAAC,EAC/C,KAAK,IAAIlC,KAAK,IAAIkC,QAAQ,EAAE;MACxB,IAAI,OAAOC,QAAQ,KAAK,UAAU,EAC9BnC,KAAK,GAAGmC,QAAQ,CAACG,IAAI,CAACJ,QAAQ,EAAElC,KAAK,EAAEA,KAAK,CAAC;MACjDQ,GAAG,CAACL,KAAK,CAACC,IAAI,CAACd,IAAI,CAACiD,UAAU,CAACvC,KAAK,EAAE,IAAI,EAAEc,GAAG,CAAC,CAAC;IACrD;IACJ,OAAON,GAAG;EACd;AACJ,CAAC;AAEDgC,OAAO,CAAChD,OAAO,GAAGA,OAAO;AACzBgD,OAAO,CAAChC,GAAG,GAAGA,GAAG"}