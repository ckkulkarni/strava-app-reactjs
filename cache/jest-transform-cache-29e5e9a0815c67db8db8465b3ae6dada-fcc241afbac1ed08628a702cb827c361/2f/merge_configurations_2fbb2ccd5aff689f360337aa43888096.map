{"version":3,"names":["lodash_mergewith_1","__importDefault","require","ADDITIVE_ARRAYS","TAG_EXPRESSIONS","mergeArrays","objValue","srcValue","concat","undefined","mergeTagExpressions","wrapTagExpression","raw","startsWith","endsWith","customizer","key","includes","mergeConfigurations","source","configurations","default","exports"],"sources":["../../src/configuration/merge_configurations.ts"],"sourcesContent":["import { IConfiguration } from './types'\nimport mergeWith from 'lodash.mergewith'\n\nconst ADDITIVE_ARRAYS = [\n  'format',\n  'import',\n  'name',\n  'paths',\n  'require',\n  'requireModule',\n]\nconst TAG_EXPRESSIONS = ['tags', 'retryTagFilter']\n\nfunction mergeArrays(objValue: any[], srcValue: any[]) {\n  if (objValue && srcValue) {\n    return [].concat(objValue, srcValue)\n  }\n  return undefined\n}\n\nfunction mergeTagExpressions(objValue: string, srcValue: string) {\n  if (objValue && srcValue) {\n    return `${wrapTagExpression(objValue)} and ${wrapTagExpression(srcValue)}`\n  }\n  return undefined\n}\n\nfunction wrapTagExpression(raw: string) {\n  if (raw.startsWith('(') && raw.endsWith(')')) {\n    return raw\n  }\n  return `(${raw})`\n}\n\nfunction customizer(objValue: any, srcValue: any, key: string): any {\n  if (ADDITIVE_ARRAYS.includes(key)) {\n    return mergeArrays(objValue, srcValue)\n  }\n  if (TAG_EXPRESSIONS.includes(key)) {\n    return mergeTagExpressions(objValue, srcValue)\n  }\n  return undefined\n}\n\nexport function mergeConfigurations<T = Partial<IConfiguration>>(\n  source: T,\n  ...configurations: Partial<IConfiguration>[]\n): T {\n  return mergeWith({}, source, ...configurations, customizer)\n}\n"],"mappings":";;;;;;;;;;;AACA,MAAAA,kBAAA,GAAAC,eAAA,CAAAC,OAAA;AAEA,MAAMC,eAAe,GAAG,CACtB,QAAQ,EACR,QAAQ,EACR,MAAM,EACN,OAAO,EACP,SAAS,EACT,eAAe,CAChB;AACD,MAAMC,eAAe,GAAG,CAAC,MAAM,EAAE,gBAAgB,CAAC;AAElD,SAASC,WAAWA,CAACC,QAAe,EAAEC,QAAe;EACnD,IAAID,QAAQ,IAAIC,QAAQ,EAAE;IACxB,OAAO,EAAE,CAACC,MAAM,CAACF,QAAQ,EAAEC,QAAQ,CAAC;;EAEtC,OAAOE,SAAS;AAClB;AAEA,SAASC,mBAAmBA,CAACJ,QAAgB,EAAEC,QAAgB;EAC7D,IAAID,QAAQ,IAAIC,QAAQ,EAAE;IACxB,OAAO,GAAGI,iBAAiB,CAACL,QAAQ,CAAC,QAAQK,iBAAiB,CAACJ,QAAQ,CAAC,EAAE;;EAE5E,OAAOE,SAAS;AAClB;AAEA,SAASE,iBAAiBA,CAACC,GAAW;EACpC,IAAIA,GAAG,CAACC,UAAU,CAAC,GAAG,CAAC,IAAID,GAAG,CAACE,QAAQ,CAAC,GAAG,CAAC,EAAE;IAC5C,OAAOF,GAAG;;EAEZ,OAAO,IAAIA,GAAG,GAAG;AACnB;AAEA,SAASG,UAAUA,CAACT,QAAa,EAAEC,QAAa,EAAES,GAAW;EAC3D,IAAIb,eAAe,CAACc,QAAQ,CAACD,GAAG,CAAC,EAAE;IACjC,OAAOX,WAAW,CAACC,QAAQ,EAAEC,QAAQ,CAAC;;EAExC,IAAIH,eAAe,CAACa,QAAQ,CAACD,GAAG,CAAC,EAAE;IACjC,OAAON,mBAAmB,CAACJ,QAAQ,EAAEC,QAAQ,CAAC;;EAEhD,OAAOE,SAAS;AAClB;AAEA,SAAgBS,mBAAmBA,CACjCC,MAAS,EACT,GAAGC,cAAyC;EAE5C,OAAO,IAAApB,kBAAA,CAAAqB,OAAS,EAAC,EAAE,EAAEF,MAAM,EAAE,GAAGC,cAAc,EAAEL,UAAU,CAAC;AAC7D;AALAO,OAAA,CAAAJ,mBAAA,GAAAA,mBAAA"}