7f90893b8db2fdfdae13becee3ac26bd
'use strict';

function resolveEnd(end, offset, reqSpace, onError) {
  let comment = '';
  if (end) {
    let hasSpace = false;
    let sep = '';
    for (const token of end) {
      const {
        source,
        type
      } = token;
      switch (type) {
        case 'space':
          hasSpace = true;
          break;
        case 'comment':
          {
            if (reqSpace && !hasSpace) onError(token, 'MISSING_CHAR', 'Comments must be separated from other tokens by white space characters');
            const cb = source.substring(1) || ' ';
            if (!comment) comment = cb;else comment += sep + cb;
            sep = '';
            break;
          }
        case 'newline':
          if (comment) sep += source;
          hasSpace = true;
          break;
        default:
          onError(token, 'UNEXPECTED_TOKEN', `Unexpected ${type} at node end`);
      }
      offset += source.length;
    }
  }
  return {
    comment,
    offset
  };
}
exports.resolveEnd = resolveEnd;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJyZXNvbHZlRW5kIiwiZW5kIiwib2Zmc2V0IiwicmVxU3BhY2UiLCJvbkVycm9yIiwiY29tbWVudCIsImhhc1NwYWNlIiwic2VwIiwidG9rZW4iLCJzb3VyY2UiLCJ0eXBlIiwiY2IiLCJzdWJzdHJpbmciLCJsZW5ndGgiLCJleHBvcnRzIl0sInNvdXJjZXMiOlsicmVzb2x2ZS1lbmQuanMiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG5mdW5jdGlvbiByZXNvbHZlRW5kKGVuZCwgb2Zmc2V0LCByZXFTcGFjZSwgb25FcnJvcikge1xuICAgIGxldCBjb21tZW50ID0gJyc7XG4gICAgaWYgKGVuZCkge1xuICAgICAgICBsZXQgaGFzU3BhY2UgPSBmYWxzZTtcbiAgICAgICAgbGV0IHNlcCA9ICcnO1xuICAgICAgICBmb3IgKGNvbnN0IHRva2VuIG9mIGVuZCkge1xuICAgICAgICAgICAgY29uc3QgeyBzb3VyY2UsIHR5cGUgfSA9IHRva2VuO1xuICAgICAgICAgICAgc3dpdGNoICh0eXBlKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAnc3BhY2UnOlxuICAgICAgICAgICAgICAgICAgICBoYXNTcGFjZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ2NvbW1lbnQnOiB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXFTcGFjZSAmJiAhaGFzU3BhY2UpXG4gICAgICAgICAgICAgICAgICAgICAgICBvbkVycm9yKHRva2VuLCAnTUlTU0lOR19DSEFSJywgJ0NvbW1lbnRzIG11c3QgYmUgc2VwYXJhdGVkIGZyb20gb3RoZXIgdG9rZW5zIGJ5IHdoaXRlIHNwYWNlIGNoYXJhY3RlcnMnKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY2IgPSBzb3VyY2Uuc3Vic3RyaW5nKDEpIHx8ICcgJztcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFjb21tZW50KVxuICAgICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9IGNiO1xuICAgICAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICBjb21tZW50ICs9IHNlcCArIGNiO1xuICAgICAgICAgICAgICAgICAgICBzZXAgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhc2UgJ25ld2xpbmUnOlxuICAgICAgICAgICAgICAgICAgICBpZiAoY29tbWVudClcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlcCArPSBzb3VyY2U7XG4gICAgICAgICAgICAgICAgICAgIGhhc1NwYWNlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgb25FcnJvcih0b2tlbiwgJ1VORVhQRUNURURfVE9LRU4nLCBgVW5leHBlY3RlZCAke3R5cGV9IGF0IG5vZGUgZW5kYCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBvZmZzZXQgKz0gc291cmNlLmxlbmd0aDtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4geyBjb21tZW50LCBvZmZzZXQgfTtcbn1cblxuZXhwb3J0cy5yZXNvbHZlRW5kID0gcmVzb2x2ZUVuZDtcbiJdLCJtYXBwaW5ncyI6IkFBQUEsWUFBWTs7QUFFWixTQUFTQSxVQUFVQSxDQUFDQyxHQUFHLEVBQUVDLE1BQU0sRUFBRUMsUUFBUSxFQUFFQyxPQUFPLEVBQUU7RUFDaEQsSUFBSUMsT0FBTyxHQUFHLEVBQUU7RUFDaEIsSUFBSUosR0FBRyxFQUFFO0lBQ0wsSUFBSUssUUFBUSxHQUFHLEtBQUs7SUFDcEIsSUFBSUMsR0FBRyxHQUFHLEVBQUU7SUFDWixLQUFLLE1BQU1DLEtBQUssSUFBSVAsR0FBRyxFQUFFO01BQ3JCLE1BQU07UUFBRVEsTUFBTTtRQUFFQztNQUFLLENBQUMsR0FBR0YsS0FBSztNQUM5QixRQUFRRSxJQUFJO1FBQ1IsS0FBSyxPQUFPO1VBQ1JKLFFBQVEsR0FBRyxJQUFJO1VBQ2Y7UUFDSixLQUFLLFNBQVM7VUFBRTtZQUNaLElBQUlILFFBQVEsSUFBSSxDQUFDRyxRQUFRLEVBQ3JCRixPQUFPLENBQUNJLEtBQUssRUFBRSxjQUFjLEVBQUUsd0VBQXdFLENBQUM7WUFDNUcsTUFBTUcsRUFBRSxHQUFHRixNQUFNLENBQUNHLFNBQVMsQ0FBQyxDQUFDLENBQUMsSUFBSSxHQUFHO1lBQ3JDLElBQUksQ0FBQ1AsT0FBTyxFQUNSQSxPQUFPLEdBQUdNLEVBQUUsQ0FBQyxLQUViTixPQUFPLElBQUlFLEdBQUcsR0FBR0ksRUFBRTtZQUN2QkosR0FBRyxHQUFHLEVBQUU7WUFDUjtVQUNKO1FBQ0EsS0FBSyxTQUFTO1VBQ1YsSUFBSUYsT0FBTyxFQUNQRSxHQUFHLElBQUlFLE1BQU07VUFDakJILFFBQVEsR0FBRyxJQUFJO1VBQ2Y7UUFDSjtVQUNJRixPQUFPLENBQUNJLEtBQUssRUFBRSxrQkFBa0IsRUFBRyxjQUFhRSxJQUFLLGNBQWEsQ0FBQztNQUFDO01BRTdFUixNQUFNLElBQUlPLE1BQU0sQ0FBQ0ksTUFBTTtJQUMzQjtFQUNKO0VBQ0EsT0FBTztJQUFFUixPQUFPO0lBQUVIO0VBQU8sQ0FBQztBQUM5QjtBQUVBWSxPQUFPLENBQUNkLFVBQVUsR0FBR0EsVUFBVSJ9