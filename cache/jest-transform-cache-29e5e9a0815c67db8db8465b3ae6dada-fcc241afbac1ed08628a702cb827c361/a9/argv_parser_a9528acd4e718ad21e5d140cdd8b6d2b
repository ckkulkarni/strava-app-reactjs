e3d247f11bc0152f61936074e7e35709
"use strict";

var __importDefault = void 0 && (void 0).__importDefault || function (mod) {
  return mod && mod.__esModule ? mod : {
    "default": mod
  };
};
Object.defineProperty(exports, "__esModule", {
  value: true
});
const commander_1 = require("commander");
const lodash_merge_1 = __importDefault(require("lodash.merge"));
const gherkin_1 = require("@cucumber/gherkin");
const formatters_1 = __importDefault(require("../formatter/helpers/formatters"));
const version_1 = require("../version");
const ArgvParser = {
  collect(val, memo = []) {
    if (val) {
      return [...memo, val];
    }
    return undefined;
  },
  mergeJson(option) {
    return function (str, memo = {}) {
      let val;
      try {
        val = JSON.parse(str);
      } catch (error) {
        const e = error;
        throw new Error(`${option} passed invalid JSON: ${e.message}: ${str}`);
      }
      if (typeof val !== 'object' || Array.isArray(val)) {
        throw new Error(`${option} must be passed JSON of an object: ${str}`);
      }
      return (0, lodash_merge_1.default)(memo, val);
    };
  },
  mergeTags(value, memo) {
    return memo ? `${memo} and (${value})` : `(${value})`;
  },
  validateCountOption(value, optionName) {
    const numericValue = parseInt(value);
    if (isNaN(numericValue) || numericValue < 0) {
      throw new Error(`${optionName} must be a non negative integer`);
    }
    return numericValue;
  },
  validateLanguage(value) {
    if (!Object.keys(gherkin_1.dialects).includes(value)) {
      throw new Error(`Unsupported ISO 639-1: ${value}`);
    }
    return value;
  },
  parse(argv) {
    const program = new commander_1.Command('cucumber-js');
    program.storeOptionsAsProperties(false).usage('[options] [<GLOB|DIR|FILE[:LINE]>...]').version(version_1.version, '-v, --version').option('-b, --backtrace', 'show full backtrace for errors').option('-c, --config <PATH>', 'specify configuration file').option('-d, --dry-run', 'invoke formatters without executing steps').option('--exit, --force-exit', 'force shutdown of the event loop when the test run has finished: cucumber will call process.exit').option('--fail-fast', 'abort the run on first failure').option('-f, --format <TYPE[:PATH]>', 'specify the output format, optionally supply PATH to redirect formatter output (repeatable).  Available formats:\n' + formatters_1.default.buildFormattersDocumentationString(), ArgvParser.collect).option('--format-options <JSON>', 'provide options for formatters (repeatable)', ArgvParser.mergeJson('--format-options')).option('--i18n-keywords <ISO 639-1>', 'list language keywords', ArgvParser.validateLanguage).option('--i18n-languages', 'list languages').option('-i, --import <GLOB|DIR|FILE>', 'import files before executing features (repeatable)', ArgvParser.collect).option('--language <ISO 639-1>', 'provide the default language for feature files').option('--name <REGEXP>', 'only execute the scenarios with name matching the expression (repeatable)', ArgvParser.collect).option('--order <TYPE[:SEED]>', 'run scenarios in the specified order. Type should be `defined` or `random`').option('-p, --profile <NAME>', 'specify the profile to use (repeatable)', ArgvParser.collect, []).option('--parallel <NUMBER_OF_WORKERS>', 'run in parallel with the given number of workers', val => ArgvParser.validateCountOption(val, '--parallel')).option('--publish', 'Publish a report to https://reports.cucumber.io').option('--publish-quiet', "Don't print information banner about publishing reports").option('-r, --require <GLOB|DIR|FILE>', 'require files before executing features (repeatable)', ArgvParser.collect).option('--require-module <NODE_MODULE>', 'require node modules before requiring files (repeatable)', ArgvParser.collect).option('--retry <NUMBER_OF_RETRIES>', 'specify the number of times to retry failing test cases (default: 0)', val => ArgvParser.validateCountOption(val, '--retry')).option('--retry-tag-filter <EXPRESSION>', `only retries the features or scenarios with tags matching the expression (repeatable).
        This option requires '--retry' to be specified.`, ArgvParser.mergeTags).option('--strict', 'fail if there are pending steps').option('--no-strict', 'succeed even if there are pending steps').option('-t, --tags <EXPRESSION>', 'only execute the features or scenarios with tags matching the expression (repeatable)', ArgvParser.mergeTags).option('--world-parameters <JSON>', 'provide parameters that will be passed to the world constructor (repeatable)', ArgvParser.mergeJson('--world-parameters'));
    program.addHelpText('afterAll', 'For more details please visit https://github.com/cucumber/cucumber-js/blob/main/docs/cli.md');
    program.parse(argv);
    const {
      config,
      i18nKeywords,
      i18nLanguages,
      profile,
      ...regularStuff
    } = program.opts();
    const configuration = regularStuff;
    if (program.args.length > 0) {
      configuration.paths = program.args;
    }
    return {
      options: {
        config,
        i18nKeywords,
        i18nLanguages,
        profile
      },
      configuration
    };
  }
};
exports.default = ArgvParser;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb21tYW5kZXJfMSIsInJlcXVpcmUiLCJsb2Rhc2hfbWVyZ2VfMSIsIl9faW1wb3J0RGVmYXVsdCIsImdoZXJraW5fMSIsImZvcm1hdHRlcnNfMSIsInZlcnNpb25fMSIsIkFyZ3ZQYXJzZXIiLCJjb2xsZWN0IiwidmFsIiwibWVtbyIsInVuZGVmaW5lZCIsIm1lcmdlSnNvbiIsIm9wdGlvbiIsInN0ciIsIkpTT04iLCJwYXJzZSIsImVycm9yIiwiZSIsIkVycm9yIiwibWVzc2FnZSIsIkFycmF5IiwiaXNBcnJheSIsImRlZmF1bHQiLCJtZXJnZVRhZ3MiLCJ2YWx1ZSIsInZhbGlkYXRlQ291bnRPcHRpb24iLCJvcHRpb25OYW1lIiwibnVtZXJpY1ZhbHVlIiwicGFyc2VJbnQiLCJpc05hTiIsInZhbGlkYXRlTGFuZ3VhZ2UiLCJPYmplY3QiLCJrZXlzIiwiZGlhbGVjdHMiLCJpbmNsdWRlcyIsImFyZ3YiLCJwcm9ncmFtIiwiQ29tbWFuZCIsInN0b3JlT3B0aW9uc0FzUHJvcGVydGllcyIsInVzYWdlIiwidmVyc2lvbiIsImJ1aWxkRm9ybWF0dGVyc0RvY3VtZW50YXRpb25TdHJpbmciLCJhZGRIZWxwVGV4dCIsImNvbmZpZyIsImkxOG5LZXl3b3JkcyIsImkxOG5MYW5ndWFnZXMiLCJwcm9maWxlIiwicmVndWxhclN0dWZmIiwib3B0cyIsImNvbmZpZ3VyYXRpb24iLCJhcmdzIiwibGVuZ3RoIiwicGF0aHMiLCJvcHRpb25zIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9jb25maWd1cmF0aW9uL2FyZ3ZfcGFyc2VyLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbW1hbmQgfSBmcm9tICdjb21tYW5kZXInXG5pbXBvcnQgbWVyZ2UgZnJvbSAnbG9kYXNoLm1lcmdlJ1xuaW1wb3J0IHsgZGlhbGVjdHMgfSBmcm9tICdAY3VjdW1iZXIvZ2hlcmtpbidcbmltcG9ydCBGb3JtYXR0ZXJzIGZyb20gJy4uL2Zvcm1hdHRlci9oZWxwZXJzL2Zvcm1hdHRlcnMnXG5pbXBvcnQgeyB2ZXJzaW9uIH0gZnJvbSAnLi4vdmVyc2lvbidcbmltcG9ydCB7IElDb25maWd1cmF0aW9uIH0gZnJvbSAnLi90eXBlcydcblxuZXhwb3J0IGludGVyZmFjZSBJUGFyc2VkQXJndk9wdGlvbnMge1xuICBjb25maWc/OiBzdHJpbmdcbiAgaTE4bktleXdvcmRzPzogc3RyaW5nXG4gIGkxOG5MYW5ndWFnZXM/OiBib29sZWFuXG4gIHByb2ZpbGU6IHN0cmluZ1tdXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSVBhcnNlZEFyZ3Yge1xuICBvcHRpb25zOiBJUGFyc2VkQXJndk9wdGlvbnNcbiAgY29uZmlndXJhdGlvbjogUGFydGlhbDxJQ29uZmlndXJhdGlvbj5cbn1cblxudHlwZSBJUmF3QXJndk9wdGlvbnMgPSBQYXJ0aWFsPE9taXQ8SUNvbmZpZ3VyYXRpb24sICdwYXRocyc+PiAmXG4gIElQYXJzZWRBcmd2T3B0aW9uc1xuXG5jb25zdCBBcmd2UGFyc2VyID0ge1xuICBjb2xsZWN0PFQ+KHZhbDogVCwgbWVtbzogVFtdID0gW10pOiBUW10ge1xuICAgIGlmICh2YWwpIHtcbiAgICAgIHJldHVybiBbLi4ubWVtbywgdmFsXVxuICAgIH1cbiAgICByZXR1cm4gdW5kZWZpbmVkXG4gIH0sXG5cbiAgbWVyZ2VKc29uKG9wdGlvbjogc3RyaW5nKTogKHN0cjogc3RyaW5nLCBtZW1vPzogb2JqZWN0KSA9PiBvYmplY3Qge1xuICAgIHJldHVybiBmdW5jdGlvbiAoc3RyOiBzdHJpbmcsIG1lbW86IG9iamVjdCA9IHt9KSB7XG4gICAgICBsZXQgdmFsOiBvYmplY3RcbiAgICAgIHRyeSB7XG4gICAgICAgIHZhbCA9IEpTT04ucGFyc2Uoc3RyKVxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc3QgZTogRXJyb3IgPSBlcnJvclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYCR7b3B0aW9ufSBwYXNzZWQgaW52YWxpZCBKU09OOiAke2UubWVzc2FnZX06ICR7c3RyfWApXG4gICAgICB9XG4gICAgICBpZiAodHlwZW9mIHZhbCAhPT0gJ29iamVjdCcgfHwgQXJyYXkuaXNBcnJheSh2YWwpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgJHtvcHRpb259IG11c3QgYmUgcGFzc2VkIEpTT04gb2YgYW4gb2JqZWN0OiAke3N0cn1gKVxuICAgICAgfVxuICAgICAgcmV0dXJuIG1lcmdlKG1lbW8sIHZhbClcbiAgICB9XG4gIH0sXG5cbiAgbWVyZ2VUYWdzKHZhbHVlOiBzdHJpbmcsIG1lbW8/OiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIHJldHVybiBtZW1vID8gYCR7bWVtb30gYW5kICgke3ZhbHVlfSlgIDogYCgke3ZhbHVlfSlgXG4gIH0sXG5cbiAgdmFsaWRhdGVDb3VudE9wdGlvbih2YWx1ZTogc3RyaW5nLCBvcHRpb25OYW1lOiBzdHJpbmcpOiBudW1iZXIge1xuICAgIGNvbnN0IG51bWVyaWNWYWx1ZSA9IHBhcnNlSW50KHZhbHVlKVxuICAgIGlmIChpc05hTihudW1lcmljVmFsdWUpIHx8IG51bWVyaWNWYWx1ZSA8IDApIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgJHtvcHRpb25OYW1lfSBtdXN0IGJlIGEgbm9uIG5lZ2F0aXZlIGludGVnZXJgKVxuICAgIH1cbiAgICByZXR1cm4gbnVtZXJpY1ZhbHVlXG4gIH0sXG5cbiAgdmFsaWRhdGVMYW5ndWFnZSh2YWx1ZTogc3RyaW5nKTogc3RyaW5nIHtcbiAgICBpZiAoIU9iamVjdC5rZXlzKGRpYWxlY3RzKS5pbmNsdWRlcyh2YWx1ZSkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgVW5zdXBwb3J0ZWQgSVNPIDYzOS0xOiAke3ZhbHVlfWApXG4gICAgfVxuICAgIHJldHVybiB2YWx1ZVxuICB9LFxuXG4gIHBhcnNlKGFyZ3Y6IHN0cmluZ1tdKTogSVBhcnNlZEFyZ3Yge1xuICAgIGNvbnN0IHByb2dyYW0gPSBuZXcgQ29tbWFuZCgnY3VjdW1iZXItanMnKVxuXG4gICAgcHJvZ3JhbVxuICAgICAgLnN0b3JlT3B0aW9uc0FzUHJvcGVydGllcyhmYWxzZSlcbiAgICAgIC51c2FnZSgnW29wdGlvbnNdIFs8R0xPQnxESVJ8RklMRVs6TElORV0+Li4uXScpXG4gICAgICAudmVyc2lvbih2ZXJzaW9uLCAnLXYsIC0tdmVyc2lvbicpXG4gICAgICAub3B0aW9uKCctYiwgLS1iYWNrdHJhY2UnLCAnc2hvdyBmdWxsIGJhY2t0cmFjZSBmb3IgZXJyb3JzJylcbiAgICAgIC5vcHRpb24oJy1jLCAtLWNvbmZpZyA8UEFUSD4nLCAnc3BlY2lmeSBjb25maWd1cmF0aW9uIGZpbGUnKVxuICAgICAgLm9wdGlvbignLWQsIC0tZHJ5LXJ1bicsICdpbnZva2UgZm9ybWF0dGVycyB3aXRob3V0IGV4ZWN1dGluZyBzdGVwcycpXG4gICAgICAub3B0aW9uKFxuICAgICAgICAnLS1leGl0LCAtLWZvcmNlLWV4aXQnLFxuICAgICAgICAnZm9yY2Ugc2h1dGRvd24gb2YgdGhlIGV2ZW50IGxvb3Agd2hlbiB0aGUgdGVzdCBydW4gaGFzIGZpbmlzaGVkOiBjdWN1bWJlciB3aWxsIGNhbGwgcHJvY2Vzcy5leGl0J1xuICAgICAgKVxuICAgICAgLm9wdGlvbignLS1mYWlsLWZhc3QnLCAnYWJvcnQgdGhlIHJ1biBvbiBmaXJzdCBmYWlsdXJlJylcbiAgICAgIC5vcHRpb24oXG4gICAgICAgICctZiwgLS1mb3JtYXQgPFRZUEVbOlBBVEhdPicsXG4gICAgICAgICdzcGVjaWZ5IHRoZSBvdXRwdXQgZm9ybWF0LCBvcHRpb25hbGx5IHN1cHBseSBQQVRIIHRvIHJlZGlyZWN0IGZvcm1hdHRlciBvdXRwdXQgKHJlcGVhdGFibGUpLiAgQXZhaWxhYmxlIGZvcm1hdHM6XFxuJyArXG4gICAgICAgICAgRm9ybWF0dGVycy5idWlsZEZvcm1hdHRlcnNEb2N1bWVudGF0aW9uU3RyaW5nKCksXG4gICAgICAgIEFyZ3ZQYXJzZXIuY29sbGVjdFxuICAgICAgKVxuICAgICAgLm9wdGlvbihcbiAgICAgICAgJy0tZm9ybWF0LW9wdGlvbnMgPEpTT04+JyxcbiAgICAgICAgJ3Byb3ZpZGUgb3B0aW9ucyBmb3IgZm9ybWF0dGVycyAocmVwZWF0YWJsZSknLFxuICAgICAgICBBcmd2UGFyc2VyLm1lcmdlSnNvbignLS1mb3JtYXQtb3B0aW9ucycpXG4gICAgICApXG4gICAgICAub3B0aW9uKFxuICAgICAgICAnLS1pMThuLWtleXdvcmRzIDxJU08gNjM5LTE+JyxcbiAgICAgICAgJ2xpc3QgbGFuZ3VhZ2Uga2V5d29yZHMnLFxuICAgICAgICBBcmd2UGFyc2VyLnZhbGlkYXRlTGFuZ3VhZ2VcbiAgICAgIClcbiAgICAgIC5vcHRpb24oJy0taTE4bi1sYW5ndWFnZXMnLCAnbGlzdCBsYW5ndWFnZXMnKVxuICAgICAgLm9wdGlvbihcbiAgICAgICAgJy1pLCAtLWltcG9ydCA8R0xPQnxESVJ8RklMRT4nLFxuICAgICAgICAnaW1wb3J0IGZpbGVzIGJlZm9yZSBleGVjdXRpbmcgZmVhdHVyZXMgKHJlcGVhdGFibGUpJyxcbiAgICAgICAgQXJndlBhcnNlci5jb2xsZWN0XG4gICAgICApXG4gICAgICAub3B0aW9uKFxuICAgICAgICAnLS1sYW5ndWFnZSA8SVNPIDYzOS0xPicsXG4gICAgICAgICdwcm92aWRlIHRoZSBkZWZhdWx0IGxhbmd1YWdlIGZvciBmZWF0dXJlIGZpbGVzJ1xuICAgICAgKVxuICAgICAgLm9wdGlvbihcbiAgICAgICAgJy0tbmFtZSA8UkVHRVhQPicsXG4gICAgICAgICdvbmx5IGV4ZWN1dGUgdGhlIHNjZW5hcmlvcyB3aXRoIG5hbWUgbWF0Y2hpbmcgdGhlIGV4cHJlc3Npb24gKHJlcGVhdGFibGUpJyxcbiAgICAgICAgQXJndlBhcnNlci5jb2xsZWN0XG4gICAgICApXG5cbiAgICAgIC5vcHRpb24oXG4gICAgICAgICctLW9yZGVyIDxUWVBFWzpTRUVEXT4nLFxuICAgICAgICAncnVuIHNjZW5hcmlvcyBpbiB0aGUgc3BlY2lmaWVkIG9yZGVyLiBUeXBlIHNob3VsZCBiZSBgZGVmaW5lZGAgb3IgYHJhbmRvbWAnXG4gICAgICApXG4gICAgICAub3B0aW9uKFxuICAgICAgICAnLXAsIC0tcHJvZmlsZSA8TkFNRT4nLFxuICAgICAgICAnc3BlY2lmeSB0aGUgcHJvZmlsZSB0byB1c2UgKHJlcGVhdGFibGUpJyxcbiAgICAgICAgQXJndlBhcnNlci5jb2xsZWN0LFxuICAgICAgICBbXVxuICAgICAgKVxuICAgICAgLm9wdGlvbihcbiAgICAgICAgJy0tcGFyYWxsZWwgPE5VTUJFUl9PRl9XT1JLRVJTPicsXG4gICAgICAgICdydW4gaW4gcGFyYWxsZWwgd2l0aCB0aGUgZ2l2ZW4gbnVtYmVyIG9mIHdvcmtlcnMnLFxuICAgICAgICAodmFsKSA9PiBBcmd2UGFyc2VyLnZhbGlkYXRlQ291bnRPcHRpb24odmFsLCAnLS1wYXJhbGxlbCcpXG4gICAgICApXG4gICAgICAub3B0aW9uKCctLXB1Ymxpc2gnLCAnUHVibGlzaCBhIHJlcG9ydCB0byBodHRwczovL3JlcG9ydHMuY3VjdW1iZXIuaW8nKVxuICAgICAgLm9wdGlvbihcbiAgICAgICAgJy0tcHVibGlzaC1xdWlldCcsXG4gICAgICAgIFwiRG9uJ3QgcHJpbnQgaW5mb3JtYXRpb24gYmFubmVyIGFib3V0IHB1Ymxpc2hpbmcgcmVwb3J0c1wiXG4gICAgICApXG4gICAgICAub3B0aW9uKFxuICAgICAgICAnLXIsIC0tcmVxdWlyZSA8R0xPQnxESVJ8RklMRT4nLFxuICAgICAgICAncmVxdWlyZSBmaWxlcyBiZWZvcmUgZXhlY3V0aW5nIGZlYXR1cmVzIChyZXBlYXRhYmxlKScsXG4gICAgICAgIEFyZ3ZQYXJzZXIuY29sbGVjdFxuICAgICAgKVxuICAgICAgLm9wdGlvbihcbiAgICAgICAgJy0tcmVxdWlyZS1tb2R1bGUgPE5PREVfTU9EVUxFPicsXG4gICAgICAgICdyZXF1aXJlIG5vZGUgbW9kdWxlcyBiZWZvcmUgcmVxdWlyaW5nIGZpbGVzIChyZXBlYXRhYmxlKScsXG4gICAgICAgIEFyZ3ZQYXJzZXIuY29sbGVjdFxuICAgICAgKVxuICAgICAgLm9wdGlvbihcbiAgICAgICAgJy0tcmV0cnkgPE5VTUJFUl9PRl9SRVRSSUVTPicsXG4gICAgICAgICdzcGVjaWZ5IHRoZSBudW1iZXIgb2YgdGltZXMgdG8gcmV0cnkgZmFpbGluZyB0ZXN0IGNhc2VzIChkZWZhdWx0OiAwKScsXG4gICAgICAgICh2YWwpID0+IEFyZ3ZQYXJzZXIudmFsaWRhdGVDb3VudE9wdGlvbih2YWwsICctLXJldHJ5JylcbiAgICAgIClcbiAgICAgIC5vcHRpb24oXG4gICAgICAgICctLXJldHJ5LXRhZy1maWx0ZXIgPEVYUFJFU1NJT04+JyxcbiAgICAgICAgYG9ubHkgcmV0cmllcyB0aGUgZmVhdHVyZXMgb3Igc2NlbmFyaW9zIHdpdGggdGFncyBtYXRjaGluZyB0aGUgZXhwcmVzc2lvbiAocmVwZWF0YWJsZSkuXG4gICAgICAgIFRoaXMgb3B0aW9uIHJlcXVpcmVzICctLXJldHJ5JyB0byBiZSBzcGVjaWZpZWQuYCxcbiAgICAgICAgQXJndlBhcnNlci5tZXJnZVRhZ3NcbiAgICAgIClcbiAgICAgIC5vcHRpb24oJy0tc3RyaWN0JywgJ2ZhaWwgaWYgdGhlcmUgYXJlIHBlbmRpbmcgc3RlcHMnKVxuICAgICAgLm9wdGlvbignLS1uby1zdHJpY3QnLCAnc3VjY2VlZCBldmVuIGlmIHRoZXJlIGFyZSBwZW5kaW5nIHN0ZXBzJylcbiAgICAgIC5vcHRpb24oXG4gICAgICAgICctdCwgLS10YWdzIDxFWFBSRVNTSU9OPicsXG4gICAgICAgICdvbmx5IGV4ZWN1dGUgdGhlIGZlYXR1cmVzIG9yIHNjZW5hcmlvcyB3aXRoIHRhZ3MgbWF0Y2hpbmcgdGhlIGV4cHJlc3Npb24gKHJlcGVhdGFibGUpJyxcbiAgICAgICAgQXJndlBhcnNlci5tZXJnZVRhZ3NcbiAgICAgIClcbiAgICAgIC5vcHRpb24oXG4gICAgICAgICctLXdvcmxkLXBhcmFtZXRlcnMgPEpTT04+JyxcbiAgICAgICAgJ3Byb3ZpZGUgcGFyYW1ldGVycyB0aGF0IHdpbGwgYmUgcGFzc2VkIHRvIHRoZSB3b3JsZCBjb25zdHJ1Y3RvciAocmVwZWF0YWJsZSknLFxuICAgICAgICBBcmd2UGFyc2VyLm1lcmdlSnNvbignLS13b3JsZC1wYXJhbWV0ZXJzJylcbiAgICAgIClcblxuICAgIHByb2dyYW0uYWRkSGVscFRleHQoXG4gICAgICAnYWZ0ZXJBbGwnLFxuICAgICAgJ0ZvciBtb3JlIGRldGFpbHMgcGxlYXNlIHZpc2l0IGh0dHBzOi8vZ2l0aHViLmNvbS9jdWN1bWJlci9jdWN1bWJlci1qcy9ibG9iL21haW4vZG9jcy9jbGkubWQnXG4gICAgKVxuXG4gICAgcHJvZ3JhbS5wYXJzZShhcmd2KVxuICAgIGNvbnN0IHtcbiAgICAgIGNvbmZpZyxcbiAgICAgIGkxOG5LZXl3b3JkcyxcbiAgICAgIGkxOG5MYW5ndWFnZXMsXG4gICAgICBwcm9maWxlLFxuICAgICAgLi4ucmVndWxhclN0dWZmXG4gICAgfTogSVJhd0FyZ3ZPcHRpb25zID0gcHJvZ3JhbS5vcHRzKClcbiAgICBjb25zdCBjb25maWd1cmF0aW9uOiBQYXJ0aWFsPElDb25maWd1cmF0aW9uPiA9IHJlZ3VsYXJTdHVmZlxuICAgIGlmIChwcm9ncmFtLmFyZ3MubGVuZ3RoID4gMCkge1xuICAgICAgY29uZmlndXJhdGlvbi5wYXRocyA9IHByb2dyYW0uYXJnc1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICBvcHRpb25zOiB7XG4gICAgICAgIGNvbmZpZyxcbiAgICAgICAgaTE4bktleXdvcmRzLFxuICAgICAgICBpMThuTGFuZ3VhZ2VzLFxuICAgICAgICBwcm9maWxlLFxuICAgICAgfSxcbiAgICAgIGNvbmZpZ3VyYXRpb24sXG4gICAgfVxuICB9LFxufVxuXG5leHBvcnQgZGVmYXVsdCBBcmd2UGFyc2VyXG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFBQSxNQUFBQSxXQUFBLEdBQUFDLE9BQUE7QUFDQSxNQUFBQyxjQUFBLEdBQUFDLGVBQUEsQ0FBQUYsT0FBQTtBQUNBLE1BQUFHLFNBQUEsR0FBQUgsT0FBQTtBQUNBLE1BQUFJLFlBQUEsR0FBQUYsZUFBQSxDQUFB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