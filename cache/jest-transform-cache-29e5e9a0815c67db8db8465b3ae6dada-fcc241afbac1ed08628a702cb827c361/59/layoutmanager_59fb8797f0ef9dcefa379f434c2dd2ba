b724981fa3e1b8c6236705fdb3c2e915
"use strict";

const {
  warn,
  debug
} = require('./debug');
const Cell = require('./cell');
const {
  ColSpanCell,
  RowSpanCell
} = Cell;
(function () {
  function next(alloc, col) {
    if (alloc[col] > 0) {
      return next(alloc, col + 1);
    }
    return col;
  }
  function layoutTable(table) {
    let alloc = {};
    table.forEach(function (row, rowIndex) {
      let col = 0;
      row.forEach(function (cell) {
        cell.y = rowIndex;
        // Avoid erroneous call to next() on first row
        cell.x = rowIndex ? next(alloc, col) : col;
        const rowSpan = cell.rowSpan || 1;
        const colSpan = cell.colSpan || 1;
        if (rowSpan > 1) {
          for (let cs = 0; cs < colSpan; cs++) {
            alloc[cell.x + cs] = rowSpan;
          }
        }
        col = cell.x + colSpan;
      });
      Object.keys(alloc).forEach(idx => {
        alloc[idx]--;
        if (alloc[idx] < 1) delete alloc[idx];
      });
    });
  }
  function maxWidth(table) {
    let mw = 0;
    table.forEach(function (row) {
      row.forEach(function (cell) {
        mw = Math.max(mw, cell.x + (cell.colSpan || 1));
      });
    });
    return mw;
  }
  function maxHeight(table) {
    return table.length;
  }
  function cellsConflict(cell1, cell2) {
    let yMin1 = cell1.y;
    let yMax1 = cell1.y - 1 + (cell1.rowSpan || 1);
    let yMin2 = cell2.y;
    let yMax2 = cell2.y - 1 + (cell2.rowSpan || 1);
    let yConflict = !(yMin1 > yMax2 || yMin2 > yMax1);
    let xMin1 = cell1.x;
    let xMax1 = cell1.x - 1 + (cell1.colSpan || 1);
    let xMin2 = cell2.x;
    let xMax2 = cell2.x - 1 + (cell2.colSpan || 1);
    let xConflict = !(xMin1 > xMax2 || xMin2 > xMax1);
    return yConflict && xConflict;
  }
  function conflictExists(rows, x, y) {
    let i_max = Math.min(rows.length - 1, y);
    let cell = {
      x: x,
      y: y
    };
    for (let i = 0; i <= i_max; i++) {
      let row = rows[i];
      for (let j = 0; j < row.length; j++) {
        if (cellsConflict(cell, row[j])) {
          return true;
        }
      }
    }
    return false;
  }
  function allBlank(rows, y, xMin, xMax) {
    for (let x = xMin; x < xMax; x++) {
      if (conflictExists(rows, x, y)) {
        return false;
      }
    }
    return true;
  }
  function addRowSpanCells(table) {
    table.forEach(function (row, rowIndex) {
      row.forEach(function (cell) {
        for (let i = 1; i < cell.rowSpan; i++) {
          let rowSpanCell = new RowSpanCell(cell);
          rowSpanCell.x = cell.x;
          rowSpanCell.y = cell.y + i;
          rowSpanCell.colSpan = cell.colSpan;
          insertCell(rowSpanCell, table[rowIndex + i]);
        }
      });
    });
  }
  function addColSpanCells(cellRows) {
    for (let rowIndex = cellRows.length - 1; rowIndex >= 0; rowIndex--) {
      let cellColumns = cellRows[rowIndex];
      for (let columnIndex = 0; columnIndex < cellColumns.length; columnIndex++) {
        let cell = cellColumns[columnIndex];
        for (let k = 1; k < cell.colSpan; k++) {
          let colSpanCell = new ColSpanCell();
          colSpanCell.x = cell.x + k;
          colSpanCell.y = cell.y;
          cellColumns.splice(columnIndex + 1, 0, colSpanCell);
        }
      }
    }
  }
  function insertCell(cell, row) {
    let x = 0;
    while (x < row.length && row[x].x < cell.x) {
      x++;
    }
    row.splice(x, 0, cell);
  }
  function fillInTable(table) {
    let h_max = maxHeight(table);
    let w_max = maxWidth(table);
    debug(`Max rows: ${h_max}; Max cols: ${w_max}`);
    for (let y = 0; y < h_max; y++) {
      for (let x = 0; x < w_max; x++) {
        if (!conflictExists(table, x, y)) {
          let opts = {
            x: x,
            y: y,
            colSpan: 1,
            rowSpan: 1
          };
          x++;
          while (x < w_max && !conflictExists(table, x, y)) {
            opts.colSpan++;
            x++;
          }
          let y2 = y + 1;
          while (y2 < h_max && allBlank(table, y2, opts.x, opts.x + opts.colSpan)) {
            opts.rowSpan++;
            y2++;
          }
          let cell = new Cell(opts);
          cell.x = opts.x;
          cell.y = opts.y;
          warn(`Missing cell at ${cell.y}-${cell.x}.`);
          insertCell(cell, table[y]);
        }
      }
    }
  }
  function generateCells(rows) {
    return rows.map(function (row) {
      if (!Array.isArray(row)) {
        let key = Object.keys(row)[0];
        row = row[key];
        if (Array.isArray(row)) {
          row = row.slice();
          row.unshift(key);
        } else {
          row = [key, row];
        }
      }
      return row.map(function (cell) {
        return new Cell(cell);
      });
    });
  }
  function makeTableLayout(rows) {
    let cellRows = generateCells(rows);
    layoutTable(cellRows);
    fillInTable(cellRows);
    addRowSpanCells(cellRows);
    addColSpanCells(cellRows);
    return cellRows;
  }
  module.exports = {
    makeTableLayout: makeTableLayout,
    layoutTable: layoutTable,
    addRowSpanCells: addRowSpanCells,
    maxWidth: maxWidth,
    fillInTable: fillInTable,
    computeWidths: makeComputeWidths('colSpan', 'desiredWidth', 'x', 1),
    computeHeights: makeComputeWidths('rowSpan', 'desiredHeight', 'y', 1)
  };
})();
function makeComputeWidths(colSpan, desiredWidth, x, forcedMin) {
  return function (vals, table) {
    let result = [];
    let spanners = [];
    let auto = {};
    table.forEach(function (row) {
      row.forEach(function (cell) {
        if ((cell[colSpan] || 1) > 1) {
          spanners.push(cell);
        } else {
          result[cell[x]] = Math.max(result[cell[x]] || 0, cell[desiredWidth] || 0, forcedMin);
        }
      });
    });
    vals.forEach(function (val, index) {
      if (typeof val === 'number') {
        result[index] = val;
      }
    });

    //spanners.forEach(function(cell){
    for (let k = spanners.length - 1; k >= 0; k--) {
      let cell = spanners[k];
      let span = cell[colSpan];
      let col = cell[x];
      let existingWidth = result[col];
      let editableCols = typeof vals[col] === 'number' ? 0 : 1;
      if (typeof existingWidth === 'number') {
        for (let i = 1; i < span; i++) {
          existingWidth += 1 + result[col + i];
          if (typeof vals[col + i] !== 'number') {
            editableCols++;
          }
        }
      } else {
        existingWidth = desiredWidth === 'desiredWidth' ? cell.desiredWidth - 1 : 1;
        if (!auto[col] || auto[col] < existingWidth) {
          auto[col] = existingWidth;
        }
      }
      if (cell[desiredWidth] > existingWidth) {
        let i = 0;
        while (editableCols > 0 && cell[desiredWidth] > existingWidth) {
          if (typeof vals[col + i] !== 'number') {
            let dif = Math.round((cell[desiredWidth] - existingWidth) / editableCols);
            existingWidth += dif;
            result[col + i] += dif;
            editableCols--;
          }
          i++;
        }
      }
    }
    Object.assign(vals, result, auto);
    for (let j = 0; j < vals.length; j++) {
      vals[j] = Math.max(forcedMin, vals[j] || 0);
    }
  };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJ3YXJuIiwiZGVidWciLCJyZXF1aXJlIiwiQ2VsbCIsIkNvbFNwYW5DZWxsIiwiUm93U3BhbkNlbGwiLCJuZXh0IiwiYWxsb2MiLCJjb2wiLCJsYXlvdXRUYWJsZSIsInRhYmxlIiwiZm9yRWFjaCIsInJvdyIsInJvd0luZGV4IiwiY2VsbCIsInkiLCJ4Iiwicm93U3BhbiIsImNvbFNwYW4iLCJjcyIsIk9iamVjdCIsImtleXMiLCJpZHgiLCJtYXhXaWR0aCIsIm13IiwiTWF0aCIsIm1heCIsIm1heEhlaWdodCIsImxlbmd0aCIsImNlbGxzQ29uZmxpY3QiLCJjZWxsMSIsImNlbGwyIiwieU1pbjEiLCJ5TWF4MSIsInlNaW4yIiwieU1heDIiLCJ5Q29uZmxpY3QiLCJ4TWluMSIsInhNYXgxIiwieE1pbjIiLCJ4TWF4MiIsInhDb25mbGljdCIsImNvbmZsaWN0RXhpc3RzIiwicm93cyIsImlfbWF4IiwibWluIiwiaSIsImoiLCJhbGxCbGFuayIsInhNaW4iLCJ4TWF4IiwiYWRkUm93U3BhbkNlbGxzIiwicm93U3BhbkNlbGwiLCJpbnNlcnRDZWxsIiwiYWRkQ29sU3BhbkNlbGxzIiwiY2VsbFJvd3MiLCJjZWxsQ29sdW1ucyIsImNvbHVtbkluZGV4IiwiayIsImNvbFNwYW5DZWxsIiwic3BsaWNlIiwiZmlsbEluVGFibGUiLCJoX21heCIsIndfbWF4Iiwib3B0cyIsInkyIiwiZ2VuZXJhdGVDZWxscyIsIm1hcCIsIkFycmF5IiwiaXNBcnJheSIsImtleSIsInNsaWNlIiwidW5zaGlmdCIsIm1ha2VUYWJsZUxheW91dCIsIm1vZHVsZSIsImV4cG9ydHMiLCJjb21wdXRlV2lkdGhzIiwibWFrZUNvbXB1dGVXaWR0aHMiLCJjb21wdXRlSGVpZ2h0cyIsImRlc2lyZWRXaWR0aCIsImZvcmNlZE1pbiIsInZhbHMiLCJyZXN1bHQiLCJzcGFubmVycyIsImF1dG8iLCJwdXNoIiwidmFsIiwiaW5kZXgiLCJzcGFuIiwiZXhpc3RpbmdXaWR0aCIsImVkaXRhYmxlQ29scyIsImRpZiIsInJvdW5kIiwiYXNzaWduIl0sInNvdXJjZXMiOlsibGF5b3V0LW1hbmFnZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgeyB3YXJuLCBkZWJ1ZyB9ID0gcmVxdWlyZSgnLi9kZWJ1ZycpO1xuY29uc3QgQ2VsbCA9IHJlcXVpcmUoJy4vY2VsbCcpO1xuY29uc3QgeyBDb2xTcGFuQ2VsbCwgUm93U3BhbkNlbGwgfSA9IENlbGw7XG5cbihmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIG5leHQoYWxsb2MsIGNvbCkge1xuICAgIGlmIChhbGxvY1tjb2xdID4gMCkge1xuICAgICAgcmV0dXJuIG5leHQoYWxsb2MsIGNvbCArIDEpO1xuICAgIH1cbiAgICByZXR1cm4gY29sO1xuICB9XG5cbiAgZnVuY3Rpb24gbGF5b3V0VGFibGUodGFibGUpIHtcbiAgICBsZXQgYWxsb2MgPSB7fTtcbiAgICB0YWJsZS5mb3JFYWNoKGZ1bmN0aW9uIChyb3csIHJvd0luZGV4KSB7XG4gICAgICBsZXQgY29sID0gMDtcbiAgICAgIHJvdy5mb3JFYWNoKGZ1bmN0aW9uIChjZWxsKSB7XG4gICAgICAgIGNlbGwueSA9IHJvd0luZGV4O1xuICAgICAgICAvLyBBdm9pZCBlcnJvbmVvdXMgY2FsbCB0byBuZXh0KCkgb24gZmlyc3Qgcm93XG4gICAgICAgIGNlbGwueCA9IHJvd0luZGV4ID8gbmV4dChhbGxvYywgY29sKSA6IGNvbDtcbiAgICAgICAgY29uc3Qgcm93U3BhbiA9IGNlbGwucm93U3BhbiB8fCAxO1xuICAgICAgICBjb25zdCBjb2xTcGFuID0gY2VsbC5jb2xTcGFuIHx8IDE7XG4gICAgICAgIGlmIChyb3dTcGFuID4gMSkge1xuICAgICAgICAgIGZvciAobGV0IGNzID0gMDsgY3MgPCBjb2xTcGFuOyBjcysrKSB7XG4gICAgICAgICAgICBhbGxvY1tjZWxsLnggKyBjc10gPSByb3dTcGFuO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjb2wgPSBjZWxsLnggKyBjb2xTcGFuO1xuICAgICAgfSk7XG4gICAgICBPYmplY3Qua2V5cyhhbGxvYykuZm9yRWFjaCgoaWR4KSA9PiB7XG4gICAgICAgIGFsbG9jW2lkeF0tLTtcbiAgICAgICAgaWYgKGFsbG9jW2lkeF0gPCAxKSBkZWxldGUgYWxsb2NbaWR4XTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gbWF4V2lkdGgodGFibGUpIHtcbiAgICBsZXQgbXcgPSAwO1xuICAgIHRhYmxlLmZvckVhY2goZnVuY3Rpb24gKHJvdykge1xuICAgICAgcm93LmZvckVhY2goZnVuY3Rpb24gKGNlbGwpIHtcbiAgICAgICAgbXcgPSBNYXRoLm1heChtdywgY2VsbC54ICsgKGNlbGwuY29sU3BhbiB8fCAxKSk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgICByZXR1cm4gbXc7XG4gIH1cblxuICBmdW5jdGlvbiBtYXhIZWlnaHQodGFibGUpIHtcbiAgICByZXR1cm4gdGFibGUubGVuZ3RoO1xuICB9XG5cbiAgZnVuY3Rpb24gY2VsbHNDb25mbGljdChjZWxsMSwgY2VsbDIpIHtcbiAgICBsZXQgeU1pbjEgPSBjZWxsMS55O1xuICAgIGxldCB5TWF4MSA9IGNlbGwxLnkgLSAxICsgKGNlbGwxLnJvd1NwYW4gfHwgMSk7XG4gICAgbGV0IHlNaW4yID0gY2VsbDIueTtcbiAgICBsZXQgeU1heDIgPSBjZWxsMi55IC0gMSArIChjZWxsMi5yb3dTcGFuIHx8IDEpO1xuICAgIGxldCB5Q29uZmxpY3QgPSAhKHlNaW4xID4geU1heDIgfHwgeU1pbjIgPiB5TWF4MSk7XG5cbiAgICBsZXQgeE1pbjEgPSBjZWxsMS54O1xuICAgIGxldCB4TWF4MSA9IGNlbGwxLnggLSAxICsgKGNlbGwxLmNvbFNwYW4gfHwgMSk7XG4gICAgbGV0IHhNaW4yID0gY2VsbDIueDtcbiAgICBsZXQgeE1heDIgPSBjZWxsMi54IC0gMSArIChjZWxsMi5jb2xTcGFuIHx8IDEpO1xuICAgIGxldCB4Q29uZmxpY3QgPSAhKHhNaW4xID4geE1heDIgfHwgeE1pbjIgPiB4TWF4MSk7XG5cbiAgICByZXR1cm4geUNvbmZsaWN0ICYmIHhDb25mbGljdDtcbiAgfVxuXG4gIGZ1bmN0aW9uIGNvbmZsaWN0RXhpc3RzKHJvd3MsIHgsIHkpIHtcbiAgICBsZXQgaV9tYXggPSBNYXRoLm1pbihyb3dzLmxlbmd0aCAtIDEsIHkpO1xuICAgIGxldCBjZWxsID0geyB4OiB4LCB5OiB5IH07XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPD0gaV9tYXg7IGkrKykge1xuICAgICAgbGV0IHJvdyA9IHJvd3NbaV07XG4gICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHJvdy5sZW5ndGg7IGorKykge1xuICAgICAgICBpZiAoY2VsbHNDb25mbGljdChjZWxsLCByb3dbal0pKSB7XG4gICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgZnVuY3Rpb24gYWxsQmxhbmsocm93cywgeSwgeE1pbiwgeE1heCkge1xuICAgIGZvciAobGV0IHggPSB4TWluOyB4IDwgeE1heDsgeCsrKSB7XG4gICAgICBpZiAoY29uZmxpY3RFeGlzdHMocm93cywgeCwgeSkpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGFkZFJvd1NwYW5DZWxscyh0YWJsZSkge1xuICAgIHRhYmxlLmZvckVhY2goZnVuY3Rpb24gKHJvdywgcm93SW5kZXgpIHtcbiAgICAgIHJvdy5mb3JFYWNoKGZ1bmN0aW9uIChjZWxsKSB7XG4gICAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgY2VsbC5yb3dTcGFuOyBpKyspIHtcbiAgICAgICAgICBsZXQgcm93U3BhbkNlbGwgPSBuZXcgUm93U3BhbkNlbGwoY2VsbCk7XG4gICAgICAgICAgcm93U3BhbkNlbGwueCA9IGNlbGwueDtcbiAgICAgICAgICByb3dTcGFuQ2VsbC55ID0gY2VsbC55ICsgaTtcbiAgICAgICAgICByb3dTcGFuQ2VsbC5jb2xTcGFuID0gY2VsbC5jb2xTcGFuO1xuICAgICAgICAgIGluc2VydENlbGwocm93U3BhbkNlbGwsIHRhYmxlW3Jvd0luZGV4ICsgaV0pO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGFkZENvbFNwYW5DZWxscyhjZWxsUm93cykge1xuICAgIGZvciAobGV0IHJvd0luZGV4ID0gY2VsbFJvd3MubGVuZ3RoIC0gMTsgcm93SW5kZXggPj0gMDsgcm93SW5kZXgtLSkge1xuICAgICAgbGV0IGNlbGxDb2x1bW5zID0gY2VsbFJvd3Nbcm93SW5kZXhdO1xuICAgICAgZm9yIChsZXQgY29sdW1uSW5kZXggPSAwOyBjb2x1bW5JbmRleCA8IGNlbGxDb2x1bW5zLmxlbmd0aDsgY29sdW1uSW5kZXgrKykge1xuICAgICAgICBsZXQgY2VsbCA9IGNlbGxDb2x1bW5zW2NvbHVtbkluZGV4XTtcbiAgICAgICAgZm9yIChsZXQgayA9IDE7IGsgPCBjZWxsLmNvbFNwYW47IGsrKykge1xuICAgICAgICAgIGxldCBjb2xTcGFuQ2VsbCA9IG5ldyBDb2xTcGFuQ2VsbCgpO1xuICAgICAgICAgIGNvbFNwYW5DZWxsLnggPSBjZWxsLnggKyBrO1xuICAgICAgICAgIGNvbFNwYW5DZWxsLnkgPSBjZWxsLnk7XG4gICAgICAgICAgY2VsbENvbHVtbnMuc3BsaWNlKGNvbHVtbkluZGV4ICsgMSwgMCwgY29sU3BhbkNlbGwpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gaW5zZXJ0Q2VsbChjZWxsLCByb3cpIHtcbiAgICBsZXQgeCA9IDA7XG4gICAgd2hpbGUgKHggPCByb3cubGVuZ3RoICYmIHJvd1t4XS54IDwgY2VsbC54KSB7XG4gICAgICB4Kys7XG4gICAgfVxuICAgIHJvdy5zcGxpY2UoeCwgMCwgY2VsbCk7XG4gIH1cblxuICBmdW5jdGlvbiBmaWxsSW5UYWJsZSh0YWJsZSkge1xuICAgIGxldCBoX21heCA9IG1heEhlaWdodCh0YWJsZSk7XG4gICAgbGV0IHdfbWF4ID0gbWF4V2lkdGgodGFibGUpO1xuICAgIGRlYnVnKGBNYXggcm93czogJHtoX21heH07IE1heCBjb2xzOiAke3dfbWF4fWApO1xuICAgIGZvciAobGV0IHkgPSAwOyB5IDwgaF9tYXg7IHkrKykge1xuICAgICAgZm9yIChsZXQgeCA9IDA7IHggPCB3X21heDsgeCsrKSB7XG4gICAgICAgIGlmICghY29uZmxpY3RFeGlzdHModGFibGUsIHgsIHkpKSB7XG4gICAgICAgICAgbGV0IG9wdHMgPSB7IHg6IHgsIHk6IHksIGNvbFNwYW46IDEsIHJvd1NwYW46IDEgfTtcbiAgICAgICAgICB4Kys7XG4gICAgICAgICAgd2hpbGUgKHggPCB3X21heCAmJiAhY29uZmxpY3RFeGlzdHModGFibGUsIHgsIHkpKSB7XG4gICAgICAgICAgICBvcHRzLmNvbFNwYW4rKztcbiAgICAgICAgICAgIHgrKztcbiAgICAgICAgICB9XG4gICAgICAgICAgbGV0IHkyID0geSArIDE7XG4gICAgICAgICAgd2hpbGUgKHkyIDwgaF9tYXggJiYgYWxsQmxhbmsodGFibGUsIHkyLCBvcHRzLngsIG9wdHMueCArIG9wdHMuY29sU3BhbikpIHtcbiAgICAgICAgICAgIG9wdHMucm93U3BhbisrO1xuICAgICAgICAgICAgeTIrKztcbiAgICAgICAgICB9XG4gICAgICAgICAgbGV0IGNlbGwgPSBuZXcgQ2VsbChvcHRzKTtcbiAgICAgICAgICBjZWxsLnggPSBvcHRzLng7XG4gICAgICAgICAgY2VsbC55ID0gb3B0cy55O1xuICAgICAgICAgIHdhcm4oYE1pc3NpbmcgY2VsbCBhdCAke2NlbGwueX0tJHtjZWxsLnh9LmApO1xuICAgICAgICAgIGluc2VydENlbGwoY2VsbCwgdGFibGVbeV0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gZ2VuZXJhdGVDZWxscyhyb3dzKSB7XG4gICAgcmV0dXJuIHJvd3MubWFwKGZ1bmN0aW9uIChyb3cpIHtcbiAgICAgIGlmICghQXJyYXkuaXNBcnJheShyb3cpKSB7XG4gICAgICAgIGxldCBrZXkgPSBPYmplY3Qua2V5cyhyb3cpWzBdO1xuICAgICAgICByb3cgPSByb3dba2V5XTtcbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkocm93KSkge1xuICAgICAgICAgIHJvdyA9IHJvdy5zbGljZSgpO1xuICAgICAgICAgIHJvdy51bnNoaWZ0KGtleSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcm93ID0gW2tleSwgcm93XTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHJvdy5tYXAoZnVuY3Rpb24gKGNlbGwpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBDZWxsKGNlbGwpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBtYWtlVGFibGVMYXlvdXQocm93cykge1xuICAgIGxldCBjZWxsUm93cyA9IGdlbmVyYXRlQ2VsbHMocm93cyk7XG4gICAgbGF5b3V0VGFibGUoY2VsbFJvd3MpO1xuICAgIGZpbGxJblRhYmxlKGNlbGxSb3dzKTtcbiAgICBhZGRSb3dTcGFuQ2VsbHMoY2VsbFJvd3MpO1xuICAgIGFkZENvbFNwYW5DZWxscyhjZWxsUm93cyk7XG4gICAgcmV0dXJuIGNlbGxSb3dzO1xuICB9XG5cbiAgbW9kdWxlLmV4cG9ydHMgPSB7XG4gICAgbWFrZVRhYmxlTGF5b3V0OiBtYWtlVGFibGVMYXlvdXQsXG4gICAgbGF5b3V0VGFibGU6IGxheW91dFRhYmxlLFxuICAgIGFkZFJvd1NwYW5DZWxsczogYWRkUm93U3BhbkNlbGxzLFxuICAgIG1heFdpZHRoOiBtYXhXaWR0aCxcbiAgICBmaWxsSW5UYWJsZTogZmlsbEluVGFibGUsXG4gICAgY29tcHV0ZVdpZHRoczogbWFrZUNvbXB1dGVXaWR0aHMoJ2NvbFNwYW4nLCAnZGVzaXJlZFdpZHRoJywgJ3gnLCAxKSxcbiAgICBjb21wdXRlSGVpZ2h0czogbWFrZUNvbXB1dGVXaWR0aHMoJ3Jvd1NwYW4nLCAnZGVzaXJlZEhlaWdodCcsICd5JywgMSksXG4gIH07XG59KSgpO1xuXG5mdW5jdGlvbiBtYWtlQ29tcHV0ZVdpZHRocyhjb2xTcGFuLCBkZXNpcmVkV2lkdGgsIHgsIGZvcmNlZE1pbikge1xuICByZXR1cm4gZnVuY3Rpb24gKHZhbHMsIHRhYmxlKSB7XG4gICAgbGV0IHJlc3VsdCA9IFtdO1xuICAgIGxldCBzcGFubmVycyA9IFtdO1xuICAgIGxldCBhdXRvID0ge307XG4gICAgdGFibGUuZm9yRWFjaChmdW5jdGlvbiAocm93KSB7XG4gICAgICByb3cuZm9yRWFjaChmdW5jdGlvbiAoY2VsbCkge1xuICAgICAgICBpZiAoKGNlbGxbY29sU3Bhbl0gfHwgMSkgPiAxKSB7XG4gICAgICAgICAgc3Bhbm5lcnMucHVzaChjZWxsKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXN1bHRbY2VsbFt4XV0gPSBNYXRoLm1heChyZXN1bHRbY2VsbFt4XV0gfHwgMCwgY2VsbFtkZXNpcmVkV2lkdGhdIHx8IDAsIGZvcmNlZE1pbik7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgdmFscy5mb3JFYWNoKGZ1bmN0aW9uICh2YWwsIGluZGV4KSB7XG4gICAgICBpZiAodHlwZW9mIHZhbCA9PT0gJ251bWJlcicpIHtcbiAgICAgICAgcmVzdWx0W2luZGV4XSA9IHZhbDtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vc3Bhbm5lcnMuZm9yRWFjaChmdW5jdGlvbihjZWxsKXtcbiAgICBmb3IgKGxldCBrID0gc3Bhbm5lcnMubGVuZ3RoIC0gMTsgayA+PSAwOyBrLS0pIHtcbiAgICAgIGxldCBjZWxsID0gc3Bhbm5lcnNba107XG4gICAgICBsZXQgc3BhbiA9IGNlbGxbY29sU3Bhbl07XG4gICAgICBsZXQgY29sID0gY2VsbFt4XTtcbiAgICAgIGxldCBleGlzdGluZ1dpZHRoID0gcmVzdWx0W2NvbF07XG4gICAgICBsZXQgZWRpdGFibGVDb2xzID0gdHlwZW9mIHZhbHNbY29sXSA9PT0gJ251bWJlcicgPyAwIDogMTtcbiAgICAgIGlmICh0eXBlb2YgZXhpc3RpbmdXaWR0aCA9PT0gJ251bWJlcicpIHtcbiAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPCBzcGFuOyBpKyspIHtcbiAgICAgICAgICBleGlzdGluZ1dpZHRoICs9IDEgKyByZXN1bHRbY29sICsgaV07XG4gICAgICAgICAgaWYgKHR5cGVvZiB2YWxzW2NvbCArIGldICE9PSAnbnVtYmVyJykge1xuICAgICAgICAgICAgZWRpdGFibGVDb2xzKys7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBleGlzdGluZ1dpZHRoID0gZGVzaXJlZFdpZHRoID09PSAnZGVzaXJlZFdpZHRoJyA/IGNlbGwuZGVzaXJlZFdpZHRoIC0gMSA6IDE7XG4gICAgICAgIGlmICghYXV0b1tjb2xdIHx8IGF1dG9bY29sXSA8IGV4aXN0aW5nV2lkdGgpIHtcbiAgICAgICAgICBhdXRvW2NvbF0gPSBleGlzdGluZ1dpZHRoO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmIChjZWxsW2Rlc2lyZWRXaWR0aF0gPiBleGlzdGluZ1dpZHRoKSB7XG4gICAgICAgIGxldCBpID0gMDtcbiAgICAgICAgd2hpbGUgKGVkaXRhYmxlQ29scyA+IDAgJiYgY2VsbFtkZXNpcmVkV2lkdGhdID4gZXhpc3RpbmdXaWR0aCkge1xuICAgICAgICAgIGlmICh0eXBlb2YgdmFsc1tjb2wgKyBpXSAhPT0gJ251bWJlcicpIHtcbiAgICAgICAgICAgIGxldCBkaWYgPSBNYXRoLnJvdW5kKChjZWxsW2Rlc2lyZWRXaWR0aF0gLSBleGlzdGluZ1dpZHRoKSAvIGVkaXRhYmxlQ29scyk7XG4gICAgICAgICAgICBleGlzdGluZ1dpZHRoICs9IGRpZjtcbiAgICAgICAgICAgIHJlc3VsdFtjb2wgKyBpXSArPSBkaWY7XG4gICAgICAgICAgICBlZGl0YWJsZUNvbHMtLTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaSsrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgT2JqZWN0LmFzc2lnbih2YWxzLCByZXN1bHQsIGF1dG8pO1xuICAgIGZvciAobGV0IGogPSAwOyBqIDwgdmFscy5sZW5ndGg7IGorKykge1xuICAgICAgdmFsc1tqXSA9IE1hdGgubWF4KGZvcmNlZE1pbiwgdmFsc1tqXSB8fCAwKTtcbiAgICB9XG4gIH07XG59XG4iXSwibWFwcGluZ3MiOiI7O0FBQUEsTUFBTTtFQUFFQSxJQUFJO0VBQUVDO0FBQU0sQ0FBQyxHQUFHQyxPQUFPLENBQUMsU0FBUyxDQUFDO0FBQzFDLE1BQU1DLElBQUksR0FBR0QsT0FBTyxDQUFDLFFBQVEsQ0FBQztBQUM5QixNQUFNO0VBQUVFLFdBQVc7RUFBRUM7QUFBWSxDQUFDLEdBQUdGLElBQUk7QUFFekMsQ0FBQyxZQUFZO0VBQ1gsU0FBU0csSUFBSUEsQ0FBQ0MsS0FBSyxFQUFFQyxHQUFHLEVBQUU7SUFDeEIsSUFBSUQsS0FBSyxDQUFDQyxHQUFHLENBQUMsR0FBRyxDQUFDLEVBQUU7TUFDbEIsT0FBT0YsSUFBSSxDQUFDQyxLQUFLLEVBQUVDLEdBQUcsR0FBRyxDQUFDLENBQUM7SUFDN0I7SUFDQSxPQUFPQSxHQUFHO0VBQ1o7RUFFQSxTQUFTQyxXQUFXQSxDQUFDQyxLQUFLLEVBQUU7SUFDMUIsSUFBSUgsS0FBSyxHQUFHLENBQUMsQ0FBQztJQUNkRyxLQUFLLENBQUNDLE9BQU8sQ0FBQyxVQUFVQyxHQUFHLEVBQUVDLFFBQVEsRUFBRTtNQUNyQyxJQUFJTCxHQUFHLEdBQUcsQ0FBQztNQUNYSSxHQUFHLENBQUNELE9BQU8sQ0FBQyxVQUFVRyxJQUFJLEVBQUU7UUFDMUJBLElBQUksQ0FBQ0MsQ0FBQyxHQUFHRixRQUFRO1FBQ2pCO1FBQ0FDLElBQUksQ0FBQ0UsQ0FBQyxHQUFHSCxRQUFRLEdBQUdQLElBQUksQ0FBQ0MsS0FBSyxFQUFFQyxHQUFHLENBQUMsR0FBR0EsR0FBRztRQUMxQyxNQUFNUyxPQUFPLEdBQUdILElBQUksQ0FBQ0csT0FBTyxJQUFJLENB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