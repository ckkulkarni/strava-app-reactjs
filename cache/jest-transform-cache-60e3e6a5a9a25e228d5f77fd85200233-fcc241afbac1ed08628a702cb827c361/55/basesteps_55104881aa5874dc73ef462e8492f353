ba32dbf0e162969c26f01ee9c17d8086
"use strict";

var _jestCucumber = require("jest-cucumber");
var _react = require("@testing-library/react");
var _react2 = _interopRequireDefault(require("react"));
require("@testing-library/jest-dom/extend-expect");
require("text-encoding");
var _reactRouterDom = require("react-router-dom");
var _Base = _interopRequireDefault(require("../../pages/Base"));
var _testUtils = require("react-dom/test-utils");
var _reactRedux = require("react-redux");
var _toolkit = require("@reduxjs/toolkit");
var _stravaSlice = _interopRequireDefault(require("../../redux/reducer/stravaSlice"));
function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }
const feature = (0, _jestCucumber.loadFeature)("src/components/features/base.feature");
let store;
let screen;
const {
  REACT_APP_CLIENTID
} = process.env;
const {
  REACT_APP_CLIENT_SECRET
} = process.env;
const redirectUrl = "http://localhost:3000/redirect";
const scope = "read,activity:read";
(0, _jestCucumber.defineFeature)(feature, test => {
  beforeEach(() => {
    store = (0, _toolkit.configureStore)({
      reducer: {
        strava: _stravaSlice.default
      }
    });
    screen = (0, _react.render)( /*#__PURE__*/_react2.default.createElement(_reactRedux.Provider, {
      store: store
    }, /*#__PURE__*/_react2.default.createElement(_reactRouterDom.BrowserRouter, null, /*#__PURE__*/_react2.default.createElement(_reactRouterDom.Routes, null, /*#__PURE__*/_react2.default.createElement(_reactRouterDom.Route, {
      path: "/",
      element: /*#__PURE__*/_react2.default.createElement(_Base.default, null)
    })))));
  });
  test('User is not logged in and clicks on "Login with Strava" button', ({
    given,
    when,
    then,
    and
  }) => {
    given("I am on the home page", () => {
      expect(screen).toBeDefined();
    });
    when('I click on "Login With Strava" button', () => {
      const loginButton = screen.getByRole("button", {
        name: "Login With Strava"
      });
      (0, _testUtils.act)(() => {
        _react.fireEvent.click(loginButton);
      });
    });
  });
  test("User is logged in and opens the app", ({
    given,
    when,
    then,
    and
  }) => {
    localStorage.setItem("access_token", "mock-token");
    given("I am on the home page", () => {
      expect(screen).toBeDefined();
    });
    and("I am already logged in", async () => {
      (0, _react.waitFor)(() => {
        const accessToken = localStorage.getItem("access_token");
        expect(accessToken).toBeDefined();
      });
    });
    then('I should be redirected to the "Activities" screen', () => {});
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfamVzdEN1Y3VtYmVyIiwicmVxdWlyZSIsIl9yZWFjdCIsIl9yZWFjdDIiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwiX3JlYWN0Um91dGVyRG9tIiwiX0Jhc2UiLCJfdGVzdFV0aWxzIiwiX3JlYWN0UmVkdXgiLCJfdG9vbGtpdCIsIl9zdHJhdmFTbGljZSIsIm9iaiIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiZmVhdHVyZSIsImxvYWRGZWF0dXJlIiwic3RvcmUiLCJzY3JlZW4iLCJSRUFDVF9BUFBfQ0xJRU5USUQiLCJwcm9jZXNzIiwiZW52IiwiUkVBQ1RfQVBQX0NMSUVOVF9TRUNSRVQiLCJyZWRpcmVjdFVybCIsInNjb3BlIiwiZGVmaW5lRmVhdHVyZSIsInRlc3QiLCJiZWZvcmVFYWNoIiwiY29uZmlndXJlU3RvcmUiLCJyZWR1Y2VyIiwic3RyYXZhIiwic3RyYXZhU2xpY2UiLCJyZW5kZXIiLCJjcmVhdGVFbGVtZW50IiwiUHJvdmlkZXIiLCJCcm93c2VyUm91dGVyIiwiUm91dGVzIiwiUm91dGUiLCJwYXRoIiwiZWxlbWVudCIsImdpdmVuIiwid2hlbiIsInRoZW4iLCJhbmQiLCJleHBlY3QiLCJ0b0JlRGVmaW5lZCIsImxvZ2luQnV0dG9uIiwiZ2V0QnlSb2xlIiwibmFtZSIsImFjdCIsImZpcmVFdmVudCIsImNsaWNrIiwibG9jYWxTdG9yYWdlIiwic2V0SXRlbSIsIndhaXRGb3IiLCJhY2Nlc3NUb2tlbiIsImdldEl0ZW0iXSwic291cmNlcyI6WyJiYXNlLnN0ZXBzLnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBkZWZpbmVGZWF0dXJlLCBsb2FkRmVhdHVyZSB9IGZyb20gXCJqZXN0LWN1Y3VtYmVyXCI7XHJcbmltcG9ydCB7IGZpcmVFdmVudCwgcmVuZGVyLCB3YWl0Rm9yIH0gZnJvbSBcIkB0ZXN0aW5nLWxpYnJhcnkvcmVhY3RcIjtcclxuaW1wb3J0IFJlYWN0IGZyb20gXCJyZWFjdFwiO1xyXG5pbXBvcnQgXCJAdGVzdGluZy1saWJyYXJ5L2plc3QtZG9tL2V4dGVuZC1leHBlY3RcIjtcclxuaW1wb3J0IFwidGV4dC1lbmNvZGluZ1wiO1xyXG5pbXBvcnQge1xyXG4gIEJyb3dzZXJSb3V0ZXIgYXMgUm91dGVyLFxyXG4gIFJvdXRlcyxcclxuICBSb3V0ZSxcclxuICBNZW1vcnlSb3V0ZXIsXHJcbn0gZnJvbSBcInJlYWN0LXJvdXRlci1kb21cIjtcclxuaW1wb3J0IEJhc2UgZnJvbSBcIi4uLy4uL3BhZ2VzL0Jhc2VcIjtcclxuaW1wb3J0IGF4aW9zIGZyb20gXCJheGlvc1wiO1xyXG5pbXBvcnQgeyBhY3QgfSBmcm9tIFwicmVhY3QtZG9tL3Rlc3QtdXRpbHNcIjtcclxuaW1wb3J0IHsgUHJvdmlkZXIgfSBmcm9tIFwicmVhY3QtcmVkdXhcIjtcclxuaW1wb3J0IHsgY29uZmlndXJlU3RvcmUgfSBmcm9tIFwiQHJlZHV4anMvdG9vbGtpdFwiO1xyXG5pbXBvcnQgc3RyYXZhU2xpY2UgZnJvbSBcIi4uLy4uL3JlZHV4L3JlZHVjZXIvc3RyYXZhU2xpY2VcIjtcclxuY29uc3QgZmVhdHVyZSA9IGxvYWRGZWF0dXJlKFwic3JjL2NvbXBvbmVudHMvZmVhdHVyZXMvYmFzZS5mZWF0dXJlXCIpO1xyXG5sZXQgc3RvcmU6IGFueTtcclxubGV0IHNjcmVlbjogYW55O1xyXG5jb25zdCB7IFJFQUNUX0FQUF9DTElFTlRJRCB9ID0gcHJvY2Vzcy5lbnY7XHJcbmNvbnN0IHsgUkVBQ1RfQVBQX0NMSUVOVF9TRUNSRVQgfSA9IHByb2Nlc3MuZW52O1xyXG5jb25zdCByZWRpcmVjdFVybCA9IFwiaHR0cDovL2xvY2FsaG9zdDozMDAwL3JlZGlyZWN0XCI7XHJcbmNvbnN0IHNjb3BlID0gXCJyZWFkLGFjdGl2aXR5OnJlYWRcIjtcclxuZGVmaW5lRmVhdHVyZShmZWF0dXJlLCAodGVzdCkgPT4ge1xyXG4gIGJlZm9yZUVhY2goKCkgPT4ge1xyXG4gICAgc3RvcmUgPSBjb25maWd1cmVTdG9yZSh7XHJcbiAgICAgIHJlZHVjZXI6IHtcclxuICAgICAgICBzdHJhdmE6IHN0cmF2YVNsaWNlLFxyXG4gICAgICB9LFxyXG4gICAgfSk7XHJcbiAgICBzY3JlZW4gPSByZW5kZXIoXHJcbiAgICAgIDxQcm92aWRlciBzdG9yZT17c3RvcmV9PlxyXG4gICAgICAgIDxSb3V0ZXI+XHJcbiAgICAgICAgICA8Um91dGVzPlxyXG4gICAgICAgICAgICA8Um91dGUgcGF0aD1cIi9cIiBlbGVtZW50PXs8QmFzZSAvPn0gLz5cclxuICAgICAgICAgIDwvUm91dGVzPlxyXG4gICAgICAgIDwvUm91dGVyPlxyXG4gICAgICA8L1Byb3ZpZGVyPlxyXG4gICAgKTtcclxuICB9KTtcclxuICB0ZXN0KCdVc2VyIGlzIG5vdCBsb2dnZWQgaW4gYW5kIGNsaWNrcyBvbiBcIkxvZ2luIHdpdGggU3RyYXZhXCIgYnV0dG9uJywgKHtcclxuICAgIGdpdmVuLFxyXG4gICAgd2hlbixcclxuICAgIHRoZW4sXHJcbiAgICBhbmQsXHJcbiAgfSkgPT4ge1xyXG4gICAgZ2l2ZW4oXCJJIGFtIG9uIHRoZSBob21lIHBhZ2VcIiwgKCkgPT4ge1xyXG4gICAgICBleHBlY3Qoc2NyZWVuKS50b0JlRGVmaW5lZCgpO1xyXG4gICAgfSk7XHJcbiAgICB3aGVuKCdJIGNsaWNrIG9uIFwiTG9naW4gV2l0aCBTdHJhdmFcIiBidXR0b24nLCAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IGxvZ2luQnV0dG9uID0gc2NyZWVuLmdldEJ5Um9sZShcImJ1dHRvblwiLCB7XHJcbiAgICAgICAgbmFtZTogXCJMb2dpbiBXaXRoIFN0cmF2YVwiLFxyXG4gICAgICB9KTtcclxuICAgICAgYWN0KCgpID0+IHtcclxuICAgICAgICBmaXJlRXZlbnQuY2xpY2sobG9naW5CdXR0b24pO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG4gIHRlc3QoXCJVc2VyIGlzIGxvZ2dlZCBpbiBhbmQgb3BlbnMgdGhlIGFwcFwiLCAoeyBnaXZlbiwgd2hlbiwgdGhlbiwgYW5kIH0pID0+IHtcclxuICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFwiYWNjZXNzX3Rva2VuXCIsIFwibW9jay10b2tlblwiKTtcclxuICAgIGdpdmVuKFwiSSBhbSBvbiB0aGUgaG9tZSBwYWdlXCIsICgpID0+IHtcclxuICAgICAgZXhwZWN0KHNjcmVlbikudG9CZURlZmluZWQoKTtcclxuICAgIH0pO1xyXG4gICAgYW5kKFwiSSBhbSBhbHJlYWR5IGxvZ2dlZCBpblwiLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIHdhaXRGb3IoKCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGFjY2Vzc1Rva2VuID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJhY2Nlc3NfdG9rZW5cIik7XHJcbiAgICAgICAgZXhwZWN0KGFjY2Vzc1Rva2VuKS50b0JlRGVmaW5lZCgpO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gICAgdGhlbignSSBzaG91bGQgYmUgcmVkaXJlY3RlZCB0byB0aGUgXCJBY3Rpdml0aWVzXCIgc2NyZWVuJywgKCkgPT4ge30pO1xyXG4gIH0pO1xyXG59KTtcclxuIl0sIm1hcHBpbmdzIjoiOztBQUFBLElBQUFBLGFBQUEsR0FBQUMsT0FBQTtBQUNBLElBQUFDLE1BQUEsR0FBQUQsT0FBQTtBQUNBLElBQUFFLE9BQUEsR0FBQUMsc0JBQUEsQ0FBQUgsT0FBQTtBQUNBQSxPQUFBO0FBQ0FBLE9BQUE7QUFDQSxJQUFBSSxlQUFBLEdBQUFKLE9BQUE7QUFNQSxJQUFBSyxLQUFBLEdBQUFGLHNCQUFBLENBQUFILE9BQUE7QUFFQSxJQUFBTSxVQUFBLEdBQUFOLE9BQUE7QUFDQSxJQUFBTyxXQUFBLEdBQUFQLE9BQUE7QUFDQSxJQUFBUSxRQUFBLEdBQUFSLE9BQUE7QUFDQSxJQUFBUyxZQUFBLEdBQUFOLHNCQUFBLENBQUFILE9BQUE7QUFBMEQsU0FBQUcsdUJBQUFPLEdBQUEsV0FBQUEsR0FBQSxJQUFBQSxHQUFBLENBQUFDLFVBQUEsR0FBQUQsR0FBQSxLQUFBRSxPQUFBLEVBQUFGLEdBQUE7QUFDMUQsTUFBTUcsT0FBTyxHQUFH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