aed1a99908bda3f5f3dd43b2865a762b
"use strict";

var _jestCucumber = require("jest-cucumber");
var _react = require("@testing-library/react");
var _react2 = _interopRequireDefault(require("react"));
require("@testing-library/jest-dom/extend-expect");
require("text-encoding");
var _reactRouterDom = require("react-router-dom");
var _Base = _interopRequireDefault(require("../../pages/Base"));
var _testUtils = require("react-dom/test-utils");
var _reactRedux = require("react-redux");
var _toolkit = require("@reduxjs/toolkit");
var _stravaSlice = _interopRequireDefault(require("../../redux/reducer/stravaSlice"));
function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }
const feature = (0, _jestCucumber.loadFeature)("src/components/features/base.feature");
let store;
let screen;
const {
  REACT_APP_CLIENTID
} = process.env;
const {
  REACT_APP_CLIENT_SECRET
} = process.env;
const redirectUrl = "http://localhost:3000/redirect";
const scope = "read,activity:read";
(0, _jestCucumber.defineFeature)(feature, test => {
  beforeEach(() => {
    store = (0, _toolkit.configureStore)({
      reducer: {
        strava: _stravaSlice.default
      }
    });
    screen = (0, _react.render)( /*#__PURE__*/_react2.default.createElement(_reactRedux.Provider, {
      store: store
    }, /*#__PURE__*/_react2.default.createElement(_reactRouterDom.BrowserRouter, null, /*#__PURE__*/_react2.default.createElement(_reactRouterDom.Routes, null, /*#__PURE__*/_react2.default.createElement(_reactRouterDom.Route, {
      path: "/",
      element: /*#__PURE__*/_react2.default.createElement(_Base.default, null)
    })))));
  });
  test('User is not logged in and clicks on "Login with Strava" button', ({
    given,
    when,
    then,
    and
  }) => {
    given("I am on the home page", () => {
      expect(screen).toBeDefined();
    });
    when('I click on "Login With Strava" button', () => {
      const loginButton = screen.getByRole("button", {
        name: "Login With Strava"
      });
      (0, _testUtils.act)(() => {
        _react.fireEvent.click(loginButton);
      });
    });
    then("I should be redirected to the Strava login page", async () => {
      const handleLogin = jest.fn();
      await (0, _react.waitFor)(() => {
        expect(global.window.location.assign).toHaveBeenCalledWith(expect.stringContaining("http://www.strava.com/oauth/authorize"));
      });
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfamVzdEN1Y3VtYmVyIiwicmVxdWlyZSIsIl9yZWFjdCIsIl9yZWFjdDIiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwiX3JlYWN0Um91dGVyRG9tIiwiX0Jhc2UiLCJfdGVzdFV0aWxzIiwiX3JlYWN0UmVkdXgiLCJfdG9vbGtpdCIsIl9zdHJhdmFTbGljZSIsIm9iaiIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiZmVhdHVyZSIsImxvYWRGZWF0dXJlIiwic3RvcmUiLCJzY3JlZW4iLCJSRUFDVF9BUFBfQ0xJRU5USUQiLCJwcm9jZXNzIiwiZW52IiwiUkVBQ1RfQVBQX0NMSUVOVF9TRUNSRVQiLCJyZWRpcmVjdFVybCIsInNjb3BlIiwiZGVmaW5lRmVhdHVyZSIsInRlc3QiLCJiZWZvcmVFYWNoIiwiY29uZmlndXJlU3RvcmUiLCJyZWR1Y2VyIiwic3RyYXZhIiwic3RyYXZhU2xpY2UiLCJyZW5kZXIiLCJjcmVhdGVFbGVtZW50IiwiUHJvdmlkZXIiLCJCcm93c2VyUm91dGVyIiwiUm91dGVzIiwiUm91dGUiLCJwYXRoIiwiZWxlbWVudCIsImdpdmVuIiwid2hlbiIsInRoZW4iLCJhbmQiLCJleHBlY3QiLCJ0b0JlRGVmaW5lZCIsImxvZ2luQnV0dG9uIiwiZ2V0QnlSb2xlIiwibmFtZSIsImFjdCIsImZpcmVFdmVudCIsImNsaWNrIiwiaGFuZGxlTG9naW4iLCJqZXN0IiwiZm4iLCJ3YWl0Rm9yIiwiZ2xvYmFsIiwid2luZG93IiwibG9jYXRpb24iLCJhc3NpZ24iLCJ0b0hhdmVCZWVuQ2FsbGVkV2l0aCIsInN0cmluZ0NvbnRhaW5pbmciXSwic291cmNlcyI6WyJiYXNlLnN0ZXBzLnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBkZWZpbmVGZWF0dXJlLCBsb2FkRmVhdHVyZSB9IGZyb20gXCJqZXN0LWN1Y3VtYmVyXCI7XHJcbmltcG9ydCB7IGZpcmVFdmVudCwgcmVuZGVyLCB3YWl0Rm9yIH0gZnJvbSBcIkB0ZXN0aW5nLWxpYnJhcnkvcmVhY3RcIjtcclxuaW1wb3J0IFJlYWN0IGZyb20gXCJyZWFjdFwiO1xyXG5pbXBvcnQgXCJAdGVzdGluZy1saWJyYXJ5L2plc3QtZG9tL2V4dGVuZC1leHBlY3RcIjtcclxuaW1wb3J0IFwidGV4dC1lbmNvZGluZ1wiO1xyXG5pbXBvcnQge1xyXG4gIEJyb3dzZXJSb3V0ZXIgYXMgUm91dGVyLFxyXG4gIFJvdXRlcyxcclxuICBSb3V0ZSxcclxuICBNZW1vcnlSb3V0ZXIsXHJcbn0gZnJvbSBcInJlYWN0LXJvdXRlci1kb21cIjtcclxuaW1wb3J0IEJhc2UgZnJvbSBcIi4uLy4uL3BhZ2VzL0Jhc2VcIjtcclxuaW1wb3J0IGF4aW9zIGZyb20gXCJheGlvc1wiO1xyXG5pbXBvcnQgeyBhY3QgfSBmcm9tIFwicmVhY3QtZG9tL3Rlc3QtdXRpbHNcIjtcclxuaW1wb3J0IHsgUHJvdmlkZXIgfSBmcm9tIFwicmVhY3QtcmVkdXhcIjtcclxuaW1wb3J0IHsgY29uZmlndXJlU3RvcmUgfSBmcm9tIFwiQHJlZHV4anMvdG9vbGtpdFwiO1xyXG5pbXBvcnQgc3RyYXZhU2xpY2UgZnJvbSBcIi4uLy4uL3JlZHV4L3JlZHVjZXIvc3RyYXZhU2xpY2VcIjtcclxuY29uc3QgZmVhdHVyZSA9IGxvYWRGZWF0dXJlKFwic3JjL2NvbXBvbmVudHMvZmVhdHVyZXMvYmFzZS5mZWF0dXJlXCIpO1xyXG5cclxubGV0IHN0b3JlOiBhbnk7XHJcbmxldCBzY3JlZW46IGFueTtcclxuY29uc3QgeyBSRUFDVF9BUFBfQ0xJRU5USUQgfSA9IHByb2Nlc3MuZW52O1xyXG5jb25zdCB7IFJFQUNUX0FQUF9DTElFTlRfU0VDUkVUIH0gPSBwcm9jZXNzLmVudjtcclxuY29uc3QgcmVkaXJlY3RVcmwgPSBcImh0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9yZWRpcmVjdFwiO1xyXG5jb25zdCBzY29wZSA9IFwicmVhZCxhY3Rpdml0eTpyZWFkXCI7XHJcbmRlZmluZUZlYXR1cmUoZmVhdHVyZSwgKHRlc3QpID0+IHtcclxuICBiZWZvcmVFYWNoKCgpID0+IHtcclxuICAgIHN0b3JlID0gY29uZmlndXJlU3RvcmUoe1xyXG4gICAgICByZWR1Y2VyOiB7XHJcbiAgICAgICAgc3RyYXZhOiBzdHJhdmFTbGljZSxcclxuICAgICAgfSxcclxuICAgIH0pO1xyXG4gICAgc2NyZWVuID0gcmVuZGVyKFxyXG4gICAgICA8UHJvdmlkZXIgc3RvcmU9e3N0b3JlfT5cclxuICAgICAgICA8Um91dGVyPlxyXG4gICAgICAgICAgPFJvdXRlcz5cclxuICAgICAgICAgICAgPFJvdXRlIHBhdGg9XCIvXCIgZWxlbWVudD17PEJhc2UgLz59IC8+XHJcbiAgICAgICAgICA8L1JvdXRlcz5cclxuICAgICAgICA8L1JvdXRlcj5cclxuICAgICAgPC9Qcm92aWRlcj5cclxuICAgICk7XHJcbiAgfSk7XHJcbiAgdGVzdCgnVXNlciBpcyBub3QgbG9nZ2VkIGluIGFuZCBjbGlja3Mgb24gXCJMb2dpbiB3aXRoIFN0cmF2YVwiIGJ1dHRvbicsICh7XHJcbiAgICBnaXZlbixcclxuICAgIHdoZW4sXHJcbiAgICB0aGVuLFxyXG4gICAgYW5kLFxyXG4gIH0pID0+IHtcclxuICAgIGdpdmVuKFwiSSBhbSBvbiB0aGUgaG9tZSBwYWdlXCIsICgpID0+IHtcclxuICAgICAgZXhwZWN0KHNjcmVlbikudG9CZURlZmluZWQoKTtcclxuICAgIH0pO1xyXG4gICAgd2hlbignSSBjbGljayBvbiBcIkxvZ2luIFdpdGggU3RyYXZhXCIgYnV0dG9uJywgKCkgPT4ge1xyXG4gICAgICBjb25zdCBsb2dpbkJ1dHRvbiA9IHNjcmVlbi5nZXRCeVJvbGUoXCJidXR0b25cIiwge1xyXG4gICAgICAgIG5hbWU6IFwiTG9naW4gV2l0aCBTdHJhdmFcIixcclxuICAgICAgfSk7XHJcbiAgICAgIGFjdCgoKSA9PiB7XHJcbiAgICAgICAgZmlyZUV2ZW50LmNsaWNrKGxvZ2luQnV0dG9uKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICAgIHRoZW4oXCJJIHNob3VsZCBiZSByZWRpcmVjdGVkIHRvIHRoZSBTdHJhdmEgbG9naW4gcGFnZVwiLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IGhhbmRsZUxvZ2luID0gamVzdC5mbigpO1xyXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcclxuICAgICAgICBleHBlY3QoZ2xvYmFsLndpbmRvdy5sb2NhdGlvbi5hc3NpZ24pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxyXG4gICAgICAgICAgZXhwZWN0LnN0cmluZ0NvbnRhaW5pbmcoXCJodHRwOi8vd3d3LnN0cmF2YS5jb20vb2F1dGgvYXV0aG9yaXplXCIpXHJcbiAgICAgICAgKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9KTtcclxufSk7XHJcbiJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxJQUFBQSxhQUFBLEdBQUFDLE9BQUE7QUFDQSxJQUFBQyxNQUFBLEdBQUFELE9BQUE7QUFDQSxJQUFBRSxPQUFBLEdBQUFDLHNCQUFBLENBQUFILE9BQUE7QUFDQUEsT0FBQTtBQUNBQSxPQUFBO0FBQ0EsSUFBQUksZUFBQSxHQUFBSixPQUFBO0FBTUEsSUFBQUssS0FBQSxHQUFBRixzQkFBQSxDQUFBSCxPQUFBO0FBRUEsSUFBQU0sVUFBQSxHQUFBTixPQUFBO0FBQ0EsSUFBQU8sV0FBQSxHQUFBUCxPQUFBO0FBQ0EsSUFBQVEsUUFBQSxHQUFBUixPQUFBO0FBQ0EsSUFBQVMsWUFBQSxHQUFBTixzQkFBQSxDQUFBSCxPQUFBO0FBQTBELFNBQUFHLHVCQUFBTyxHQUFBLFdBQUFBLEdBQUEsSUFBQUEsR0FBQSxDQUFBQyxVQUFBLEdBQUFELEdBQUEsS0FBQUUsT0FBQSxFQUFBRixHQUFBO0FBQzFELE1BQU1HLE9BQU8sR0FBRyxJQUFBQyx5QkFBVyxFQUFDLHNDQUFzQyxDQUFDO0FBRW5FLElBQUlDLEtBQVU7QUFDZCxJQUFJQyxNQUFXO0FBQ2YsTUFBTTtFQUFFQztBQUFtQixDQUFDLEdBQUdDLE9BQU8sQ0FBQ0MsR0FBRztBQUMxQyxNQUFNO0VBQUVDO0FBQXdCLENBQUMsR0FBR0YsT0FBTyxDQUFDQyxHQUFHO0FBQy9DLE1BQU1FLFdBQVcsR0FBRyxnQ0FBZ0M7QUFDcEQsTUFBTUMsS0FBSyxHQUFHLG9CQUFvQjtBQUNsQyxJQUFBQywyQkFBYSxFQUFDVixPQUFPLEVBQUdXLElBQUksSUFBSztFQUMvQkMsVUFBVSxDQUFDLE1BQU07SUFDZlYsS0FBSyxHQUFHLElBQUFXLHVCQUFjLEVBQUM7TUFDckJDLE9BQU8sRUFBRTtRQUNQQyxNQUFNLEVBQUVDO01BQ1Y7SUFDRixDQUFDLENBQUM7SUFDRmIsTUFBTSxHQUFHLElBQUFjLGFBQU0sZ0JBQ2I1QixPQUFBLENBQUFVLE9BQUEsQ0FBQW1CLGFBQUEsQ0FBQ3hCLFdBQUEsQ0FBQXlCLFFBQVE7TUFBQ2pCLEtBQUssRUFBRUE7SUFBTSxnQkFDckJiLE9BQUEsQ0FBQVUsT0FBQSxDQUFBbUIsYUFBQSxDQUFDM0IsZUFBQSxDQUFBNkIsYUFBTSxxQkFDTC9CLE9BQUEsQ0FBQVUsT0FBQSxDQUFBbUIsYUFBQSxDQUFDM0IsZUFBQSxDQUFBOEIsTUFBTSxxQkFDTGhDLE9BQUEsQ0FBQVUsT0FBQSxDQUFBbUIsYUFBQSxDQUFDM0IsZUFBQSxDQUFBK0IsS0FBSztNQUFDQyxJQUFJLEVBQUMsR0FBRztNQUFDQyxPQUFPLGVBQUVuQyxPQUFBLENBQUFVLE9BQUEsQ0FBQW1CLGFBQUEsQ0FBQzFCLEtBQUEsQ0FBQU8sT0FBSTtJQUFJLEVBQUcsQ0FDOUIsQ0FDRixDQUNBLENBQ1o7RUFDSCxDQUFDLENBQUM7RUFDRlksSUFBSSxDQUFDLGdFQUFnRSxFQUFFLENBQUM7SUFDdEVjLEtBQUs7SUFDTEMsSUFBSTtJQUNKQyxJQUFJO0lBQ0pDO0VBQ0YsQ0FBQyxLQUFLO0lBQ0pILEtBQUssQ0FBQyx1QkFBdUIsRUFBRSxNQUFNO01BQ25DSSxNQUFNLENBQUMxQixNQUFNLENBQUMsQ0FBQzJCLFdBQVcsRUFBRTtJQUM5QixDQUFDLENBQUM7SUFDRkosSUFBSSxDQUFDLHVDQUF1QyxFQUFFLE1BQU07TUFDbEQsTUFBTUssV0FBVyxHQUFHNUIsTUFBTSxDQUFDNkIsU0FBUyxDQUFDLFFBQVEsRUFBRTtRQUM3Q0MsSUFBSSxFQUFFO01BQ1IsQ0FBQyxDQUFDO01BQ0YsSUFBQUMsY0FBRyxFQUFDLE1BQU07UUFDUkMsZ0JBQVMsQ0FBQ0MsS0FBSyxDQUFDTCxXQUFXLENBQUM7TUFDOUIsQ0FBQyxDQUFDO0lBQ0osQ0FBQyxDQUFDO0lBQ0ZKLElBQUksQ0FBQyxpREFBaUQsRUFBRSxZQUFZO01BQ2xFLE1BQU1VLFdBQVcsR0FBR0MsSUFBSSxDQUFDQyxFQUFFLEVBQUU7TUFDN0IsTUFBTSxJQUFBQyxjQUFPLEVBQUMsTUFBTTtRQUNsQlgsTUFBTSxDQUFDWSxNQUFNLENBQUNDLE1BQU0sQ0FBQ0MsUUFBUSxDQUFDQyxNQUFNLENBQUMsQ0FBQ0Msb0JBQW9CLENBQ3hEaEIsTUFBTSxDQUFDaUIsZ0JBQWdCLENBQUMsdUNBQXVDLENBQUMsQ0FDakU7TUFDSCxDQUFDLENBQUM7SUFDSixDQUFDLENBQUM7RUFDSixDQUFDLENBQUM7QUFDSixDQUFDLENBQUMifQ==