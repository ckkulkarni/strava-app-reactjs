7b14cde3df48e6117ac029cf6471f2b7
'use strict';

Object.defineProperty(exports, '__esModule', {
  value: true
});
exports.default = void 0;
function _chalk() {
  const data = _interopRequireDefault(require('chalk'));
  _chalk = function () {
    return data;
  };
  return data;
}
function _emittery() {
  const data = _interopRequireDefault(require('emittery'));
  _emittery = function () {
    return data;
  };
  return data;
}
function _throat() {
  const data = _interopRequireDefault(require('throat'));
  _throat = function () {
    return data;
  };
  return data;
}
function _jestUtil() {
  const data = require('jest-util');
  _jestUtil = function () {
    return data;
  };
  return data;
}
function _jestWorker() {
  const data = require('jest-worker');
  _jestWorker = function () {
    return data;
  };
  return data;
}
var _runTest = _interopRequireDefault(require('./runTest'));
function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : {
    default: obj
  };
}
function _defineProperty(obj, key, value) {
  if (key in obj) {
    Object.defineProperty(obj, key, {
      value: value,
      enumerable: true,
      configurable: true,
      writable: true
    });
  } else {
    obj[key] = value;
  }
  return obj;
}
const TEST_WORKER_PATH = require.resolve('./testWorker');
class TestRunner {
  constructor(globalConfig, context) {
    _defineProperty(this, '_globalConfig', void 0);
    _defineProperty(this, '_context', void 0);
    _defineProperty(this, 'eventEmitter', new (_emittery().default)());
    _defineProperty(this, '__PRIVATE_UNSTABLE_API_supportsEventEmitters__', true);
    _defineProperty(this, 'isSerial', void 0);
    this._globalConfig = globalConfig;
    this._context = context || {};
  }
  async runTests(tests, watcher, onStart, onResult, onFailure, options) {
    return await (options.serial ? this._createInBandTestRun(tests, watcher, onStart, onResult, onFailure) : this._createParallelTestRun(tests, watcher, onStart, onResult, onFailure));
  }
  async _createInBandTestRun(tests, watcher, onStart, onResult, onFailure) {
    process.env.JEST_WORKER_ID = '1';
    const mutex = (0, _throat().default)(1);
    return tests.reduce((promise, test) => mutex(() => promise.then(async () => {
      if (watcher.isInterrupted()) {
        throw new CancelRun();
      } // Remove `if(onStart)` in Jest 27

      if (onStart) {
        await onStart(test);
        return (0, _runTest.default)(test.path, this._globalConfig, test.context.config, test.context.resolver, this._context, undefined);
      } // `deepCyclicCopy` used here to avoid mem-leak

      const sendMessageToJest = (eventName, args) => this.eventEmitter.emit(eventName, (0, _jestUtil().deepCyclicCopy)(args, {
        keepPrototype: false
      }));
      await this.eventEmitter.emit('test-file-start', [test]);
      return (0, _runTest.default)(test.path, this._globalConfig, test.context.config, test.context.resolver, this._context, sendMessageToJest);
    }).then(result => {
      if (onResult) {
        return onResult(test, result);
      }
      return this.eventEmitter.emit('test-file-success', [test, result]);
    }).catch(err => {
      if (onFailure) {
        return onFailure(test, err);
      }
      return this.eventEmitter.emit('test-file-failure', [test, err]);
    })), Promise.resolve());
  }
  async _createParallelTestRun(tests, watcher, onStart, onResult, onFailure) {
    const resolvers = new Map();
    for (const test of tests) {
      if (!resolvers.has(test.context.config.name)) {
        resolvers.set(test.context.config.name, {
          config: test.context.config,
          serializableModuleMap: test.context.moduleMap.toJSON()
        });
      }
    }
    const worker = new (_jestWorker().Worker)(TEST_WORKER_PATH, {
      exposedMethods: ['worker'],
      forkOptions: {
        stdio: 'pipe'
      },
      maxRetries: 3,
      numWorkers: this._globalConfig.maxWorkers,
      setupArgs: [{
        serializableResolvers: Array.from(resolvers.values())
      }]
    });
    if (worker.getStdout()) worker.getStdout().pipe(process.stdout);
    if (worker.getStderr()) worker.getStderr().pipe(process.stderr);
    const mutex = (0, _throat().default)(this._globalConfig.maxWorkers); // Send test suites to workers continuously instead of all at once to track
    // the start time of individual tests.

    const runTestInWorker = test => mutex(async () => {
      if (watcher.isInterrupted()) {
        return Promise.reject();
      } // Remove `if(onStart)` in Jest 27

      if (onStart) {
        await onStart(test);
      } else {
        await this.eventEmitter.emit('test-file-start', [test]);
      }
      const promise = worker.worker({
        config: test.context.config,
        context: {
          ...this._context,
          changedFiles: this._context.changedFiles && Array.from(this._context.changedFiles),
          sourcesRelatedToTestsInChangedFiles: this._context.sourcesRelatedToTestsInChangedFiles && Array.from(this._context.sourcesRelatedToTestsInChangedFiles)
        },
        globalConfig: this._globalConfig,
        path: test.path
      });
      if (promise.UNSTABLE_onCustomMessage) {
        // TODO: Get appropriate type for `onCustomMessage`
        promise.UNSTABLE_onCustomMessage(([event, payload]) => {
          this.eventEmitter.emit(event, payload);
        });
      }
      return promise;
    });
    const onInterrupt = new Promise((_, reject) => {
      watcher.on('change', state => {
        if (state.interrupted) {
          reject(new CancelRun());
        }
      });
    });
    const runAllTests = Promise.all(tests.map(test => runTestInWorker(test).then(result => {
      if (onResult) {
        return onResult(test, result);
      }
      return this.eventEmitter.emit('test-file-success', [test, result]);
    }).catch(error => {
      if (onFailure) {
        return onFailure(test, error);
      }
      return this.eventEmitter.emit('test-file-failure', [test, error]);
    })));
    const cleanup = async () => {
      const {
        forceExited
      } = await worker.end();
      if (forceExited) {
        console.error(_chalk().default.yellow('A worker process has failed to exit gracefully and has been force exited. ' + 'This is likely caused by tests leaking due to improper teardown. ' + 'Try running with --detectOpenHandles to find leaks. ' + 'Active timers can also cause this, ensure that .unref() was called on them.'));
      }
    };
    return Promise.race([runAllTests, onInterrupt]).then(cleanup, cleanup);
  }
  on(eventName, listener) {
    return this.eventEmitter.on(eventName, listener);
  }
}
exports.default = TestRunner;
class CancelRun extends Error {
  constructor(message) {
    super(message);
    this.name = 'CancelRun';
  }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImV4cG9ydHMiLCJ2YWx1ZSIsImRlZmF1bHQiLCJfY2hhbGsiLCJkYXRhIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInJlcXVpcmUiLCJfZW1pdHRlcnkiLCJfdGhyb2F0IiwiX2plc3RVdGlsIiwiX2plc3RXb3JrZXIiLCJfcnVuVGVzdCIsIm9iaiIsIl9fZXNNb2R1bGUiLCJfZGVmaW5lUHJvcGVydHkiLCJrZXkiLCJlbnVtZXJhYmxlIiwiY29uZmlndXJhYmxlIiwid3JpdGFibGUiLCJURVNUX1dPUktFUl9QQVRIIiwicmVzb2x2ZSIsIlRlc3RSdW5uZXIiLCJjb25zdHJ1Y3RvciIsImdsb2JhbENvbmZpZyIsImNvbnRleHQiLCJfZ2xvYmFsQ29uZmlnIiwiX2NvbnRleHQiLCJydW5UZXN0cyIsInRlc3RzIiwid2F0Y2hlciIsIm9uU3RhcnQiLCJvblJlc3VsdCIsIm9uRmFpbHVyZSIsIm9wdGlvbnMiLCJzZXJpYWwiLCJfY3JlYXRlSW5CYW5kVGVzdFJ1biIsIl9jcmVhdGVQYXJhbGxlbFRlc3RSdW4iLCJwcm9jZXNzIiwiZW52IiwiSkVTVF9XT1JLRVJfSUQiLCJtdXRleCIsInJlZHVjZSIsInByb21pc2UiLCJ0ZXN0IiwidGhlbiIsImlzSW50ZXJydXB0ZWQiLCJDYW5jZWxSdW4iLCJwYXRoIiwiY29uZmlnIiwicmVzb2x2ZXIiLCJ1bmRlZmluZWQiLCJzZW5kTWVzc2FnZVRvSmVzdCIsImV2ZW50TmFtZSIsImFyZ3MiLCJldmVudEVtaXR0ZXIiLCJlbWl0IiwiZGVlcEN5Y2xpY0NvcHkiLCJrZWVwUHJvdG90eXBlIiwicmVzdWx0IiwiY2F0Y2giLCJlcnIiLCJQcm9taXNlIiwicmVzb2x2ZXJzIiwiTWFwIiwiaGFzIiwibmFtZSIsInNldCIsInNlcmlhbGl6YWJsZU1vZHVsZU1hcCIsIm1vZHVsZU1hcCIsInRvSlNPTiIsIndvcmtlciIsIldvcmtlciIsImV4cG9zZWRNZXRob2RzIiwiZm9ya09wdGlvbnMiLCJzdGRpbyIsIm1heFJldHJpZXMiLCJudW1Xb3JrZXJzIiwibWF4V29ya2VycyIsInNldHVwQXJncyIsInNlcmlhbGl6YWJsZVJlc29sdmVycyIsIkFycmF5IiwiZnJvbSIsInZhbHVlcyIsImdldFN0ZG91dCIsInBpcGUiLCJzdGRvdXQiLCJnZXRTdGRlcnIiLCJzdGRlcnIiLCJydW5UZXN0SW5Xb3JrZXIiLCJyZWplY3QiLCJjaGFuZ2VkRmlsZXMiLCJzb3VyY2VzUmVsYXRlZFRvVGVzdHNJbkNoYW5nZWRGaWxlcyIsIlVOU1RBQkxFX29uQ3VzdG9tTWVzc2FnZSIsImV2ZW50IiwicGF5bG9hZCIsIm9uSW50ZXJydXB0IiwiXyIsIm9uIiwic3RhdGUiLCJpbnRlcnJ1cHRlZCIsInJ1bkFsbFRlc3RzIiwiYWxsIiwibWFwIiwiZXJyb3IiLCJjbGVhbnVwIiwiZm9yY2VFeGl0ZWQiLCJlbmQiLCJjb25zb2xlIiwieWVsbG93IiwicmFjZSIsImxpc3RlbmVyIiwiRXJyb3IiLCJtZXNzYWdlIl0sInNvdXJjZXMiOlsiaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcblxuZnVuY3Rpb24gX2NoYWxrKCkge1xuICBjb25zdCBkYXRhID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCdjaGFsaycpKTtcblxuICBfY2hhbGsgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIGRhdGE7XG4gIH07XG5cbiAgcmV0dXJuIGRhdGE7XG59XG5cbmZ1bmN0aW9uIF9lbWl0dGVyeSgpIHtcbiAgY29uc3QgZGF0YSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgnZW1pdHRlcnknKSk7XG5cbiAgX2VtaXR0ZXJ5ID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBkYXRhO1xuICB9O1xuXG4gIHJldHVybiBkYXRhO1xufVxuXG5mdW5jdGlvbiBfdGhyb2F0KCkge1xuICBjb25zdCBkYXRhID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCd0aHJvYXQnKSk7XG5cbiAgX3Rocm9hdCA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gZGF0YTtcbiAgfTtcblxuICByZXR1cm4gZGF0YTtcbn1cblxuZnVuY3Rpb24gX2plc3RVdGlsKCkge1xuICBjb25zdCBkYXRhID0gcmVxdWlyZSgnamVzdC11dGlsJyk7XG5cbiAgX2plc3RVdGlsID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBkYXRhO1xuICB9O1xuXG4gIHJldHVybiBkYXRhO1xufVxuXG5mdW5jdGlvbiBfamVzdFdvcmtlcigpIHtcbiAgY29uc3QgZGF0YSA9IHJlcXVpcmUoJ2plc3Qtd29ya2VyJyk7XG5cbiAgX2plc3RXb3JrZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIGRhdGE7XG4gIH07XG5cbiAgcmV0dXJuIGRhdGE7XG59XG5cbnZhciBfcnVuVGVzdCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgnLi9ydW5UZXN0JykpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikge1xuICByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDoge2RlZmF1bHQ6IG9ian07XG59XG5cbmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHtcbiAgaWYgKGtleSBpbiBvYmopIHtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHtcbiAgICAgIHZhbHVlOiB2YWx1ZSxcbiAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICB3cml0YWJsZTogdHJ1ZVxuICAgIH0pO1xuICB9IGVsc2Uge1xuICAgIG9ialtrZXldID0gdmFsdWU7XG4gIH1cbiAgcmV0dXJuIG9iajtcbn1cblxuY29uc3QgVEVTVF9XT1JLRVJfUEFUSCA9IHJlcXVpcmUucmVzb2x2ZSgnLi90ZXN0V29ya2VyJyk7XG5cbmNsYXNzIFRlc3RSdW5uZXIge1xuICBjb25zdHJ1Y3RvcihnbG9iYWxDb25maWcsIGNvbnRleHQpIHtcbiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgJ19nbG9iYWxDb25maWcnLCB2b2lkIDApO1xuXG4gICAgX2RlZmluZVByb3BlcnR5KHRoaXMsICdfY29udGV4dCcsIHZvaWQgMCk7XG5cbiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgJ2V2ZW50RW1pdHRlcicsIG5ldyAoX2VtaXR0ZXJ5KCkuZGVmYXVsdCkoKSk7XG5cbiAgICBfZGVmaW5lUHJvcGVydHkoXG4gICAgICB0aGlzLFxuICAgICAgJ19fUFJJVkFURV9VTlNUQUJMRV9BUElfc3VwcG9ydHNFdmVudEVtaXR0ZXJzX18nLFxuICAgICAgdHJ1ZVxuICAgICk7XG5cbiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgJ2lzU2VyaWFsJywgdm9pZCAwKTtcblxuICAgIHRoaXMuX2dsb2JhbENvbmZpZyA9IGdsb2JhbENvbmZpZztcbiAgICB0aGlzLl9jb250ZXh0ID0gY29udGV4dCB8fCB7fTtcbiAgfVxuXG4gIGFzeW5jIHJ1blRlc3RzKHRlc3RzLCB3YXRjaGVyLCBvblN0YXJ0LCBvblJlc3VsdCwgb25GYWlsdXJlLCBvcHRpb25zKSB7XG4gICAgcmV0dXJuIGF3YWl0IChvcHRpb25zLnNlcmlhbFxuICAgICAgPyB0aGlzLl9jcmVhdGVJbkJhbmRUZXN0UnVuKHRlc3RzLCB3YXRjaGVyLCBvblN0YXJ0LCBvblJlc3VsdCwgb25GYWlsdXJlKVxuICAgICAgOiB0aGlzLl9jcmVhdGVQYXJhbGxlbFRlc3RSdW4oXG4gICAgICAgICAgdGVzdHMsXG4gICAgICAgICAgd2F0Y2hlcixcbiAgICAgICAgICBvblN0YXJ0LFxuICAgICAgICAgIG9uUmVzdWx0LFxuICAgICAgICAgIG9uRmFpbHVyZVxuICAgICAgICApKTtcbiAgfVxuXG4gIGFzeW5jIF9jcmVhdGVJbkJhbmRUZXN0UnVuKHRlc3RzLCB3YXRjaGVyLCBvblN0YXJ0LCBvblJlc3VsdCwgb25GYWlsdXJlKSB7XG4gICAgcHJvY2Vzcy5lbnYuSkVTVF9XT1JLRVJfSUQgPSAnMSc7XG4gICAgY29uc3QgbXV0ZXggPSAoMCwgX3Rocm9hdCgpLmRlZmF1bHQpKDEpO1xuICAgIHJldHVybiB0ZXN0cy5yZWR1Y2UoXG4gICAgICAocHJvbWlzZSwgdGVzdCkgPT5cbiAgICAgICAgbXV0ZXgoKCkgPT5cbiAgICAgICAgICBwcm9taXNlXG4gICAgICAgICAgICAudGhlbihhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgIGlmICh3YXRjaGVyLmlzSW50ZXJydXB0ZWQoKSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBDYW5jZWxSdW4oKTtcbiAgICAgICAgICAgICAgfSAvLyBSZW1vdmUgYGlmKG9uU3RhcnQpYCBpbiBKZXN0IDI3XG5cbiAgICAgICAgICAgICAgaWYgKG9uU3RhcnQpIHtcbiAgICAgICAgICAgICAgICBhd2FpdCBvblN0YXJ0KHRlc3QpO1xuICAgICAgICAgICAgICAgIHJldHVybiAoMCwgX3J1blRlc3QuZGVmYXVsdCkoXG4gICAgICAgICAgICAgICAgICB0ZXN0LnBhdGgsXG4gICAgICAgICAgICAgICAgICB0aGlzLl9nbG9iYWxDb25maWcsXG4gICAgICAgICAgICAgICAgICB0ZXN0LmNvbnRleHQuY29uZmlnLFxuICAgICAgICAgICAgICAgICAgdGVzdC5jb250ZXh0LnJlc29sdmVyLFxuICAgICAgICAgICAgICAgICAgdGhpcy5fY29udGV4dCxcbiAgICAgICAgICAgICAgICAgIHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgIH0gLy8gYGRlZXBDeWNsaWNDb3B5YCB1c2VkIGhlcmUgdG8gYXZvaWQgbWVtLWxlYWtcblxuICAgICAgICAgICAgICBjb25zdCBzZW5kTWVzc2FnZVRvSmVzdCA9IChldmVudE5hbWUsIGFyZ3MpID0+XG4gICAgICAgICAgICAgICAgdGhpcy5ldmVudEVtaXR0ZXIuZW1pdChcbiAgICAgICAgICAgICAgICAgIGV2ZW50TmFtZSxcbiAgICAgICAgICAgICAgICAgICgwLCBfamVzdFV0aWwoKS5kZWVwQ3ljbGljQ29weSkoYXJncywge1xuICAgICAgICAgICAgICAgICAgICBrZWVwUHJvdG90eXBlOiBmYWxzZVxuICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAgIGF3YWl0IHRoaXMuZXZlbnRFbWl0dGVyLmVtaXQoJ3Rlc3QtZmlsZS1zdGFydCcsIFt0ZXN0XSk7XG4gICAgICAgICAgICAgIHJldHVybiAoMCwgX3J1blRlc3QuZGVmYXVsdCkoXG4gICAgICAgICAgICAgICAgdGVzdC5wYXRoLFxuICAgICAgICAgICAgICAgIHRoaXMuX2dsb2JhbENvbmZpZyxcbiAgICAgICAgICAgICAgICB0ZXN0LmNvbnRleHQuY29uZmlnLFxuICAgICAgICAgICAgICAgIHRlc3QuY29udGV4dC5yZXNvbHZlcixcbiAgICAgICAgICAgICAgICB0aGlzLl9jb250ZXh0LFxuICAgICAgICAgICAgICAgIHNlbmRNZXNzYWdlVG9KZXN0XG4gICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLnRoZW4ocmVzdWx0ID0+IHtcbiAgICAgICAgICAgICAgaWYgKG9uUmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG9uUmVzdWx0KHRlc3QsIHJlc3VsdCk7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICByZXR1cm4gdGhpcy5ldmVudEVtaXR0ZXIuZW1pdCgndGVzdC1maWxlLXN1Y2Nlc3MnLCBbXG4gICAgICAgICAgICAgICAgdGVzdCxcbiAgICAgICAgICAgICAgICByZXN1bHRcbiAgICAgICAgICAgICAgXSk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmNhdGNoKGVyciA9PiB7XG4gICAgICAgICAgICAgIGlmIChvbkZhaWx1cmUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gb25GYWlsdXJlKHRlc3QsIGVycik7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICByZXR1cm4gdGhpcy5ldmVudEVtaXR0ZXIuZW1pdCgndGVzdC1maWxlLWZhaWx1cmUnLCBbdGVzdCwgZXJyXSk7XG4gICAgICAgICAgICB9KVxuICAgICAgICApLFxuICAgICAgUHJvbWlzZS5yZXNvbHZlKClcbiAgICApO1xuICB9XG5cbiAgYXN5bmMgX2NyZWF0ZVBhcmFsbGVsVGVzdFJ1bih0ZXN0cywgd2F0Y2hlciwgb25TdGFydCwgb25SZXN1bHQsIG9uRmFpbHVyZSkge1xuICAgIGNvbnN0IHJlc29sdmVycyA9IG5ldyBNYXAoKTtcblxuICAgIGZvciAoY29uc3QgdGVzdCBvZiB0ZXN0cykge1xuICAgICAgaWYgKCFyZXNvbHZlcnMuaGFzKHRlc3QuY29udGV4dC5jb25maWcubmFtZSkpIHtcbiAgICAgICAgcmVzb2x2ZXJzLnNldCh0ZXN0LmNvbnRleHQuY29uZmlnLm5hbWUsIHtcbiAgICAgICAgICBjb25maWc6IHRlc3QuY29udGV4dC5jb25maWcsXG4gICAgICAgICAgc2VyaWFsaXphYmxlTW9kdWxlTWFwOiB0ZXN0LmNvbnRleHQubW9kdWxlTWFwLnRvSlNPTigpXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIGNvbnN0IHdvcmtlciA9IG5ldyAoX2plc3RXb3JrZXIoKS5Xb3JrZXIpKFRFU1RfV09SS0VSX1BBVEgsIHtcbiAgICAgIGV4cG9zZWRNZXRob2RzOiBbJ3dvcmtlciddLFxuICAgICAgZm9ya09wdGlvbnM6IHtcbiAgICAgICAgc3RkaW86ICdwaXBlJ1xuICAgICAgfSxcbiAgICAgIG1heFJldHJpZXM6IDMsXG4gICAgICBudW1Xb3JrZXJzOiB0aGlzLl9nbG9iYWxDb25maWcubWF4V29ya2VycyxcbiAgICAgIHNldHVwQXJnczogW1xuICAgICAgICB7XG4gICAgICAgICAgc2VyaWFsaXphYmxlUmVzb2x2ZXJzOiBBcnJheS5mcm9tKHJlc29sdmVycy52YWx1ZXMoKSlcbiAgICAgICAgfVxuICAgICAgXVxuICAgIH0pO1xuICAgIGlmICh3b3JrZXIuZ2V0U3Rkb3V0KCkpIHdvcmtlci5nZXRTdGRvdXQoKS5waXBlKHByb2Nlc3Muc3Rkb3V0KTtcbiAgICBpZiAod29ya2VyLmdldFN0ZGVycigpKSB3b3JrZXIuZ2V0U3RkZXJyKCkucGlwZShwcm9jZXNzLnN0ZGVycik7XG4gICAgY29uc3QgbXV0ZXggPSAoMCwgX3Rocm9hdCgpLmRlZmF1bHQpKHRoaXMuX2dsb2JhbENvbmZpZy5tYXhXb3JrZXJzKTsgLy8gU2VuZCB0ZXN0IHN1aXRlcyB0byB3b3JrZXJzIGNvbnRpbnVvdXNseSBpbnN0ZWFkIG9mIGFsbCBhdCBvbmNlIHRvIHRyYWNrXG4gICAgLy8gdGhlIHN0YXJ0IHRpbWUgb2YgaW5kaXZpZHVhbCB0ZXN0cy5cblxuICAgIGNvbnN0IHJ1blRlc3RJbldvcmtlciA9IHRlc3QgPT5cbiAgICAgIG11dGV4KGFzeW5jICgpID0+IHtcbiAgICAgICAgaWYgKHdhdGNoZXIuaXNJbnRlcnJ1cHRlZCgpKSB7XG4gICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KCk7XG4gICAgICAgIH0gLy8gUmVtb3ZlIGBpZihvblN0YXJ0KWAgaW4gSmVzdCAyN1xuXG4gICAgICAgIGlmIChvblN0YXJ0KSB7XG4gICAgICAgICAgYXdhaXQgb25TdGFydCh0ZXN0KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBhd2FpdCB0aGlzLmV2ZW50RW1pdHRlci5lbWl0KCd0ZXN0LWZpbGUtc3RhcnQnLCBbdGVzdF0pO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgcHJvbWlzZSA9IHdvcmtlci53b3JrZXIoe1xuICAgICAgICAgIGNvbmZpZzogdGVzdC5jb250ZXh0LmNvbmZpZyxcbiAgICAgICAgICBjb250ZXh0OiB7XG4gICAgICAgICAgICAuLi50aGlzLl9jb250ZXh0LFxuICAgICAgICAgICAgY2hhbmdlZEZpbGVzOlxuICAgICAgICAgICAgICB0aGlzLl9jb250ZXh0LmNoYW5nZWRGaWxlcyAmJlxuICAgICAgICAgICAgICBBcnJheS5mcm9tKHRoaXMuX2NvbnRleHQuY2hhbmdlZEZpbGVzKSxcbiAgICAgICAgICAgIHNvdXJjZXNSZWxhdGVkVG9UZXN0c0luQ2hhbmdlZEZpbGVzOlxuICAgICAgICAgICAgICB0aGlzLl9jb250ZXh0LnNvdXJjZXNSZWxhdGVkVG9UZXN0c0luQ2hhbmdlZEZpbGVzICYmXG4gICAgICAgICAgICAgIEFycmF5LmZyb20odGhpcy5fY29udGV4dC5zb3VyY2VzUmVsYXRlZFRvVGVzdHNJbkNoYW5nZWRGaWxlcylcbiAgICAgICAgICB9LFxuICAgICAgICAgIGdsb2JhbENvbmZpZzogdGhpcy5fZ2xvYmFsQ29uZmlnLFxuICAgICAgICAgIHBhdGg6IHRlc3QucGF0aFxuICAgICAgICB9KTtcblxuICAgICAgICBpZiAocHJvbWlzZS5VTlNUQUJMRV9vbkN1c3RvbU1lc3NhZ2UpIHtcbiAgICAgICAgICAvLyBUT0RPOiBHZXQgYXBwcm9wcmlhdGUgdHlwZSBmb3IgYG9uQ3VzdG9tTWVzc2FnZWBcbiAgICAgICAgICBwcm9taXNlLlVOU1RBQkxFX29uQ3VzdG9tTWVzc2FnZSgoW2V2ZW50LCBwYXlsb2FkXSkgPT4ge1xuICAgICAgICAgICAgdGhpcy5ldmVudEVtaXR0ZXIuZW1pdChldmVudCwgcGF5bG9hZCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICAgIH0pO1xuXG4gICAgY29uc3Qgb25JbnRlcnJ1cHQgPSBuZXcgUHJvbWlzZSgoXywgcmVqZWN0KSA9PiB7XG4gICAgICB3YXRjaGVyLm9uKCdjaGFuZ2UnLCBzdGF0ZSA9PiB7XG4gICAgICAgIGlmIChzdGF0ZS5pbnRlcnJ1cHRlZCkge1xuICAgICAgICAgIHJlamVjdChuZXcgQ2FuY2VsUnVuKCkpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcbiAgICBjb25zdCBydW5BbGxUZXN0cyA9IFByb21pc2UuYWxsKFxuICAgICAgdGVzdHMubWFwKHRlc3QgPT5cbiAgICAgICAgcnVuVGVzdEluV29ya2VyKHRlc3QpXG4gICAgICAgICAgLnRoZW4ocmVzdWx0ID0+IHtcbiAgICAgICAgICAgIGlmIChvblJlc3VsdCkge1xuICAgICAgICAgICAgICByZXR1cm4gb25SZXN1bHQodGVzdCwgcmVzdWx0KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZXZlbnRFbWl0dGVyLmVtaXQoJ3Rlc3QtZmlsZS1zdWNjZXNzJywgW3Rlc3QsIHJlc3VsdF0pO1xuICAgICAgICAgIH0pXG4gICAgICAgICAgLmNhdGNoKGVycm9yID0+IHtcbiAgICAgICAgICAgIGlmIChvbkZhaWx1cmUpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIG9uRmFpbHVyZSh0ZXN0LCBlcnJvcik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiB0aGlzLmV2ZW50RW1pdHRlci5lbWl0KCd0ZXN0LWZpbGUtZmFpbHVyZScsIFt0ZXN0LCBlcnJvcl0pO1xuICAgICAgICAgIH0pXG4gICAgICApXG4gICAgKTtcblxuICAgIGNvbnN0IGNsZWFudXAgPSBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCB7Zm9yY2VFeGl0ZWR9ID0gYXdhaXQgd29ya2VyLmVuZCgpO1xuXG4gICAgICBpZiAoZm9yY2VFeGl0ZWQpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcbiAgICAgICAgICBfY2hhbGsoKS5kZWZhdWx0LnllbGxvdyhcbiAgICAgICAgICAgICdBIHdvcmtlciBwcm9jZXNzIGhhcyBmYWlsZWQgdG8gZXhpdCBncmFjZWZ1bGx5IGFuZCBoYXMgYmVlbiBmb3JjZSBleGl0ZWQuICcgK1xuICAgICAgICAgICAgICAnVGhpcyBpcyBsaWtlbHkgY2F1c2VkIGJ5IHRlc3RzIGxlYWtpbmcgZHVlIHRvIGltcHJvcGVyIHRlYXJkb3duLiAnICtcbiAgICAgICAgICAgICAgJ1RyeSBydW5uaW5nIHdpdGggLS1kZXRlY3RPcGVuSGFuZGxlcyB0byBmaW5kIGxlYWtzLiAnICtcbiAgICAgICAgICAgICAgJ0FjdGl2ZSB0aW1lcnMgY2FuIGFsc28gY2F1c2UgdGhpcywgZW5zdXJlIHRoYXQgLnVucmVmKCkgd2FzIGNhbGxlZCBvbiB0aGVtLidcbiAgICAgICAgICApXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIHJldHVybiBQcm9taXNlLnJhY2UoW3J1bkFsbFRlc3RzLCBvbkludGVycnVwdF0pLnRoZW4oY2xlYW51cCwgY2xlYW51cCk7XG4gIH1cblxuICBvbihldmVudE5hbWUsIGxpc3RlbmVyKSB7XG4gICAgcmV0dXJuIHRoaXMuZXZlbnRFbWl0dGVyLm9uKGV2ZW50TmFtZSwgbGlzdGVuZXIpO1xuICB9XG59XG5cbmV4cG9ydHMuZGVmYXVsdCA9IFRlc3RSdW5uZXI7XG5cbmNsYXNzIENhbmNlbFJ1biBleHRlbmRzIEVycm9yIHtcbiAgY29uc3RydWN0b3IobWVzc2FnZSkge1xuICAgIHN1cGVyKG1lc3NhZ2UpO1xuICAgIHRoaXMubmFtZSA9ICdDYW5jZWxSdW4nO1xuICB9XG59XG4iXSwibWFwcGluZ3MiOiJBQUFBLFlBQVk7O0FBRVpBLE1BQU0sQ0FBQ0MsY0FBYyxDQUFDQyxPQUFPLEVBQUUsWUFBWSxFQUFFO0VBQzNDQyxLQUFLLEVBQUU7QUFDVCxDQUFDLENBQUM7QUFDRkQsT0FBTyxDQUFDRSxPQUFPLEdBQUcsS0FBSyxDQUFDO0FBRXhCLFNBQVNDLE1BQU1BLENBQUEsRUFBRztFQUNoQixNQUFNQyxJQUFJLEdBQUdDLHNCQUFzQixDQUFDQyxPQUFPLENBQUMsT0FBTyxDQUFDLENBQUM7RUFFckRILE1BQU0sR0FBRyxTQUFBQSxDQUFBLEVBQVk7SUFDbkIsT0FBT0MsSUFBSTtFQUNiLENBQUM7RUFFRCxPQUFPQSxJQUFJO0FBQ2I7QUFFQSxTQUFTRyxTQUFTQSxDQUFBLEVBQUc7RUFDbkIsTUFBTUgsSUFBSSxHQUFH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