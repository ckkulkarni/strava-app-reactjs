a4cc3f2c82ad6aa43e50c9c04fa28e3f
"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = useMenu;
var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));
var React = _interopRequireWildcard(require("react"));
var _utils = require("@mui/utils");
var _useListbox = _interopRequireWildcard(require("../useListbox"));
var _useMenuChangeNotifiers = _interopRequireDefault(require("../MenuUnstyled/useMenuChangeNotifiers"));
function _getRequireWildcardCache(nodeInterop) {
  if (typeof WeakMap !== "function") return null;
  var cacheBabelInterop = new WeakMap();
  var cacheNodeInterop = new WeakMap();
  return (_getRequireWildcardCache = function (nodeInterop) {
    return nodeInterop ? cacheNodeInterop : cacheBabelInterop;
  })(nodeInterop);
}
function _interopRequireWildcard(obj, nodeInterop) {
  if (!nodeInterop && obj && obj.__esModule) {
    return obj;
  }
  if (obj === null || typeof obj !== "object" && typeof obj !== "function") {
    return {
      default: obj
    };
  }
  var cache = _getRequireWildcardCache(nodeInterop);
  if (cache && cache.has(obj)) {
    return cache.get(obj);
  }
  var newObj = {};
  var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;
  for (var key in obj) {
    if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) {
      var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;
      if (desc && (desc.get || desc.set)) {
        Object.defineProperty(newObj, key, desc);
      } else {
        newObj[key] = obj[key];
      }
    }
  }
  newObj.default = obj;
  if (cache) {
    cache.set(obj, newObj);
  }
  return newObj;
}
function stateReducer(state, action) {
  if (action.type === _useListbox.ActionTypes.blur || action.type === _useListbox.ActionTypes.optionHover || action.type === _useListbox.ActionTypes.setValue) {
    return state;
  }
  const newState = (0, _useListbox.defaultListboxReducer)(state, action);
  if (action.type !== _useListbox.ActionTypes.setHighlight && newState.highlightedValue === null && action.props.options.length > 0) {
    return (0, _extends2.default)({}, newState, {
      highlightedValue: action.props.options[0]
    });
  }
  return newState;
}
/**
 *
 * Demos:
 *
 * - [Unstyled Menu](https://mui.com/base/react-menu/#hooks)
 *
 * API:
 *
 * - [useMenu API](https://mui.com/base/api/use-menu/)
 */
function useMenu(parameters = {}) {
  const {
    listboxRef: listboxRefProp,
    open = false,
    onClose,
    listboxId
  } = parameters;
  const [menuItems, setMenuItems] = React.useState({});
  const listboxRef = React.useRef(null);
  const handleRef = (0, _utils.unstable_useForkRef)(listboxRef, listboxRefProp);
  const registerItem = React.useCallback((id, metadata) => {
    setMenuItems(previousState => {
      const newState = (0, _extends2.default)({}, previousState);
      newState[id] = metadata;
      return newState;
    });
  }, []);
  const unregisterItem = React.useCallback(id => {
    setMenuItems(previousState => {
      const newState = (0, _extends2.default)({}, previousState);
      delete newState[id];
      return newState;
    });
  }, []);
  const {
    notifyHighlightChanged,
    registerHighlightChangeHandler
  } = (0, _useMenuChangeNotifiers.default)();
  const {
    getOptionState,
    getOptionProps,
    getRootProps,
    highlightedOption,
    setHighlightedValue: setListboxHighlight
  } = (0, _useListbox.default)({
    options: Object.keys(menuItems),
    optionStringifier: id => {
      var _menuItems$id$ref$cur;
      return menuItems[id].label || ((_menuItems$id$ref$cur = menuItems[id].ref.current) == null ? void 0 : _menuItems$id$ref$cur.innerText);
    },
    isOptionDisabled: id => {
      var _menuItems$id;
      return (menuItems == null ? void 0 : (_menuItems$id = menuItems[id]) == null ? void 0 : _menuItems$id.disabled) || false;
    },
    listboxRef: handleRef,
    focusManagement: 'DOM',
    id: listboxId,
    stateReducer,
    selectionLimit: 0,
    disabledItemsFocusable: true
  });
  React.useEffect(() => {
    notifyHighlightChanged(highlightedOption);
  }, [highlightedOption, notifyHighlightChanged]);
  const highlightFirstItem = React.useCallback(() => {
    if (Object.keys(menuItems).length > 0) {
      setListboxHighlight(menuItems[Object.keys(menuItems)[0]].id);
    }
  }, [menuItems, setListboxHighlight]);
  const highlightLastItem = React.useCallback(() => {
    if (Object.keys(menuItems).length > 0) {
      setListboxHighlight(menuItems[Object.keys(menuItems)[Object.keys(menuItems).length - 1]].id);
    }
  }, [menuItems, setListboxHighlight]);
  React.useEffect(() => {
    if (!open) {
      highlightFirstItem();
    }
  }, [open, highlightFirstItem]);
  const createHandleKeyDown = otherHandlers => e => {
    var _otherHandlers$onKeyD;
    (_otherHandlers$onKeyD = otherHandlers.onKeyDown) == null ? void 0 : _otherHandlers$onKeyD.call(otherHandlers, e);
    if (e.defaultPrevented) {
      return;
    }
    if (e.key === 'Escape' && open) {
      onClose == null ? void 0 : onClose();
    }
  };
  const createHandleBlur = otherHandlers => e => {
    var _otherHandlers$onBlur, _listboxRef$current;
    (_otherHandlers$onBlur = otherHandlers.onBlur) == null ? void 0 : _otherHandlers$onBlur.call(otherHandlers, e);
    if (!((_listboxRef$current = listboxRef.current) != null && _listboxRef$current.contains(e.relatedTarget))) {
      onClose == null ? void 0 : onClose();
    }
  };
  React.useEffect(() => {
    var _listboxRef$current2;
    // set focus to the highlighted item (but prevent stealing focus from other elements on the page)
    if ((_listboxRef$current2 = listboxRef.current) != null && _listboxRef$current2.contains(document.activeElement) && highlightedOption !== null) {
      var _menuItems$highlighte, _menuItems$highlighte2;
      menuItems == null ? void 0 : (_menuItems$highlighte = menuItems[highlightedOption]) == null ? void 0 : (_menuItems$highlighte2 = _menuItems$highlighte.ref.current) == null ? void 0 : _menuItems$highlighte2.focus();
    }
  }, [highlightedOption, menuItems]);
  const getListboxProps = (otherHandlers = {}) => {
    const rootProps = getRootProps((0, _extends2.default)({}, otherHandlers, {
      onBlur: createHandleBlur(otherHandlers),
      onKeyDown: createHandleKeyDown(otherHandlers)
    }));
    return (0, _extends2.default)({}, otherHandlers, rootProps, {
      role: 'menu'
    });
  };
  const getItemState = React.useCallback(id => {
    const {
      disabled,
      highlighted
    } = getOptionState(id);
    return {
      disabled,
      highlighted
    };
  }, [getOptionState]);
  React.useDebugValue({
    menuItems,
    highlightedOption
  });
  const contextValue = React.useMemo(() => ({
    getItemProps: getOptionProps,
    getItemState,
    registerHighlightChangeHandler,
    registerItem,
    unregisterItem,
    open
  }), [getOptionProps, getItemState, registerHighlightChangeHandler, registerItem, unregisterItem, open]);
  return {
    contextValue,
    getListboxProps,
    highlightedOption,
    highlightFirstItem,
    highlightLastItem,
    menuItems
  };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZXhwb3J0cyIsInZhbHVlIiwiZGVmYXVsdCIsInVzZU1lbnUiLCJfZXh0ZW5kczIiLCJSZWFjdCIsIl9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkIiwiX3V0aWxzIiwiX3VzZUxpc3Rib3giLCJfdXNlTWVudUNoYW5nZU5vdGlmaWVycyIsIl9nZXRSZXF1aXJlV2lsZGNhcmRDYWNoZSIsIm5vZGVJbnRlcm9wIiwiV2Vha01hcCIsImNhY2hlQmFiZWxJbnRlcm9wIiwiY2FjaGVOb2RlSW50ZXJvcCIsIm9iaiIsIl9fZXNNb2R1bGUiLCJjYWNoZSIsImhhcyIsImdldCIsIm5ld09iaiIsImhhc1Byb3BlcnR5RGVzY3JpcHRvciIsImdldE93blByb3BlcnR5RGVzY3JpcHRvciIsImtleSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsImRlc2MiLCJzZXQiLCJzdGF0ZVJlZHVjZXIiLCJzdGF0ZSIsImFjdGlvbiIsInR5cGUiLCJBY3Rpb25UeXBlcyIsImJsdXIiLCJvcHRpb25Ib3ZlciIsInNldFZhbHVlIiwibmV3U3RhdGUiLCJkZWZhdWx0TGlzdGJveFJlZHVjZXIiLCJzZXRIaWdobGlnaHQiLCJoaWdobGlnaHRlZFZhbHVlIiwicHJvcHMiLCJvcHRpb25zIiwibGVuZ3RoIiwicGFyYW1ldGVycyIsImxpc3Rib3hSZWYiLCJsaXN0Ym94UmVmUHJvcCIsIm9wZW4iLCJvbkNsb3NlIiwibGlzdGJveElkIiwibWVudUl0ZW1zIiwic2V0TWVudUl0ZW1zIiwidXNlU3RhdGUiLCJ1c2VSZWYiLCJoYW5kbGVSZWYiLCJ1bnN0YWJsZV91c2VGb3JrUmVmIiwicmVnaXN0ZXJJdGVtIiwidXNlQ2FsbGJhY2siLCJpZCIsIm1ldGFkYXRhIiwicHJldmlvdXNTdGF0ZSIsInVucmVnaXN0ZXJJdGVtIiwibm90aWZ5SGlnaGxpZ2h0Q2hhbmdlZCIsInJlZ2lzdGVySGlnaGxpZ2h0Q2hhbmdlSGFuZGxlciIsImdldE9wdGlvblN0YXRlIiwiZ2V0T3B0aW9uUHJvcHMiLCJnZXRSb290UHJvcHMiLCJoaWdobGlnaHRlZE9wdGlvbiIsInNldEhpZ2hsaWdodGVkVmFsdWUiLCJzZXRMaXN0Ym94SGlnaGxpZ2h0Iiwia2V5cyIsIm9wdGlvblN0cmluZ2lmaWVyIiwiX21lbnVJdGVtcyRpZCRyZWYkY3VyIiwibGFiZWwiLCJyZWYiLCJjdXJyZW50IiwiaW5uZXJUZXh0IiwiaXNPcHRpb25EaXNhYmxlZCIsIl9tZW51SXRlbXMkaWQiLCJkaXNhYmxlZCIsImZvY3VzTWFuYWdlbWVudCIsInNlbGVjdGlvbkxpbWl0IiwiZGlzYWJsZWRJdGVtc0ZvY3VzYWJsZSIsInVzZUVmZmVjdCIsImhpZ2hsaWdodEZpcnN0SXRlbSIsImhpZ2hsaWdodExhc3RJdGVtIiwiY3JlYXRlSGFuZGxlS2V5RG93biIsIm90aGVySGFuZGxlcnMiLCJlIiwiX290aGVySGFuZGxlcnMkb25LZXlEIiwib25LZXlEb3duIiwiZGVmYXVsdFByZXZlbnRlZCIsImNyZWF0ZUhhbmRsZUJsdXIiLCJfb3RoZXJIYW5kbGVycyRvbkJsdXIiLCJfbGlzdGJveFJlZiRjdXJyZW50Iiwib25CbHVyIiwiY29udGFpbnMiLCJyZWxhdGVkVGFyZ2V0IiwiX2xpc3Rib3hSZWYkY3VycmVudDIiLCJkb2N1bWVudCIsImFjdGl2ZUVsZW1lbnQiLCJfbWVudUl0ZW1zJGhpZ2hsaWdodGUiLCJfbWVudUl0ZW1zJGhpZ2hsaWdodGUyIiwiZm9jdXMiLCJnZXRMaXN0Ym94UHJvcHMiLCJyb290UHJvcHMiLCJyb2xlIiwiZ2V0SXRlbVN0YXRlIiwiaGlnaGxpZ2h0ZWQiLCJ1c2VEZWJ1Z1ZhbHVlIiwiY29udGV4dFZhbHVlIiwidXNlTWVtbyIsImdldEl0ZW1Qcm9wcyJdLCJzb3VyY2VzIjpbInVzZU1lbnUuanMiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0ID0gcmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvaW50ZXJvcFJlcXVpcmVEZWZhdWx0XCIpO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHVzZU1lbnU7XG52YXIgX2V4dGVuZHMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9leHRlbmRzXCIpKTtcbnZhciBSZWFjdCA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKHJlcXVpcmUoXCJyZWFjdFwiKSk7XG52YXIgX3V0aWxzID0gcmVxdWlyZShcIkBtdWkvdXRpbHNcIik7XG52YXIgX3VzZUxpc3Rib3ggPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChyZXF1aXJlKFwiLi4vdXNlTGlzdGJveFwiKSk7XG52YXIgX3VzZU1lbnVDaGFuZ2VOb3RpZmllcnMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuLi9NZW51VW5zdHlsZWQvdXNlTWVudUNoYW5nZU5vdGlmaWVyc1wiKSk7XG5mdW5jdGlvbiBfZ2V0UmVxdWlyZVdpbGRjYXJkQ2FjaGUobm9kZUludGVyb3ApIHsgaWYgKHR5cGVvZiBXZWFrTWFwICE9PSBcImZ1bmN0aW9uXCIpIHJldHVybiBudWxsOyB2YXIgY2FjaGVCYWJlbEludGVyb3AgPSBuZXcgV2Vha01hcCgpOyB2YXIgY2FjaGVOb2RlSW50ZXJvcCA9IG5ldyBXZWFrTWFwKCk7IHJldHVybiAoX2dldFJlcXVpcmVXaWxkY2FyZENhY2hlID0gZnVuY3Rpb24gKG5vZGVJbnRlcm9wKSB7IHJldHVybiBub2RlSW50ZXJvcCA/IGNhY2hlTm9kZUludGVyb3AgOiBjYWNoZUJhYmVsSW50ZXJvcDsgfSkobm9kZUludGVyb3ApOyB9XG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChvYmosIG5vZGVJbnRlcm9wKSB7IGlmICghbm9kZUludGVyb3AgJiYgb2JqICYmIG9iai5fX2VzTW9kdWxlKSB7IHJldHVybiBvYmo7IH0gaWYgKG9iaiA9PT0gbnVsbCB8fCB0eXBlb2Ygb2JqICE9PSBcIm9iamVjdFwiICYmIHR5cGVvZiBvYmogIT09IFwiZnVuY3Rpb25cIikgeyByZXR1cm4geyBkZWZhdWx0OiBvYmogfTsgfSB2YXIgY2FjaGUgPSBfZ2V0UmVxdWlyZVdpbGRjYXJkQ2FjaGUobm9kZUludGVyb3ApOyBpZiAoY2FjaGUgJiYgY2FjaGUuaGFzKG9iaikpIHsgcmV0dXJuIGNhY2hlLmdldChvYmopOyB9IHZhciBuZXdPYmogPSB7fTsgdmFyIGhhc1Byb3BlcnR5RGVzY3JpcHRvciA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSAmJiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yOyBmb3IgKHZhciBrZXkgaW4gb2JqKSB7IGlmIChrZXkgIT09IFwiZGVmYXVsdFwiICYmIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIHsgdmFyIGRlc2MgPSBoYXNQcm9wZXJ0eURlc2NyaXB0b3IgPyBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iaiwga2V5KSA6IG51bGw7IGlmIChkZXNjICYmIChkZXNjLmdldCB8fCBkZXNjLnNldCkpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KG5ld09iaiwga2V5LCBkZXNjKTsgfSBlbHNlIHsgbmV3T2JqW2tleV0gPSBvYmpba2V5XTsgfSB9IH0gbmV3T2JqLmRlZmF1bHQgPSBvYmo7IGlmIChjYWNoZSkgeyBjYWNoZS5zZXQob2JqLCBuZXdPYmopOyB9IHJldHVybiBuZXdPYmo7IH1cbmZ1bmN0aW9uIHN0YXRlUmVkdWNlcihzdGF0ZSwgYWN0aW9uKSB7XG4gIGlmIChhY3Rpb24udHlwZSA9PT0gX3VzZUxpc3Rib3guQWN0aW9uVHlwZXMuYmx1ciB8fCBhY3Rpb24udHlwZSA9PT0gX3VzZUxpc3Rib3guQWN0aW9uVHlwZXMub3B0aW9uSG92ZXIgfHwgYWN0aW9uLnR5cGUgPT09IF91c2VMaXN0Ym94LkFjdGlvblR5cGVzLnNldFZhbHVlKSB7XG4gICAgcmV0dXJuIHN0YXRlO1xuICB9XG4gIGNvbnN0IG5ld1N0YXRlID0gKDAsIF91c2VMaXN0Ym94LmRlZmF1bHRMaXN0Ym94UmVkdWNlcikoc3RhdGUsIGFjdGlvbik7XG4gIGlmIChhY3Rpb24udHlwZSAhPT0gX3VzZUxpc3Rib3guQWN0aW9uVHlwZXMuc2V0SGlnaGxpZ2h0ICYmIG5ld1N0YXRlLmhpZ2hsaWdodGVkVmFsdWUgPT09IG51bGwgJiYgYWN0aW9uLnByb3BzLm9wdGlvbnMubGVuZ3RoID4gMCkge1xuICAgIHJldHVybiAoMCwgX2V4dGVuZHMyLmRlZmF1bHQpKHt9LCBuZXdTdGF0ZSwge1xuICAgICAgaGlnaGxpZ2h0ZWRWYWx1ZTogYWN0aW9uLnByb3BzLm9wdGlvbnNbMF1cbiAgICB9KTtcbiAgfVxuICByZXR1cm4gbmV3U3RhdGU7XG59XG4vKipcbiAqXG4gKiBEZW1vczpcbiAqXG4gKiAtIFtVbnN0eWxlZCBNZW51XShodHRwczovL211aS5jb20vYmFzZS9yZWFjdC1tZW51LyNob29rcylcbiAqXG4gKiBBUEk6XG4gKlxuICogLSBbdXNlTWVudSBBUEldKGh0dHBzOi8vbXVpLmNvbS9iYXNlL2FwaS91c2UtbWVudS8pXG4gKi9cbmZ1bmN0aW9uIHVzZU1lbnUocGFyYW1ldGVycyA9IHt9KSB7XG4gIGNvbnN0IHtcbiAgICBsaXN0Ym94UmVmOiBsaXN0Ym94UmVmUHJvcCxcbiAgICBvcGVuID0gZmFsc2UsXG4gICAgb25DbG9zZSxcbiAgICBsaXN0Ym94SWRcbiAgfSA9IHBhcmFtZXRlcnM7XG4gIGNvbnN0IFttZW51SXRlbXMsIHNldE1lbnVJdGVtc10gPSBSZWFjdC51c2VTdGF0ZSh7fSk7XG4gIGNvbnN0IGxpc3Rib3hSZWYgPSBSZWFjdC51c2VSZWYobnVsbCk7XG4gIGNvbnN0IGhhbmRsZVJlZiA9ICgwLCBfdXRpbHMudW5zdGFibGVfdXNlRm9ya1JlZikobGlzdGJveFJlZiwgbGlzdGJveFJlZlByb3ApO1xuICBjb25zdCByZWdpc3Rlckl0ZW0gPSBSZWFjdC51c2VDYWxsYmFjaygoaWQsIG1ldGFkYXRhKSA9PiB7XG4gICAgc2V0TWVudUl0ZW1zKHByZXZpb3VzU3RhdGUgPT4ge1xuICAgICAgY29uc3QgbmV3U3RhdGUgPSAoMCwgX2V4dGVuZHMyLmRlZmF1bHQpKHt9LCBwcmV2aW91c1N0YXRlKTtcbiAgICAgIG5ld1N0YXRlW2lkXSA9IG1ldGFkYXRhO1xuICAgICAgcmV0dXJuIG5ld1N0YXRlO1xuICAgIH0pO1xuICB9LCBbXSk7XG4gIGNvbnN0IHVucmVnaXN0ZXJJdGVtID0gUmVhY3QudXNlQ2FsbGJhY2soaWQgPT4ge1xuICAgIHNldE1lbnVJdGVtcyhwcmV2aW91c1N0YXRlID0+IHtcbiAgICAgIGNvbnN0IG5ld1N0YXRlID0gKDAsIF9leHRlbmRzMi5kZWZhdWx0KSh7fSwgcHJldmlvdXNTdGF0ZSk7XG4gICAgICBkZWxldGUgbmV3U3RhdGVbaWRdO1xuICAgICAgcmV0dXJuIG5ld1N0YXRlO1xuICAgIH0pO1xuICB9LCBbXSk7XG4gIGNvbnN0IHtcbiAgICBub3RpZnlIaWdobGlnaHRDaGFuZ2VkLFxuICAgIHJlZ2lzdGVySGlnaGxpZ2h0Q2hhbmdlSGFuZGxlclxuICB9ID0gKDAsIF91c2VNZW51Q2hhbmdlTm90aWZpZXJzLmRlZmF1bHQpKCk7XG4gIGNvbnN0IHtcbiAgICBnZXRPcHRpb25TdGF0ZSxcbiAgICBnZXRPcHRpb25Qcm9wcyxcbiAgICBnZXRSb290UHJvcHMsXG4gICAgaGlnaGxpZ2h0ZWRPcHRpb24sXG4gICAgc2V0SGlnaGxpZ2h0ZWRWYWx1ZTogc2V0TGlzdGJveEhpZ2hsaWdodFxuICB9ID0gKDAsIF91c2VMaXN0Ym94LmRlZmF1bHQpKHtcbiAgICBvcHRpb25zOiBPYmplY3Qua2V5cyhtZW51SXRlbXMpLFxuICAgIG9wdGlvblN0cmluZ2lmaWVyOiBpZCA9PiB7XG4gICAgICB2YXIgX21lbnVJdGVtcyRpZCRyZWYkY3VyO1xuICAgICAgcmV0dXJuIG1lbnVJdGVtc1tpZF0ubGFiZWwgfHwgKChfbWVudUl0ZW1zJGlkJHJlZiRjdXIgPSBtZW51SXRlbXNbaWRdLnJlZi5jdXJyZW50KSA9PSBudWxsID8gdm9pZCAwIDogX21lbnVJdGVtcyRpZCRyZWYkY3VyLmlubmVyVGV4dCk7XG4gICAgfSxcbiAgICBpc09wdGlvbkRpc2FibGVkOiBpZCA9PiB7XG4gICAgICB2YXIgX21lbnVJdGVtcyRpZDtcbiAgICAgIHJldHVybiAobWVudUl0ZW1zID09IG51bGwgPyB2b2lkIDAgOiAoX21lbnVJdGVtcyRpZCA9IG1lbnVJdGVtc1tpZF0pID09IG51bGwgPyB2b2lkIDAgOiBfbWVudUl0ZW1zJGlkLmRpc2FibGVkKSB8fCBmYWxzZTtcbiAgICB9LFxuICAgIGxpc3Rib3hSZWY6IGhhbmRsZVJlZixcbiAgICBmb2N1c01hbmFnZW1lbnQ6ICdET00nLFxuICAgIGlkOiBsaXN0Ym94SWQsXG4gICAgc3RhdGVSZWR1Y2VyLFxuICAgIHNlbGVjdGlvbkxpbWl0OiAwLFxuICAgIGRpc2FibGVkSXRlbXNGb2N1c2FibGU6IHRydWVcbiAgfSk7XG4gIFJlYWN0LnVzZUVmZmVjdCgoKSA9PiB7XG4gICAgbm90aWZ5SGlnaGxpZ2h0Q2hhbmdlZChoaWdobGlnaHRlZE9wdGlvbik7XG4gIH0sIFtoaWdobGlnaHRlZE9wdGlvbiwgbm90aWZ5SGlnaGxpZ2h0Q2hhbmdlZF0pO1xuICBjb25zdCBoaWdobGlnaHRGaXJzdEl0ZW0gPSBSZWFjdC51c2VDYWxsYmFjaygoKSA9PiB7XG4gICAgaWYgKE9iamVjdC5rZXlzKG1lbnVJdGVtcykubGVuZ3RoID4gMCkge1xuICAgICAgc2V0TGlzdGJveEhpZ2hsaWdodChtZW51SXRlbXNbT2JqZWN0LmtleXMobWVudUl0ZW1zKVswXV0uaWQpO1xuICAgIH1cbiAgfSwgW21lbnVJdGVtcywgc2V0TGlzdGJveEhpZ2hsaWdodF0pO1xuICBjb25zdCBoaWdobGlnaHRMYXN0SXRlbSA9IFJlYWN0LnVzZUNhbGxiYWNrKCgpID0+IHtcbiAgICBpZiAoT2JqZWN0LmtleXMobWVudUl0ZW1zKS5sZW5ndGggPiAwKSB7XG4gICAgICBzZXRMaXN0Ym94SGlnaGxpZ2h0KG1lbnVJdGVtc1tPYmplY3Qua2V5cyhtZW51SXRlbXMpW09iamVjdC5rZXlzKG1lbnVJdGVtcykubGVuZ3RoIC0gMV1dLmlkKTtcbiAgICB9XG4gIH0sIFttZW51SXRlbXMsIHNldExpc3Rib3hIaWdobGlnaHRdKTtcbiAgUmVhY3QudXNlRWZmZWN0KCgpID0+IHtcbiAgICBpZiAoIW9wZW4pIHtcbiAgICAgIGhpZ2hsaWdodEZpcnN0SXRlbSgpO1xuICAgIH1cbiAgfSwgW29wZW4sIGhpZ2hsaWdodEZpcnN0SXRlbV0pO1xuICBjb25zdCBjcmVhdGVIYW5kbGVLZXlEb3duID0gb3RoZXJIYW5kbGVycyA9PiBlID0+IHtcbiAgICB2YXIgX290aGVySGFuZGxlcnMkb25LZXlEO1xuICAgIChfb3RoZXJIYW5kbGVycyRvbktleUQgPSBvdGhlckhhbmRsZXJzLm9uS2V5RG93bikgPT0gbnVsbCA/IHZvaWQgMCA6IF9vdGhlckhhbmRsZXJzJG9uS2V5RC5jYWxsKG90aGVySGFuZGxlcnMsIGUpO1xuICAgIGlmIChlLmRlZmF1bHRQcmV2ZW50ZWQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKGUua2V5ID09PSAnRXNjYXBlJyAmJiBvcGVuKSB7XG4gICAgICBvbkNsb3NlID09IG51bGwgPyB2b2lkIDAgOiBvbkNsb3NlKCk7XG4gICAgfVxuICB9O1xuICBjb25zdCBjcmVhdGVIYW5kbGVCbHVyID0gb3RoZXJIYW5kbGVycyA9PiBlID0+IHtcbiAgICB2YXIgX290aGVySGFuZGxlcnMkb25CbHVyLCBfbGlzdGJveFJlZiRjdXJyZW50O1xuICAgIChfb3RoZXJIYW5kbGVycyRvbkJsdXIgPSBvdGhlckhhbmRsZXJzLm9uQmx1cikgPT0gbnVsbCA/IHZvaWQgMCA6IF9vdGhlckhhbmRsZXJzJG9uQmx1ci5jYWxsKG90aGVySGFuZGxlcnMsIGUpO1xuICAgIGlmICghKChfbGlzdGJveFJlZiRjdXJyZW50ID0gbGlzdGJveFJlZi5jdXJyZW50KSAhPSBudWxsICYmIF9saXN0Ym94UmVmJGN1cnJlbnQuY29udGFpbnMoZS5yZWxhdGVkVGFyZ2V0KSkpIHtcbiAgICAgIG9uQ2xvc2UgPT0gbnVsbCA/IHZvaWQgMCA6IG9uQ2xvc2UoKTtcbiAgICB9XG4gIH07XG4gIFJlYWN0LnVzZUVmZmVjdCgoKSA9PiB7XG4gICAgdmFyIF9saXN0Ym94UmVmJGN1cnJlbnQyO1xuICAgIC8vIHNldCBmb2N1cyB0byB0aGUgaGlnaGxpZ2h0ZWQgaXRlbSAoYnV0IHByZXZlbnQgc3RlYWxpbmcgZm9jdXMgZnJvbSBvdGhlciBlbGVtZW50cyBvbiB0aGUgcGFnZSlcbiAgICBpZiAoKF9saXN0Ym94UmVmJGN1cnJlbnQyID0gbGlzdGJveFJlZi5jdXJyZW50KSAhPSBudWxsICYmIF9saXN0Ym94UmVmJGN1cnJlbnQyLmNvbnRhaW5zKGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQpICYmIGhpZ2hsaWdodGVkT3B0aW9uICE9PSBudWxsKSB7XG4gICAgICB2YXIgX21lbnVJdGVtcyRoaWdobGlnaHRlLCBfbWVudUl0ZW1zJGhpZ2hsaWdodGUyO1xuICAgICAgbWVudUl0ZW1zID09IG51bGwgPyB2b2lkIDAgOiAoX21lbnVJdGVtcyRoaWdobGlnaHRlID0gbWVudUl0ZW1zW2hpZ2hsaWdodGVkT3B0aW9uXSkgPT0gbnVsbCA/IHZvaWQgMCA6IChfbWVudUl0ZW1zJGhpZ2hsaWdodGUyID0gX21lbnVJdGVtcyRoaWdobGlnaHRlLnJlZi5jdXJyZW50KSA9PSBudWxsID8gdm9pZCAwIDogX21lbnVJdGVtcyRoaWdobGlnaHRlMi5mb2N1cygpO1xuICAgIH1cbiAgfSwgW2hpZ2hsaWdodGVkT3B0aW9uLCBtZW51SXRlbXNdKTtcbiAgY29uc3QgZ2V0TGlzdGJveFByb3BzID0gKG90aGVySGFuZGxlcnMgPSB7fSkgPT4ge1xuICAgIGNvbnN0IHJvb3RQcm9wcyA9IGdldFJvb3RQcm9wcygoMCwgX2V4dGVuZHMyLmRlZmF1bHQpKHt9LCBvdGhlckhhbmRsZXJzLCB7XG4gICAgICBvbkJsdXI6IGNyZWF0ZUhhbmRsZUJsdXIob3RoZXJIYW5kbGVycyksXG4gICAgICBvbktleURvd246IGNyZWF0ZUhhbmRsZUtleURvd24ob3RoZXJIYW5kbGVycylcbiAgICB9KSk7XG4gICAgcmV0dXJuICgwLCBfZXh0ZW5kczIuZGVmYXVsdCkoe30sIG90aGVySGFuZGxlcnMsIHJvb3RQcm9wcywge1xuICAgICAgcm9sZTogJ21lbnUnXG4gICAgfSk7XG4gIH07XG4gIGNvbnN0IGdldEl0ZW1TdGF0ZSA9IFJlYWN0LnVzZUNhbGxiYWNrKGlkID0+IHtcbiAgICBjb25zdCB7XG4gICAgICBkaXNhYmxlZCxcbiAgICAgIGhpZ2hsaWdodGVkXG4gICAgfSA9IGdldE9wdGlvblN0YXRlKGlkKTtcbiAgICByZXR1cm4ge1xuICAgICAgZGlzYWJsZWQsXG4gICAgICBoaWdobGlnaHRlZFxuICAgIH07XG4gIH0sIFtnZXRPcHRpb25TdGF0ZV0pO1xuICBSZWFjdC51c2VEZWJ1Z1ZhbHVlKHtcbiAgICBtZW51SXRlbXMsXG4gICAgaGlnaGxpZ2h0ZWRPcHRpb25cbiAgfSk7XG4gIGNvbnN0IGNvbnRleHRWYWx1ZSA9IFJlYWN0LnVzZU1lbW8oKCkgPT4gKHtcbiAgICBnZXRJdGVtUHJvcHM6IGdldE9wdGlvblByb3BzLFxuICAgIGdldEl0ZW1TdGF0ZSxcbiAgICByZWdpc3RlckhpZ2hsaWdodENoYW5nZUhhbmRsZXIsXG4gICAgcmVnaXN0ZXJJdGVtLFxuICAgIHVucmVnaXN0ZXJJdGVtLFxuICAgIG9wZW5cbiAgfSksIFtnZXRPcHRpb25Qcm9wcywgZ2V0SXRlbVN0YXRlLCByZWdpc3RlckhpZ2hsaWdodENoYW5nZUhhbmRsZXIsIHJlZ2lzdGVySXRlbSwgdW5yZWdpc3Rlckl0ZW0sIG9wZW5dKTtcbiAgcmV0dXJuIHtcbiAgICBjb250ZXh0VmFsdWUsXG4gICAgZ2V0TGlzdGJveFByb3BzLFxuICAgIGhpZ2hsaWdodGVkT3B0aW9uLFxuICAgIGhpZ2hsaWdodEZpcnN0SXRlbSxcbiAgICBoaWdobGlnaHRMYXN0SXRlbSxcbiAgICBtZW51SXRlbXNcbiAgfTtcbn0iXSwibWFwcGluZ3MiOiJBQUFBLFlBQVk7O0FBRVosSUFBSUEsc0JBQXNCLEdBQUdDLE9BQU8sQ0FBQyw4Q0FBOEMsQ0FBQztBQUNwRkMsTUFBTSxDQUFDQyxjQUFjLENBQUNDLE9BQU8sRUFBRSxZQUFZLEVBQUU7RUFDM0NDLEtBQUssRUFBRTtBQUNULENBQUMsQ0FBQztBQUNGRCxPQUFPLENBQUNFLE9BQU8sR0FBR0MsT0FBTztBQUN6QixJQUFJQyxTQUFTLEdBQUdSLHNCQUFzQixDQUFDQyxPQUFPLENBQUMsZ0NBQWdDLENBQUMsQ0FBQztBQUNqRixJQUFJUSxLQUFLLEdBQUdDLHVCQUF1QixDQUFDVCxPQUFPLENBQUMsT0FBTyxDQUFDLENBQUM7QUFDckQsSUFBSVUsTUFBTSxHQUFHVixPQUFPLENBQUMsWUFBWSxDQUFDO0FBQ2xDLElBQUlXLFdBQVcsR0FBR0YsdUJBQXVCLENBQUNULE9BQU8sQ0FBQyxlQUFlLENBQUMsQ0FBQztBQUNuRSxJQUFJWSx1QkFBdUIsR0FBR2Isc0JBQXNCLENBQUNDLE9BQU8sQ0FBQyx3Q0FBd0MsQ0FBQyxDQUFDO0FBQ3ZHLFNBQVNhLHdCQUF3QkEsQ0FBQ0MsV0FBVyxFQUFFO0VBQUUsSUFBSSxPQUFPQyxPQUFPLEtBQUssVUFBVSxFQUFFLE9BQU8sSUFBSTtFQUFFLElBQUlDLGlCQUFpQixHQUFHLElBQUlELE9BQU8sRUFBRTtFQUFFLElBQUlFLGdCQUFnQixHQUFHLElBQUlGLE9BQU8sRUFBRTtFQUFFLE9BQU8sQ0FBQ0Ysd0JBQXdCLEdBQUcsU0FBQUEsQ0FBVUMsV0FBVyxFQUFFO0lBQUUsT0FBT0EsV0FBVyxHQUFHRyxnQkFBZ0IsR0FBR0QsaUJBQWlCO0VBQUUsQ0FBQyxFQUFFRixXQUFXLENBQUM7QUFBRTtBQUN0VCxTQUFTTCx1QkFBdUJBLENBQUNTLEdBQUcsRUFBRUosV0FBVyxFQUFFO0VBQUUsSUFBSSxDQUFD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