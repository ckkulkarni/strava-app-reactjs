e0900b8f591933f3e639f919c44c48ee
"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.createUnarySpacing = createUnarySpacing;
exports.createUnaryUnit = createUnaryUnit;
exports.default = void 0;
exports.getStyleFromPropValue = getStyleFromPropValue;
exports.getValue = getValue;
exports.margin = margin;
exports.marginKeys = void 0;
exports.padding = padding;
exports.paddingKeys = void 0;
var _responsivePropType = _interopRequireDefault(require("./responsivePropType"));
var _breakpoints = require("./breakpoints");
var _style = require("./style");
var _merge = _interopRequireDefault(require("./merge"));
var _memoize = _interopRequireDefault(require("./memoize"));
const properties = {
  m: 'margin',
  p: 'padding'
};
const directions = {
  t: 'Top',
  r: 'Right',
  b: 'Bottom',
  l: 'Left',
  x: ['Left', 'Right'],
  y: ['Top', 'Bottom']
};
const aliases = {
  marginX: 'mx',
  marginY: 'my',
  paddingX: 'px',
  paddingY: 'py'
};

// memoize() impact:
// From 300,000 ops/sec
// To 350,000 ops/sec
const getCssProperties = (0, _memoize.default)(prop => {
  // It's not a shorthand notation.
  if (prop.length > 2) {
    if (aliases[prop]) {
      prop = aliases[prop];
    } else {
      return [prop];
    }
  }
  const [a, b] = prop.split('');
  const property = properties[a];
  const direction = directions[b] || '';
  return Array.isArray(direction) ? direction.map(dir => property + dir) : [property + direction];
});
const marginKeys = ['m', 'mt', 'mr', 'mb', 'ml', 'mx', 'my', 'margin', 'marginTop', 'marginRight', 'marginBottom', 'marginLeft', 'marginX', 'marginY', 'marginInline', 'marginInlineStart', 'marginInlineEnd', 'marginBlock', 'marginBlockStart', 'marginBlockEnd'];
exports.marginKeys = marginKeys;
const paddingKeys = ['p', 'pt', 'pr', 'pb', 'pl', 'px', 'py', 'padding', 'paddingTop', 'paddingRight', 'paddingBottom', 'paddingLeft', 'paddingX', 'paddingY', 'paddingInline', 'paddingInlineStart', 'paddingInlineEnd', 'paddingBlock', 'paddingBlockStart', 'paddingBlockEnd'];
exports.paddingKeys = paddingKeys;
const spacingKeys = [...marginKeys, ...paddingKeys];
function createUnaryUnit(theme, themeKey, defaultValue, propName) {
  var _getPath;
  const themeSpacing = (_getPath = (0, _style.getPath)(theme, themeKey, false)) != null ? _getPath : defaultValue;
  if (typeof themeSpacing === 'number') {
    return abs => {
      if (typeof abs === 'string') {
        return abs;
      }
      if (process.env.NODE_ENV !== 'production') {
        if (typeof abs !== 'number') {
          console.error(`MUI: Expected ${propName} argument to be a number or a string, got ${abs}.`);
        }
      }
      return themeSpacing * abs;
    };
  }
  if (Array.isArray(themeSpacing)) {
    return abs => {
      if (typeof abs === 'string') {
        return abs;
      }
      if (process.env.NODE_ENV !== 'production') {
        if (!Number.isInteger(abs)) {
          console.error([`MUI: The \`theme.${themeKey}\` array type cannot be combined with non integer values.` + `You should either use an integer value that can be used as index, or define the \`theme.${themeKey}\` as a number.`].join('\n'));
        } else if (abs > themeSpacing.length - 1) {
          console.error([`MUI: The value provided (${abs}) overflows.`, `The supported values are: ${JSON.stringify(themeSpacing)}.`, `${abs} > ${themeSpacing.length - 1}, you need to add the missing values.`].join('\n'));
        }
      }
      return themeSpacing[abs];
    };
  }
  if (typeof themeSpacing === 'function') {
    return themeSpacing;
  }
  if (process.env.NODE_ENV !== 'production') {
    console.error([`MUI: The \`theme.${themeKey}\` value (${themeSpacing}) is invalid.`, 'It should be a number, an array or a function.'].join('\n'));
  }
  return () => undefined;
}
function createUnarySpacing(theme) {
  return createUnaryUnit(theme, 'spacing', 8, 'spacing');
}
function getValue(transformer, propValue) {
  if (typeof propValue === 'string' || propValue == null) {
    return propValue;
  }
  const abs = Math.abs(propValue);
  const transformed = transformer(abs);
  if (propValue >= 0) {
    return transformed;
  }
  if (typeof transformed === 'number') {
    return -transformed;
  }
  return `-${transformed}`;
}
function getStyleFromPropValue(cssProperties, transformer) {
  return propValue => cssProperties.reduce((acc, cssProperty) => {
    acc[cssProperty] = getValue(transformer, propValue);
    return acc;
  }, {});
}
function resolveCssProperty(props, keys, prop, transformer) {
  // Using a hash computation over an array iteration could be faster, but with only 28 items,
  // it's doesn't worth the bundle size.
  if (keys.indexOf(prop) === -1) {
    return null;
  }
  const cssProperties = getCssProperties(prop);
  const styleFromPropValue = getStyleFromPropValue(cssProperties, transformer);
  const propValue = props[prop];
  return (0, _breakpoints.handleBreakpoints)(props, propValue, styleFromPropValue);
}
function style(props, keys) {
  const transformer = createUnarySpacing(props.theme);
  return Object.keys(props).map(prop => resolveCssProperty(props, keys, prop, transformer)).reduce(_merge.default, {});
}
function margin(props) {
  return style(props, marginKeys);
}
margin.propTypes = process.env.NODE_ENV !== 'production' ? marginKeys.reduce((obj, key) => {
  obj[key] = _responsivePropType.default;
  return obj;
}, {}) : {};
margin.filterProps = marginKeys;
function padding(props) {
  return style(props, paddingKeys);
}
padding.propTypes = process.env.NODE_ENV !== 'production' ? paddingKeys.reduce((obj, key) => {
  obj[key] = _responsivePropType.default;
  return obj;
}, {}) : {};
padding.filterProps = paddingKeys;
function spacing(props) {
  return style(props, spacingKeys);
}
spacing.propTypes = process.env.NODE_ENV !== 'production' ? spacingKeys.reduce((obj, key) => {
  obj[key] = _responsivePropType.default;
  return obj;
}, {}) : {};
spacing.filterProps = spacingKeys;
var _default = spacing;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZXhwb3J0cyIsInZhbHVlIiwiY3JlYXRlVW5hcnlTcGFjaW5nIiwiY3JlYXRlVW5hcnlVbml0IiwiZGVmYXVsdCIsImdldFN0eWxlRnJvbVByb3BWYWx1ZSIsImdldFZhbHVlIiwibWFyZ2luIiwibWFyZ2luS2V5cyIsInBhZGRpbmciLCJwYWRkaW5nS2V5cyIsIl9yZXNwb25zaXZlUHJvcFR5cGUiLCJfYnJlYWtwb2ludHMiLCJfc3R5bGUiLCJfbWVyZ2UiLCJfbWVtb2l6ZSIsInByb3BlcnRpZXMiLCJtIiwicCIsImRpcmVjdGlvbnMiLCJ0IiwiciIsImIiLCJsIiwieCIsInkiLCJhbGlhc2VzIiwibWFyZ2luWCIsIm1hcmdpblkiLCJwYWRkaW5nWCIsInBhZGRpbmdZIiwiZ2V0Q3NzUHJvcGVydGllcyIsInByb3AiLCJsZW5ndGgiLCJhIiwic3BsaXQiLCJwcm9wZXJ0eSIsImRpcmVjdGlvbiIsIkFycmF5IiwiaXNBcnJheSIsIm1hcCIsImRpciIsInNwYWNpbmdLZXlzIiwidGhlbWUiLCJ0aGVtZUtleSIsImRlZmF1bHRWYWx1ZSIsInByb3BOYW1lIiwiX2dldFBhdGgiLCJ0aGVtZVNwYWNpbmciLCJnZXRQYXRoIiwiYWJzIiwicHJvY2VzcyIsImVudiIsIk5PREVfRU5WIiwiY29uc29sZSIsImVycm9yIiwiTnVtYmVyIiwiaXNJbnRlZ2VyIiwiam9pbiIsIkpTT04iLCJzdHJpbmdpZnkiLCJ1bmRlZmluZWQiLCJ0cmFuc2Zvcm1lciIsInByb3BWYWx1ZSIsIk1hdGgiLCJ0cmFuc2Zvcm1lZCIsImNzc1Byb3BlcnRpZXMiLCJyZWR1Y2UiLCJhY2MiLCJjc3NQcm9wZXJ0eSIsInJlc29sdmVDc3NQcm9wZXJ0eSIsInByb3BzIiwia2V5cyIsImluZGV4T2YiLCJzdHlsZUZyb21Qcm9wVmFsdWUiLCJoYW5kbGVCcmVha3BvaW50cyIsInN0eWxlIiwicHJvcFR5cGVzIiwib2JqIiwia2V5IiwiZmlsdGVyUHJvcHMiLCJzcGFjaW5nIiwiX2RlZmF1bHQiXSwic291cmNlcyI6WyJzcGFjaW5nLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuXG52YXIgX2ludGVyb3BSZXF1aXJlRGVmYXVsdCA9IHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2ludGVyb3BSZXF1aXJlRGVmYXVsdFwiKTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmNyZWF0ZVVuYXJ5U3BhY2luZyA9IGNyZWF0ZVVuYXJ5U3BhY2luZztcbmV4cG9ydHMuY3JlYXRlVW5hcnlVbml0ID0gY3JlYXRlVW5hcnlVbml0O1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xuZXhwb3J0cy5nZXRTdHlsZUZyb21Qcm9wVmFsdWUgPSBnZXRTdHlsZUZyb21Qcm9wVmFsdWU7XG5leHBvcnRzLmdldFZhbHVlID0gZ2V0VmFsdWU7XG5leHBvcnRzLm1hcmdpbiA9IG1hcmdpbjtcbmV4cG9ydHMubWFyZ2luS2V5cyA9IHZvaWQgMDtcbmV4cG9ydHMucGFkZGluZyA9IHBhZGRpbmc7XG5leHBvcnRzLnBhZGRpbmdLZXlzID0gdm9pZCAwO1xudmFyIF9yZXNwb25zaXZlUHJvcFR5cGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuL3Jlc3BvbnNpdmVQcm9wVHlwZVwiKSk7XG52YXIgX2JyZWFrcG9pbnRzID0gcmVxdWlyZShcIi4vYnJlYWtwb2ludHNcIik7XG52YXIgX3N0eWxlID0gcmVxdWlyZShcIi4vc3R5bGVcIik7XG52YXIgX21lcmdlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi9tZXJnZVwiKSk7XG52YXIgX21lbW9pemUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuL21lbW9pemVcIikpO1xuY29uc3QgcHJvcGVydGllcyA9IHtcbiAgbTogJ21hcmdpbicsXG4gIHA6ICdwYWRkaW5nJ1xufTtcbmNvbnN0IGRpcmVjdGlvbnMgPSB7XG4gIHQ6ICdUb3AnLFxuICByOiAnUmlnaHQnLFxuICBiOiAnQm90dG9tJyxcbiAgbDogJ0xlZnQnLFxuICB4OiBbJ0xlZnQnLCAnUmlnaHQnXSxcbiAgeTogWydUb3AnLCAnQm90dG9tJ11cbn07XG5jb25zdCBhbGlhc2VzID0ge1xuICBtYXJnaW5YOiAnbXgnLFxuICBtYXJnaW5ZOiAnbXknLFxuICBwYWRkaW5nWDogJ3B4JyxcbiAgcGFkZGluZ1k6ICdweSdcbn07XG5cbi8vIG1lbW9pemUoKSBpbXBhY3Q6XG4vLyBGcm9tIDMwMCwwMDAgb3BzL3NlY1xuLy8gVG8gMzUwLDAwMCBvcHMvc2VjXG5jb25zdCBnZXRDc3NQcm9wZXJ0aWVzID0gKDAsIF9tZW1vaXplLmRlZmF1bHQpKHByb3AgPT4ge1xuICAvLyBJdCdzIG5vdCBhIHNob3J0aGFuZCBub3RhdGlvbi5cbiAgaWYgKHByb3AubGVuZ3RoID4gMikge1xuICAgIGlmIChhbGlhc2VzW3Byb3BdKSB7XG4gICAgICBwcm9wID0gYWxpYXNlc1twcm9wXTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIFtwcm9wXTtcbiAgICB9XG4gIH1cbiAgY29uc3QgW2EsIGJdID0gcHJvcC5zcGxpdCgnJyk7XG4gIGNvbnN0IHByb3BlcnR5ID0gcHJvcGVydGllc1thXTtcbiAgY29uc3QgZGlyZWN0aW9uID0gZGlyZWN0aW9uc1tiXSB8fCAnJztcbiAgcmV0dXJuIEFycmF5LmlzQXJyYXkoZGlyZWN0aW9uKSA/IGRpcmVjdGlvbi5tYXAoZGlyID0+IHByb3BlcnR5ICsgZGlyKSA6IFtwcm9wZXJ0eSArIGRpcmVjdGlvbl07XG59KTtcbmNvbnN0IG1hcmdpbktleXMgPSBbJ20nLCAnbXQnLCAnbXInLCAnbWInLCAnbWwnLCAnbXgnLCAnbXknLCAnbWFyZ2luJywgJ21hcmdpblRvcCcsICdtYXJnaW5SaWdodCcsICdtYXJnaW5Cb3R0b20nLCAnbWFyZ2luTGVmdCcsICdtYXJnaW5YJywgJ21hcmdpblknLCAnbWFyZ2luSW5saW5lJywgJ21hcmdpbklubGluZVN0YXJ0JywgJ21hcmdpbklubGluZUVuZCcsICdtYXJnaW5CbG9jaycsICdtYXJnaW5CbG9ja1N0YXJ0JywgJ21hcmdpbkJsb2NrRW5kJ107XG5leHBvcnRzLm1hcmdpbktleXMgPSBtYXJnaW5LZXlzO1xuY29uc3QgcGFkZGluZ0tleXMgPSBbJ3AnLCAncHQnLCAncHInLCAncGInLCAncGwnLCAncHgnLCAncHknLCAncGFkZGluZycsICdwYWRkaW5nVG9wJywgJ3BhZGRpbmdSaWdodCcsICdwYWRkaW5nQm90dG9tJywgJ3BhZGRpbmdMZWZ0JywgJ3BhZGRpbmdYJywgJ3BhZGRpbmdZJywgJ3BhZGRpbmdJbmxpbmUnLCAncGFkZGluZ0lubGluZVN0YXJ0JywgJ3BhZGRpbmdJbmxpbmVFbmQnLCAncGFkZGluZ0Jsb2NrJywgJ3BhZGRpbmdCbG9ja1N0YXJ0JywgJ3BhZGRpbmdCbG9ja0VuZCddO1xuZXhwb3J0cy5wYWRkaW5nS2V5cyA9IHBhZGRpbmdLZXlzO1xuY29uc3Qgc3BhY2luZ0tleXMgPSBbLi4ubWFyZ2luS2V5cywgLi4ucGFkZGluZ0tleXNdO1xuZnVuY3Rpb24gY3JlYXRlVW5hcnlVbml0KHRoZW1lLCB0aGVtZUtleSwgZGVmYXVsdFZhbHVlLCBwcm9wTmFtZSkge1xuICB2YXIgX2dldFBhdGg7XG4gIGNvbnN0IHRoZW1lU3BhY2luZyA9IChfZ2V0UGF0aCA9ICgwLCBfc3R5bGUuZ2V0UGF0aCkodGhlbWUsIHRoZW1lS2V5LCBmYWxzZSkpICE9IG51bGwgPyBfZ2V0UGF0aCA6IGRlZmF1bHRWYWx1ZTtcbiAgaWYgKHR5cGVvZiB0aGVtZVNwYWNpbmcgPT09ICdudW1iZXInKSB7XG4gICAgcmV0dXJuIGFicyA9PiB7XG4gICAgICBpZiAodHlwZW9mIGFicyA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgcmV0dXJuIGFicztcbiAgICAgIH1cbiAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICAgIGlmICh0eXBlb2YgYWJzICE9PSAnbnVtYmVyJykge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYE1VSTogRXhwZWN0ZWQgJHtwcm9wTmFtZX0gYXJndW1lbnQgdG8gYmUgYSBudW1iZXIgb3IgYSBzdHJpbmcsIGdvdCAke2Fic30uYCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiB0aGVtZVNwYWNpbmcgKiBhYnM7XG4gICAgfTtcbiAgfVxuICBpZiAoQXJyYXkuaXNBcnJheSh0aGVtZVNwYWNpbmcpKSB7XG4gICAgcmV0dXJuIGFicyA9PiB7XG4gICAgICBpZiAodHlwZW9mIGFicyA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgcmV0dXJuIGFicztcbiAgICAgIH1cbiAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICAgIGlmICghTnVtYmVyLmlzSW50ZWdlcihhYnMpKSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcihbYE1VSTogVGhlIFxcYHRoZW1lLiR7dGhlbWVLZXl9XFxgIGFycmF5IHR5cGUgY2Fubm90IGJlIGNvbWJpbmVkIHdpdGggbm9uIGludGVnZXIgdmFsdWVzLmAgKyBgWW91IHNob3VsZCBlaXRoZXIgdXNlIGFuIGludGVnZXIgdmFsdWUgdGhhdCBjYW4gYmUgdXNlZCBhcyBpbmRleCwgb3IgZGVmaW5lIHRoZSBcXGB0aGVtZS4ke3RoZW1lS2V5fVxcYCBhcyBhIG51bWJlci5gXS5qb2luKCdcXG4nKSk7XG4gICAgICAgIH0gZWxzZSBpZiAoYWJzID4gdGhlbWVTcGFjaW5nLmxlbmd0aCAtIDEpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKFtgTVVJOiBUaGUgdmFsdWUgcHJvdmlkZWQgKCR7YWJzfSkgb3ZlcmZsb3dzLmAsIGBUaGUgc3VwcG9ydGVkIHZhbHVlcyBhcmU6ICR7SlNPTi5zdHJpbmdpZnkodGhlbWVTcGFjaW5nKX0uYCwgYCR7YWJzfSA+ICR7dGhlbWVTcGFjaW5nLmxlbmd0aCAtIDF9LCB5b3UgbmVlZCB0byBhZGQgdGhlIG1pc3NpbmcgdmFsdWVzLmBdLmpvaW4oJ1xcbicpKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHRoZW1lU3BhY2luZ1thYnNdO1xuICAgIH07XG4gIH1cbiAgaWYgKHR5cGVvZiB0aGVtZVNwYWNpbmcgPT09ICdmdW5jdGlvbicpIHtcbiAgICByZXR1cm4gdGhlbWVTcGFjaW5nO1xuICB9XG4gIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgY29uc29sZS5lcnJvcihbYE1VSTogVGhlIFxcYHRoZW1lLiR7dGhlbWVLZXl9XFxgIHZhbHVlICgke3RoZW1lU3BhY2luZ30pIGlzIGludmFsaWQuYCwgJ0l0IHNob3VsZCBiZSBhIG51bWJlciwgYW4gYXJyYXkgb3IgYSBmdW5jdGlvbi4nXS5qb2luKCdcXG4nKSk7XG4gIH1cbiAgcmV0dXJuICgpID0+IHVuZGVmaW5lZDtcbn1cbmZ1bmN0aW9uIGNyZWF0ZVVuYXJ5U3BhY2luZyh0aGVtZSkge1xuICByZXR1cm4gY3JlYXRlVW5hcnlVbml0KHRoZW1lLCAnc3BhY2luZycsIDgsICdzcGFjaW5nJyk7XG59XG5mdW5jdGlvbiBnZXRWYWx1ZSh0cmFuc2Zvcm1lciwgcHJvcFZhbHVlKSB7XG4gIGlmICh0eXBlb2YgcHJvcFZhbHVlID09PSAnc3RyaW5nJyB8fCBwcm9wVmFsdWUgPT0gbnVsbCkge1xuICAgIHJldHVybiBwcm9wVmFsdWU7XG4gIH1cbiAgY29uc3QgYWJzID0gTWF0aC5hYnMocHJvcFZhbHVlKTtcbiAgY29uc3QgdHJhbnNmb3JtZWQgPSB0cmFuc2Zvcm1lcihhYnMpO1xuICBpZiAocHJvcFZhbHVlID49IDApIHtcbiAgICByZXR1cm4gdHJhbnNmb3JtZWQ7XG4gIH1cbiAgaWYgKHR5cGVvZiB0cmFuc2Zvcm1lZCA9PT0gJ251bWJlcicpIHtcbiAgICByZXR1cm4gLXRyYW5zZm9ybWVkO1xuICB9XG4gIHJldHVybiBgLSR7dHJhbnNmb3JtZWR9YDtcbn1cbmZ1bmN0aW9uIGdldFN0eWxlRnJvbVByb3BWYWx1ZShjc3NQcm9wZXJ0aWVzLCB0cmFuc2Zvcm1lcikge1xuICByZXR1cm4gcHJvcFZhbHVlID0+IGNzc1Byb3BlcnRpZXMucmVkdWNlKChhY2MsIGNzc1Byb3BlcnR5KSA9PiB7XG4gICAgYWNjW2Nzc1Byb3BlcnR5XSA9IGdldFZhbHVlKHRyYW5zZm9ybWVyLCBwcm9wVmFsdWUpO1xuICAgIHJldHVybiBhY2M7XG4gIH0sIHt9KTtcbn1cbmZ1bmN0aW9uIHJlc29sdmVDc3NQcm9wZXJ0eShwcm9wcywga2V5cywgcHJvcCwgdHJhbnNmb3JtZXIpIHtcbiAgLy8gVXNpbmcgYSBoYXNoIGNvbXB1dGF0aW9uIG92ZXIgYW4gYXJyYXkgaXRlcmF0aW9uIGNvdWxkIGJlIGZhc3RlciwgYnV0IHdpdGggb25seSAyOCBpdGVtcyxcbiAgLy8gaXQncyBkb2Vzbid0IHdvcnRoIHRoZSBidW5kbGUgc2l6ZS5cbiAgaWYgKGtleXMuaW5kZXhPZihwcm9wKSA9PT0gLTEpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuICBjb25zdCBjc3NQcm9wZXJ0aWVzID0gZ2V0Q3NzUHJvcGVydGllcyhwcm9wKTtcbiAgY29uc3Qgc3R5bGVGcm9tUHJvcFZhbHVlID0gZ2V0U3R5bGVGcm9tUHJvcFZhbHVlKGNzc1Byb3BlcnRpZXMsIHRyYW5zZm9ybWVyKTtcbiAgY29uc3QgcHJvcFZhbHVlID0gcHJvcHNbcHJvcF07XG4gIHJldHVybiAoMCwgX2JyZWFrcG9pbnRzLmhhbmRsZUJyZWFrcG9pbnRzKShwcm9wcywgcHJvcFZhbHVlLCBzdHlsZUZyb21Qcm9wVmFsdWUpO1xufVxuZnVuY3Rpb24gc3R5bGUocHJvcHMsIGtleXMpIHtcbiAgY29uc3QgdHJhbnNmb3JtZXIgPSBjcmVhdGVVbmFyeVNwYWNpbmcocHJvcHMudGhlbWUpO1xuICByZXR1cm4gT2JqZWN0LmtleXMocHJvcHMpLm1hcChwcm9wID0+IHJlc29sdmVDc3NQcm9wZXJ0eShwcm9wcywga2V5cywgcHJvcCwgdHJhbnNmb3JtZXIpKS5yZWR1Y2UoX21lcmdlLmRlZmF1bHQsIHt9KTtcbn1cbmZ1bmN0aW9uIG1hcmdpbihwcm9wcykge1xuICByZXR1cm4gc3R5bGUocHJvcHMsIG1hcmdpbktleXMpO1xufVxubWFyZ2luLnByb3BUeXBlcyA9IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicgPyBtYXJnaW5LZXlzLnJlZHVjZSgob2JqLCBrZXkpID0+IHtcbiAgb2JqW2tleV0gPSBfcmVzcG9uc2l2ZVByb3BUeXBlLmRlZmF1bHQ7XG4gIHJldHVybiBvYmo7XG59LCB7fSkgOiB7fTtcbm1hcmdpbi5maWx0ZXJQcm9wcyA9IG1hcmdpbktleXM7XG5mdW5jdGlvbiBwYWRkaW5nKHByb3BzKSB7XG4gIHJldHVybiBzdHlsZShwcm9wcywgcGFkZGluZ0tleXMpO1xufVxucGFkZGluZy5wcm9wVHlwZXMgPSBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nID8gcGFkZGluZ0tleXMucmVkdWNlKChvYmosIGtleSkgPT4ge1xuICBvYmpba2V5XSA9IF9yZXNwb25zaXZlUHJvcFR5cGUuZGVmYXVsdDtcbiAgcmV0dXJuIG9iajtcbn0sIHt9KSA6IHt9O1xucGFkZGluZy5maWx0ZXJQcm9wcyA9IHBhZGRpbmdLZXlzO1xuZnVuY3Rpb24gc3BhY2luZyhwcm9wcykge1xuICByZXR1cm4gc3R5bGUocHJvcHMsIHNwYWNpbmdLZXlzKTtcbn1cbnNwYWNpbmcucHJvcFR5cGVzID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJyA/IHNwYWNpbmdLZXlzLnJlZHVjZSgob2JqLCBrZXkpID0+IHtcbiAgb2JqW2tleV0gPSBfcmVzcG9uc2l2ZVByb3BUeXBlLmRlZmF1bHQ7XG4gIHJldHVybiBvYmo7XG59LCB7fSkgOiB7fTtcbnNwYWNpbmcuZmlsdGVyUHJvcHMgPSBzcGFjaW5nS2V5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